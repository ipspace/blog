---
date: 2013-09-16T07:19:00.000+02:00
tags:
- firewall
- data center
- workshop
- load balancing
- overlay networks
title: Test virtual appliance throughput with Spirent Avalanche NEXT
url: /2013/09/test-virtual-appliance-throughput-with.html
---

<p>During the Networking Tech Field Day 6 Spirent showed us <a href="http://www.spirent.com/Products/Avalanche/Avalanche_Latest_Release">Avalanche NEXT</a> – another great testing tool that generates up to 10Gbps of perfectly valid application-level traffic that you can push through your network devices to test their performance, stability or impact of feature mix on maximum throughput.</p>
<p>Not surprisingly, as soon as they told us that you could use Avalanche NEXT to replay captured traffic we started getting creative ideas.<!--more--></p>
<p>One idea got <a href="http://etherealmind.com">Greg</a> and myself particularly excited. Imagine you’re a true believer in <a href="http://blog.ipspace.net/2013/05/simplify-your-disaster-recovery-with.html">dynamic virtual appliances</a> but don’t know how the product you’re interested <a href="http://blog.ipspace.net/2013/04/virtual-appliance-performance-is.html">behaves under your current (or future) load</a>. Here’s what you could do with Avalanche NEXT:</p>
<ul class="ListParagraph"><li>Capture the traffic passing through your hardware firewall or load balancer;</li>
<li>Filter the traffic to whatever subset will pass through your virtual appliance (unless you want to replace a physical monstrosity with 10.000 rules with a 1:1 virtual clone);</li>
<li>Build a test bed representing your target virtual network setup. You (RFC 2119) MUST use the same virtual networking encapsulation in the test bed and the target network or risk having the results totally skewed due to <a href="http://blog.ipspace.net/2012/03/do-we-really-need-stateless-transport.html">TCP offload</a>.</li>
<li>Use Avalanche NEXT to push the traffic through your virtual appliance.</li>
<li>Tweak the virtualization parameters and/or change the server hardware as needed.</li>
<li>Lather, rinse, repeat.</li>
</ul>
<p>Want to future-proof your design? It’s easy:</p>
<ul class="ListParagraph"><li>Compress the timing of the captured traffic (effectively increasing its bandwidth). Avalanche NEXT is supposedly capable of doing that.</li>
<li>Repeat the above steps.</li>
</ul>
<p>Now for rainbow-colored dreams:</p>
<ul class="ListParagraph"><li>Replace IPv4 addresses in captured traffic with equivalent IPv6 addresses;</li>
<li>Replay the newly generated IPv6 traffic (representing your existing traffic load translated into IPv6) through your network to see the impact of IPv6 migration.</li>
</ul>
<p>Finally, throwing a few unicorns into the mix: Spirent could implement another sexy knob in Avalanche NEXT GUI (it’s amazing what they did with HTML5) to adjust the IPv4:IPv6 mix in the captured traffic.</p>
<p>No, they don’t have rainbows and unicorns yet, but I do hope they will have them the next time we meet.</p>
<h4>Watch the videos</h4><p>To learn more about Avalanche NEXT watch the <a href="http://www.youtube.com/playlist?list=PLObjX_zORJMCT_E1iKhvw1FzSr2hQnaY-&amp;feature=view_all">NFD6 videos</a>: <a href="http://youtu.be/FiR9y85GAlA">overview presentation</a> and <a href="http://youtu.be/Hctcb5K2ExU">demo</a> (with loads of geek fun).</p>
<h4>Disclosure</h4><p>Spirent was a <a href="http://blog.ipspace.net/p/networking-tech-field-day-disclaimer.html">sponsor of Networking Tech Field Day 6</a>.</p>

