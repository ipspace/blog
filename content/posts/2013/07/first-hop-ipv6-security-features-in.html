---
title: "First-Hop IPv6 Security Features in Cisco IOS"
date: "2013-07-18T07:40:00.000+02:00"
tags: [ IPv6,security,Workshop,LAN ]
---

<p>I wanted to figure out how to use IPv6 DAD proxy in PVLAN environments during my seaside vacations, and as I had no regular Internet access decided to download the whole set of IPv6 configuration guides while enjoying the morning cup of coffee in an Internet café. Opening the <a href="http://www.cisco.com/en/US/docs/ios-xml/ios/ipv6_fhsec/configuration/xe-3s/ip6f-xe-3s-book.pdf">IPv6 First-Hop Security Configuration Guide</a> was one of the most pleasant (professional) surprises I had recently.</p>
<p>One word summary: Awesome.<!--more--></p>
<p>Cisco IOS has (at least) these IPv6 first-hop security features:</p>
<p><strong>IPv6 RA Guard</strong> rejects fake RA messages coming from host (non-router) ports (not sure whether it handles all possible IPv6 header fragmentation attacks). Interestingly, it can also validate the contents of RA messages (configuration flags, list of prefixes) received through router-facing ports, potentially giving you a safeguard against an attack of fat fingers.</p>
<p><strong>DHCPv6 Guard</strong> blocks DHCPv6 messages coming from unauthorized DHCPv6 servers and relays. Like IPv6 RA Guard it also validates the DHCPv6 replies coming from authorized DHCPv6 servers, potentially providing protection against DHCPv6 server misconfiguration.</p>
<p><strong>IPv6 Snooping and device tracking</strong> builds a IPv6 First-Hop Security Binding Table (nicer name for ND table) by monitoring DHCPv6 and ND messages as well as regular IPv6 traffic. The binding table can be used to stop ND spoofing (in IPv4 world we’d call this feature DHCP Snooping and Dynamic ARP Inspection).</p>
<p><strong>IPv6 Source Guard</strong> uses the IPv6 First-Hop Security Binding Table to drop traffic from unknown sources or bogus IPv6 addresses not in the binding table. The switch also tries to recover from lost address information, querying DHCPv6 server or using IPv6 neighbor discovery to verify the source IPv6 address after dropping the offending packet(s).</p>
<p><strong>IPv6 Prefix Guard</strong> is denies illegal off-subnet traffic. It uses information gleaned from RA messages and IA_PD option of DHCPv6 replies (delegated prefixes) to build the table of valid prefixes.</p>
<p class="info">IPv6 Prefix Guard is a layer-2 feature. You should use uRPF check on layer-3 interfaces.</p>
<p><strong>IPv6 Destination Guard</strong> drops IPv6 traffic sent to directly connected destination addresses not in IPv6 First-Hop Security Binding Table, effectively stopping ND exhaustion attacks.</p>
<p><strong>Summary:</strong> Cisco IOS seems to be the networking software with the most comprehensive set of IPv6 first-hop security features. As always, some features might not be available on some platforms – use feature navigator to figure out which features your IPv6-capable switches support.</p>
<h4>Related webinars</h4><p>You’ll find more about IPv6 first-hop security requirements and features in the <a href="http://www.ipspace.net/IPv6_security">IPv6 Security</a> webinar (also available as part of the <a href="http://www.ipspace.net/Subscription_to_ioshints_webinars">yearly subscription</a>). In that webinar, Eric Vyncke described individual Cisco IOS security features; these videos are <a href="http://demo.ipspace.net/bin/list?id=IPv6Sec#Videos">freely available</a> on <a href="http://demo.ipspace.net/">ipSpace.net demo web site</a>:</p>
<ul class="ListParagraph"><li><a href="http://demo.ipspace.net/get/D2%20RA%20Guard.mp4">RA Guard</a></li>
<li><a href="http://demo.ipspace.net/get/D3%20Secure%20Neighbor%20Discovery.mp4">Secure Neighbor Discovery</a></li>
<li><a href="http://demo.ipspace.net/get/D4%20-%20Source%20Address%20Validation%20Improvement.mp4">Source Address Validation Improvement</a></li>
<li><a href="http://demo.ipspace.net/get/D5%20-%20IPv6%20Address%20Spoofing%20ND%20Attacks.mp4">IPv6 Address Spoofing and ND Attacks</a></li>
<li><a href="http://demo.ipspace.net/get/D6%20-%20Address%20Assignment%20Tracking.mp4">Address Assignment and Tracking</a></li>
</ul>

