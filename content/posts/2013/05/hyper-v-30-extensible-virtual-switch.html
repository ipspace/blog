---
date: 2013-05-24T07:18:00.000+02:00
tags:
- firewall
- switching
- workshop
- virtualization
title: Hyper-V 3.0 Extensible Virtual Switch
url: /2013/05/hyper-v-30-extensible-virtual-switch.html
---

<p>It took years before the rumored Cisco vSwitch materialized (in form of Nexus 1000v), several more years before there was the first competitor (<a href="https://blog.ipspace.net/2012/02/ibm-launched-nexus-1000v-competitor.html">IBM Distributed Virtual Switch</a>), and who knows how long before the third entrant (<a href="https://blog.ipspace.net/2013/05/interop-product-launch-craze.html">recently announced HP vSwitch</a>) jumps out of PowerPoint slides and whitepapers into the real world. </p>
<p>Compare that to the Hyper-V environment, where we have at least two virtual switches (<a href="http://www.cisco.com/en/US/products/ps13056/index.html">Nexus 1000V</a> and <a href="https://blog.ipspace.net/2013/01/nec-launched-virtual-openflow-switch.html">NEC's PF1000</a>) mere months after Hyper-V's general availability.<!--more--></p>
<p>The difference: Microsoft did the right thing, created an extensible vSwitch architecture and thoroughly documented all the APIs (there's enough documentation that you can go and implement your own switch extension if you're so inclined).</p>
<p>A <a href="http://demo.ipspace.net/get/D1%20-%20Hyper-V%20Extensible%20Switch.mp4">short video</a> taken from <a href="http://www.ipspace.net/Virtual_Firewalls">Virtual Firewalls</a> webinar describes the <a href="http://msdn.microsoft.com/en-us/library/windows/hardware/hh598163(v=vs.85).aspx">extensible architecture of Hyper-V virtual switch</a>.</p>
<div class="separator"><a href="http://demo.ipspace.net/get/D1%20-%20Hyper-V%20Extensible%20Switch.mp4" imageanchor="1"><img border="0" src="/2013/05/s320-Hyper-V+vSwitch.jpg"/></a></div>
<h4>Short summary</h4><ul class="ListParagraph"><li>A switch extension can be a <a href="http://msdn.microsoft.com/en-us/library/windows/hardware/hh598169(v=vs.85).aspx">capturing, filtering or forwarding extensions</a>;</li>
<li><a href="http://msdn.microsoft.com/en-us/library/windows/hardware/hh598135(v=vs.85).aspx">Capturing extensions</a> can capture packets and generate their own packets (example: report to an sFlow collector, implement ERSPAN functionality);</li>
<li><a href="http://msdn.microsoft.com/en-us/library/windows/hardware/hh598147(v=vs.85).aspx">Filtering extensions</a> can inspect, drop (traffic policing or filtering) or delay (traffic shaping) packets, as well as generate their own packets;</li>
<li><a href="http://msdn.microsoft.com/en-us/library/windows/hardware/hh598148(v=vs.85).aspx">Forwarding extensions</a> can do all of the above, plus replace the default forwarding rules (specify their own set of output ports). Each packet can be set to one or more output ports to implement flooding, multicast or SPAN-like behavior.</li>
<li><a href="http://msdn.microsoft.com/en-us/library/windows/hardware/hh582269(v=vs.85).aspx">Each extension is called twice</a>, first on the Ingress path (input VM or port to switch), then (when the set of destination physical or virtual ports is known) on the Egress path (switch to set of output ports). </li>
</ul>
<p>It seems Microsoft really learned the hard lessons of the circuitous history of virtual networking and it looks like they did the right thing â€¦ assuming the highly extensible mechanism they implemented doesn't bog down the switching performance. Time to do some performance tests. Any volunteers?</p>
<h4>More information</h4><p>Interested in virtual networking? Watch these webinars (you get all of them with the <a href="http://www.ipspace.net/Subscription">yearly subscription</a>):</p>
<ul class="ListParagraph"><li><a href="http://www.ipspace.net/Introduction_to_Virtualized_Networking">Introduction to Virtual Networking</a></li>
<li><a href="http://www.ipspace.net/ProgrammableFlow_Technical_Deep_Dive">ProgrammableFlow Technical Deep Dive</a></li>
<li><a href="http://www.ipspace.net/Virtual_Firewalls">Virtual Firewalls</a></li>
<li><a href="http://www.ipspace.net/Cloud_Computing_Networking">Cloud Computing Networking</a></li>
</ul>
<div class="jump-link"><a href="http://demo.ipspace.net/get/D1%20-%20Hyper-V%20Extensible%20Switch.mp4">Watch the video</a></div>

