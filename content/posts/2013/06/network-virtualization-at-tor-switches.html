---
date: 2013-06-05T07:36:00.000+02:00
tags:
- data center
- workshop
- overlay networks
- virtualization
title: Network Virtualization at ToR switches? Makes as much sense as IP-over-APPN
url: /2013/06/network-virtualization-at-tor-switches/
---

<p>One of my blogger friends sent me an interesting observation:</p>
<blockquote class="cite">After talking to networking vendors I'm inclined to think they are going to focus on a mesh of overlays from the TOR, with possible use of overlays between vswitch and TOR too if desired - drawing analogies to MPLS with ToR a PE and vSwitch a CE. Aside from selling more hardware for this, I'm not drawn towards a solution like this bc it doesn't help with full network virtualization and a network abstraction for VMs.</blockquote>
<p>The whole situation reminds me of the good old SNA and APPN days with networking vendors playing the IBM part of the comedy.<!--more--></p>
<p class="note">I apologize to the younglings in the audience – the rest of the blog post will sound like total gibberish to you – but I do hope the grumpy old timers will get a laugh or two out of it.</p>
<p>Once upon a time, there were mainframes (and nobody called them clouds), and all you could do was to connect your lowly terminal (80 x 24 fluorescent green characters) to a mainframe. Not surprisingly, the networking engineers were building hub-and-spoke networks with the mainframes (actually their sidekicks called Front End Processors) tightly controlling all the traffic. The whole thing was called Systems Network Architecture (SNA) and life was good (albeit a bit slow).</p>
<div class="separator"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/71/IBM_3277_Display.jpg/595px-IBM_3277_Display.jpg" style="width: 400px"/><br/>The original 3270 terminal (source: Wikipedia)</div>
<p>Years later, seeds of evil started appearing in the hub-and-spoke wonderland. There were rumors of coax cables being drilled and vampire taps being installed onto said cables. Workstations were able to communicate without the involvement of the central controller ... and there was a new protocol called Internet Protocol that powered all these evil ideas.</p>
<div class="separator"><img src="http://upload.wikimedia.org/wikipedia/commons/7/72/VampireTap.jpg" style="width: 400px"/><br/>Vampire biting marks on an original yellow thick coax</div>
<p>Not surprisingly, IBM (the creator of SNA) tried a tweak-embrace-and-extend strategy. First they introduced independent logical units (clients and servers in IP terminology), later on they launched what seemed like a <a href="http://en.wikipedia.org/wiki/Baffles_(submarine)">Crazy Ivan</a> (not related to my opinions) to the orthodox hub-and-spoke believers: <a href="http://www.cisco.com/en/US/tech/tk331/tk341/technologies_tech_note09186a0080093fa8.shtml">Advanced Peer-to-Peer Networking (APPN)</a>, still using the time-tested (and unbelievably slow) SNA protocols.</p>
<div class="separator"><img src="http://www.cisco.com/image/gif/paws/12235/33_b.gif" style="width: 400px"/><br/>What is APPN (Source: Cisco)</div>
<p class="info">At the same time IBM tried to persuade us 4Mbps Token Ring works faster than 10Mbps switched Ethernet. Brocade recently tried a similar stunt, trying to tell us how <a href="http://datacenteroverlords.com/2013/04/18/fibre-channel-generations/">Gen5 Fiber Channel (also known as 16GB FC) is better than anything else</a> (including 40GE FCoE) – another proof the marketers never learn from past blunders.</p>
<p>Faced with dismal adoption of APPN (I haven’t seen a live network running APPN, although I was told some people were using it for AS/400 networking), and inevitable rise of IP, IBM tried yet another approach: let’s transport IP over APPN (or maybe it's just one of the recurring nightmares I'm having). Crazy as it sounds, I remember someone proposing to run datagram service (IP) on top of layer-7 (LU6.2) transport ... and there are people today running IP over SSH, proving yet again that every bad idea resurfaces after a while.</p>
<p class="update"><strong>Update 2013-06-09</strong>: IP-over-APPN wasn't just a recurring nightmare. François Roy provided the necessary detail in his comment: IBM implemented it in 2217 Nways Multiprotocol Concentrator. Straight from the <a href="http://www.redbooks.ibm.com/redbooks/pdfs/sg244726.pdf">documentation</a>: "TCP/IP data is routed over SNA using IBM's multiprotocol transport networking (MPTN) formats."</p>
<p>Regardless of IBM’s huge marketing budget, the real world took a different turn. First we started transporting SNA over IP (remember DLSw?), then deployed Telnet 3270 (TN3270) gateways to give PCs TCP/IP-based access to mainframe applications. Oh, and IBM seems to have <a href="http://publib.boulder.ibm.com/infocenter/pcomhelp/v5r9/index.jsp?topic=/com.ibm.pcomm.doc/books/html/admin_guide20.htm">APPN over IP</a>.</p>
<p>A few years later, IBM was happily selling Fast Ethernet mainframe attachments and running TCP/IP stack with TN3270 on the mainframes (you see, they never really cared about networking – their core businesses are services, software and mainframes) ... and one of the first overlay virtual network implementations was VXLAN in Nexus 1000V.</p>
<p>And so I finally managed to mention overlay virtual networking ... but don’t rush to conclusions; before drawing analogies keep in mind that most organizations couldn’t get rid of the mainframes: there were millions of lines of COBOL code written for an environment that could not be easily replicated anywhere else. Migrating those applications to any other platform was mission impossible. </p>
<p>On the other hand, all it takes in the server virtualization world is an upgrade to vSphere 5.1 (or Hyper-V 3.0) and a hardware refresh cycle (to <a href="/2013/04/virtual-appliance-performance-is/">flush the physical appliances out of the data center</a>), and the networking vendors will be left wondering where all the VMs and VLANs disappeared. And you did notice that <a href="/2013/05/update-trill-on-hp-data-center-switches/">HP finally delivered TRILL and EVB on their ToR switches</a>, didn’t you?</p>

