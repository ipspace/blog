---
url: /2013/10/ibgp-migrations-can-generate-forwarding.html
title: "IBGP Migrations Can Generate Forwarding Loops"
date: "2013-10-28T07:42:00.000+01:00"
tags: [ MPLS,Internet,BGP ]
---

<p>A group of researches presented an “interesting” result @ IETF 87: <a href="http://www.ietf.org/proceedings/87/slides/slides-87-irtfopen-2.pdf">migrating from IBGP full mesh to IBGP reflectors can introduce temporary forwarding loops</a>. OMG, really?</p>
<p><a href="http://en.wikipedia.org/wiki/Don%27t_Panic_(The_Hitchhiker%27s_Guide_to_the_Galaxy)#Don.27t_Panic">Don’t panic</a>, the <a href="http://en.wikiquote.org/wiki/The_Hitchhiker's_Guide_to_the_Galaxy#Chapter_3">world is not about to become a Vogon hyperspace bypass</a>. Let’s put their results in perspective.<!--more--></p>
<p class="note">Disclaimer: IBGP loops weren’t the main focus of the <a href="http://www.ietf.org/proceedings/87/slides/slides-87-irtfopen-2.pdf">IETF 87 paper</a> (do go through the whole slide deck, it’s interesting), but I hate the big fuss some people make out of corner cases.</p>
<p><strong>Can it really happen?</strong> Sure it can. You can always find a <a href="https://blog.ipspace.net/2013/10/can-bgp-route-reflectors-really.html">pathological case</a> where following <em>best practices </em>(assuming they deserve the name) can lead to into a quagmire. Route reflectors are no exception.</p>
<p><strong>Is </strong><strong>the migration from full mesh to route reflectors a relevant use case</strong><strong>?</strong> You tell me – I always tell my clients to use BGP route reflectors whenever they have more than four BGP routers in an AS ... but I’m also positive there are still some neglected networks out there running IBGP full mesh (more probably partial mesh because they forgot to configure a few sessions) on tens of boxes.</p>
<p><strong>Are best practices broken?</strong> No. They are just that – a procedure that will cause the least harm (as compared to random ramblings and cut-and-paste of Google-delivered configuration snippets) when executed by people who don’t know what they’re doing.</p>
<p>Or, as John Sonmez put it more politely in his <a href="http://simpleprogrammer.com/2013/02/17/principles-are-timeless-best-practices-are-fads/">Principles are Timeless, Best Practices are Fads</a> blog post:</p>
<blockquote class="cite">If you were to blindly follow any best practice and not apply that best practice in a way that brings out the underlying principle, you would be very unlikely to actually receive any benefit.</blockquote>
<p><strong>Does that make BGP a bad protocol?</strong> Contrary to <a href="http://etherealmind.com/response-seamless-bgp-configuration-or-why-bgp-is-a-poor-routing-protocol/">some vocal beliefs</a>, it doesn’t. Every tool (including BGP) can be misused, and a properly focused researcher can generate an NP-hard problem out of every real-life situation. Is screwdriver a bad tool because I have to spend so much energy when hammering nails with it? Maybe not.</p>
<p><strong>Is there a way around the problem?</strong> Sure. Deploy MPLS-based forwarding in your network (aka: <a href="https://blog.ipspace.net/2013/10/can-bgp-route-reflectors-really.html">MPLS is the answer … what was the question?</a>)</p>
<p>Lacking any better idea, use a network simulation tool like Cariden to see what will happen with your network prior to reconfiguring it. More about better ideas in follow-up blog post ... and if you have one, share it in the comments.</p>

