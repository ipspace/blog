---
date: 2009-06-26T08:40:00.001+02:00
tags:
- security
- HTTP
- web
title: IOS HTTP vulnerability
url: /2009/06/ios-http-vulnerability.html
---

<div class="bloggerBody"><p>The <a href="http://www.networkworld.com/subnets/cisco/">Cisco Subnet</a> RSS feed I’m receiving from <a href="http://www.networkworld.com/">Network World</a> contained interesting information a few days ago: Cisco has <a href="http://www.cisco.com/en/US/products/products_security_advisory09186a008059e470.shtml">reissued the HTTP security advisory from 2005</a>. The 2005 bug was “trivial”: they forgot to quote the “&lt;” character in the output HTML stream as “&amp;lt;” and you could thus insert HTML code into the router’s output by sending pings to the router and inspecting the buffers with <strong>show buffers assigned dump </strong>(I found the <a href="http://web.archive.org/web/20071116145545/http:/www.infohacking.com/INFOHACKING_RESEARCH/Our_Advisories/cisco/index.html">original proof-of-concept exploit</a> on the <a href="http://www.archive.org/index.php">Wayback Machine</a>). However, I’ve checked the behavior on 12.4(15)T1 and all dangerous characters (“&lt;” and quotes) were properly quoted. So, I’m left with two explanations.</p>
<!--more--><h4>It’s real</h4><p>Someone has discovered a really devious way of inserting HTML code that somehow bypasses the quoting process. It could be weird Unicode encoding of less-than character, similar to the <a href="/2007/05/unicode-ips-vulnerability-more-details.html">IPS vulnerability I’ve been writing about two years ago</a>. I couldn’t find a feasible approach to do it, as the original attack vector (<strong>show buffers</strong> command) drops the high-order bit from the dumped data and the IOS HTTP server properly quotes 7-bit characters, but then I’m not aware of every IOS command (including the hidden ones) that could dump buffer/memory data. I’ve even tested the 0xFF3C sequence produced by <strong>tclsh </strong>and it does not work (the 0xFF is emitted unchanged, but the 0x3C is quoted).</p>
<h4>It’s an administrative blunder</h4><p>The “Revision history” section of the advisory claims that they’ve revised the workaround section, which describes how to disable the HTTP WEB_EXEC service. If this is true, they might have updated the list of affected software and fixed IOS versions. Adding information on feature available in 12.3T four years after the original advisory without fixing other more relevant information is (in my opinion) pure paperwork shuffling, not to mention the scare caused by an advisory claiming there’s a security hole in all classic IOS releases.</p>
<h4>What should you do?</h4><p>To be on the safe side, you should:</p>
<ul><li>Disable HTTP and HTTPS servers in Cisco IOS unless you absolutely need them (but you should do that anyway).</li>
</ul>
<p class="info">Protecting the HTTP server with an ACL does not help, as the exploit works through the administrator’s browser.</p>
<ul><li>Disable <em>all </em>HTTP services that you don’t need, not just the WEB_EXEC service (which is a good practice anyway). Only the <a href="/2006/10/disable-command-execution-with-cisco.html">services you know you need should be left active</a>.</li>
</ul>
<p class="warn">Disabling the WEB_EXEC service will break SDM.</p>
<ul><li>Use dedicated browser sessions when accessing the router. Start a new copy of the browser (or even better, a different browser), go to the router, do what you have to do and close all browser windows <em>before accessing anything else</em>, including links in your e-mail.</li>
</ul>
<p>Last but not least, you could disable individual commands with EEM applets (if only Cisco would provide a complete list of vulnerable commands). For example, the following command will disable all variants of <strong>show buffers</strong> command with the <strong>dump </strong>option</p>
<pre class="code">event manager applet WebDeny<br/> event cli pattern "show buffers.*dump" sync no skip yes</pre></div>

