---
url: /2009/01/ebgp-multipath-load-sharing-and-cef.html
title: "EBGP multipath load sharing and CEF"
date: "2009-01-21T06:48:00.000+01:00"
tags: [ CEF,BGP,load balancing ]
---

<div class="bloggerBody"><p>When I was discussing the details of the BGP troubleshooting video with one of my readers, he pointed out that I should mention the need for CEF switching in EBGP multipath scenario. My initial response was “<em>Why would you need CEF? EBGP multipath is older than CEF</em>” and his answer told me I should turn on my gray cells before responding to emails: “<a href="http://blog.ioshints.info/2009/01/videosmall-site-using-bgp-on-two.html"><em>Your video</em></a><em> as well as </em><a href="http://www.cisco.com/en/US/docs/ios/12_2t/12_2t11/feature/guide/ft11bmpl.html"><em>Cisco’s web site</em></a><em> recommends CEF for EBGP multipath design … but interestingly, it does work without CEF</em>”.<br/><br/><img src="http://wiki.nil.com/wk/images/d/db/BGPMPLSVPN_SingleRouterTwoUplinks_Diagram.png"/></p>
<p>The real reason we need CEF in EBGP load sharing designs is the efficacy of load distribution. Without CEF, the router will send all traffic toward a single BGP prefix over one of the links (fast switching performs per-destination-prefix load sharing). With CEF, the <a href="http://blog.ioshints.info/2006/10/cef-load-sharing-details.html">load is distributed based on the source-destination IP address pair combinations</a>. Even if multiple clients send the traffic toward the same server, the load is spread across available links.</p>
<p>Obviously, I should write about CEF and load sharing once a month to refresh my failing memory.</p>
</div>

