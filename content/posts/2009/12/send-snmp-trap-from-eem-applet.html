---
url: /2009/12/send-snmp-trap-from-eem-applet.html
title: "Send a SNMP trap from an EEM applet"
date: "2009-12-18T06:10:00.001+01:00"
tags: [ SNMP,EEM ]
---

<p>The engineer who wanted to <a href="https://blog.ipspace.net/2009/11/detect-dos-attacks-with-eem.html">detect specific DoS attack (WAN link overload) with EEM applet</a> asked for something more in his original question: he wanted to receive a SNMP trap on the NMS when the DoS attack is detected. Implementing this requirement with an EEM applet is simple; you just need to add the <strong>trap </strong>keyword to the <strong>event manager applet </strong>configuration command.</p>
<div class="separator" style="clear: both; text-align: center;"><a href="/2009/12/EEM SNMP trap.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="298" src="/2009/12/s400-EEM SNMP trap.png" width="400"/></a><br/></div>
<p class="more">EEM-SNMP integration is described in the <a href="https://www.ipspace.net/Embedded_Event_Manager_(EEM)_Workshop"><span>Embedded Event Manager (EEM) workshop</span></a>. You can attend an online version of the workshop; we can also organize a dedicated event for your networking team.</p>
<!--more--><p>The SNMP trap contains the trap OID set to cEventMgrMIB.0.1. The .1 suffix indicates the trap was sent by the EEM server not by applet/Tcl policy code. The rest of the trap data is a copy of an <a href="ftp://ftp.cisco.com/pub/mibs/v2/CISCO-EMBEDDED-EVENT-MGR-MIB.my">EEM history event table object</a>. One of the fields (ceemHistoryEventType1) contains an index into the event description table, another field (ceemHistoryPolicyName) the name of the EEM applet that triggered the trap.</p>

