---
url: /2009/02/protect-your-network-with-bgp-maxas.html
title: "Protect your network with BGP maxas-limit"
date: "2009-02-17T12:07:00.002+01:00"
tags: [ BGP ]
---

<div class="bloggerBody"><p><a href="http://wiki.nil.com/"><img class="ImgFLTright" src="http://www.ioshints.info/images/Wiki.png"/></a><ins>Update @ 2009-02-17 18:42UTC: <a href="https://blog.ipspace.net/2009/02/update-oversized-as-paths.html">more IOS bug details</a></ins><br/><ins>Update @ 2009-02-20: <a href="https://blog.ipspace.net/2009/02/root-cause-analysis-oversized-as-paths.html">Root cause analysis</a>, <a href="https://blog.ipspace.net/2009/02/oversized-as-paths-cisco-ios-bug.html">Detailed Cisco IOS bug description</a></ins></p>
<p>Have you noticed how slow the Internet was yesterday? I almost blamed my kids (sometimes they manage to overload my WAN link), but it turned out to be a global problem. It looks like a greenhorn ISP (they joined RIPE less than four months ago) in central Europe managed to generate a BGP update with too many AS numbers in the AS path, confusing older routers. It’s my wild guess that those routers did not anticipate two AS_SEQUENCE attributes in the BGP update message. <a href="http://www.renesys.com/blog/2009/02/the-flap-heard-around-the-worl.shtml">You can find the details in the Renesys blog</a>; at the peak of the instability, they were receiving over 100.000 BGP updates <em>per second</em>.</p>
<p>It’s very easy to protect yourself (and your downstream neighbors) from an operational error like this one. Cisco has <a href="http://www.cisco.com/en/US/docs/ios/iproute/command/reference/irp_bgp1.html">implemented the AS-path length limiting code in IOS release 12.2</a>. One would hope that the major ISPs would have started using this feature years ago; obviously that’s not the case. I <a href="http://wiki.nil.com/Limit_the_maximum_BGP_AS-path_length">wrote an article in the CT3 Wiki describing the “intricate” details of this obviously ignored IOS feature</a> just to make sure everyone understands what the <strong>bgp maxas-limit</strong> command does (and hopefully implements it in this millennium)</p>
<p style="text-align: right;"><a href="http://wiki.nil.com/Limit_the_maximum_BGP_AS-path_length">Read the article in the CT3 wiki</a></p>
</div>

