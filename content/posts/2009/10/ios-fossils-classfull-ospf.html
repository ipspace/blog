---
date: 2009-10-02T06:46:00.001+02:00
tags:
- OSPF
- IOS fossils
title: 'IOS fossils: Classful OSPF redistribution'
url: /2009/10/ios-fossils-classfull-ospf.html
---

<div class="bloggerBody"><p>In the classful days of the Internet it made sense to limit the amount of information redistributed between the routing protocols. OSPF was always classless, but RIPv1 wasn’t … and you could get all sorts of crazy routes from RIP that would mess up the rest of your network if they would ever get redistributed into OSPF. To prevent that, Cisco’s engineers introduced the <strong>subnets </strong>option in the OSPF <strong>redistribute </strong>command.</p>
<p class="note">Either the OSPF <strong>redistribute</strong> command is really old (before the <strong>distribute-list </strong>command started accepting extended ACL which could filter on the subnet mask) or someone was too dumb to use the extended ACL and Cisco had to provide an obvious workaround.</p>
<p>By the time Cisco implemented EIGRP and BGPv4 (IOS release 9.21, 15+ years ago), the absurdity of the classful redistribution was already obvious. These routing protocols accept whatever routes you want to redistribute and their variants of the <strong>redistribute </strong>command don’t have the <strong>subnets </strong>keyword. However, nobody ever took steps to remove this fossil from the IOS code.</p>
<!--more--><p>I wouldn’t care if we would be talking about an obscure option like the <a href="https://blog.ipspace.net/2009/05/ios-fossils-ospf-to-bgp-redistribution.html">OSPF-to-BGP redistribution tags</a>, but the OSPF <strong>redistribute</strong> command is one of the most confusingly harmful IOS routing protocol commands (the only one getting close in my opinion is the <strong>auto-summary</strong> in EIGRP). One of the IOS releases introduced a warning that would be printed whenever you’re configuring redistribution into OSPF without the <strong>subnets </strong>keyword (great job: wouldn’t it be better to fix the problem?) …</p>
<pre class="code">rtr(config)#<strong>router ospf 999</strong><br/>rtr(config-router)#<strong>redistribute static</strong><br/><span class="high">% Only classful networks will be redistributed</span></pre><p>… but the warning is incorrect. Yuri Selivanov sent me an interesting observation: while the subnets don’t get redistributed without the <strong>subnets </strong>keyword, supernets do. The “classful” filter is not even working correctly (or, at the very least, it’s not doing what the IOS claims).</p>
<p>I am positive Cisco will never fix this problem and we’ll have to cope with this command until the last bits of IPv4 code are erased from Cisco IOS, but here are a few things they could have done:</p>
<ul><li>Remove the classful redistribution filter from the code and make the <strong>subnets </strong>keyword obsolete. I sincerely doubt any reasonably-sized network is running classful redistribution with recent IOS code (and who cares about the network cores running on AGS+).</li>
<li>Add another option to the OSPF process that disables the filter. This option would have to be explicitly stored in the router configuration like the <strong>log-adjacency-changes</strong> OSPF configuration command (to ensure the old configurations work) but should be turned on for all new instances of OSPF routing protocols.</li>
</ul>
<p>Undoubtedly a few people (mostly old-timers) would get confused once or twice, but the number of OSPF support cases might be “slightly” reduced.</p>
</div>

