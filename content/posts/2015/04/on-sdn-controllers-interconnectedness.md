---
date: 2015-04-27 13:57:00+02:00
distributed-systems_tag: sdn
series:
- distributed-systems
series_weight: 1500
tags:
- SDN
- BGP
title: On SDN Controllers, Interconnectedness and Failure Domains
url: /2015/04/on-sdn-controllers-interconnectedness.html
---
A long long time ago Colin Dixon [wrote the following tweet](https://twitter.com/colin_dixon/status/509515070981033984) in response to my [*Controller Cluster Is a Single Failure Domain*](https://blog.ipspace.net/2014/09/controller-cluster-is-single-failure.html) blog post:

{{<figure src="/2015/04/s1600-Screenshot+2015-04-20+13.32.39.png">}}

He's obviously right, but I wasn't talking about interconnected domains, but failure domains (yeah, I know, you could argue they are the same, but do read on).
<!--more-->
BGP routers are clearly interconnected. They are also loosely coupled -- a bogus BGP update generated by a BGP router (or any other BGP speaker) can bring down other BGP routers.

Sometimes an unexpected update triggers a loss of BGP session (as was the case with [long AS paths a while ago](https://blog.ipspace.net/2009/02/oversized-as-paths-cisco-ios-bug.html)), sometimes a weird transitive attribute that is passed transparently by some implementations of BGP causes a crash in other implementations (and is thus able to trigger a crash in a BGP speaker several hops away). [Hijacking attacks are also nothing new](http://en.wikipedia.org/wiki/IP_hijacking), so it might seem like BGP fares no better than the new centralized controller architectures.

However, as I explain in more details in the [SDN Architectures and Deployment Considerations webinar](https://www.ipspace.net/SDN_Architectures_and_Deployment_Considerations), the crucial questions to consider are (Colin made approximately the same points in follow-up tweets, read the [whole thread](https://twitter.com/colin_dixon/status/509515070981033984) for his view).

-   What happens when a control plane (or controller) fails?
-   What is the size of the failure domain?
-   What can be done to protect the controller/control plane?

On all three counts BGP performs substantially better than architectures with centralized control plane heavily promoted by hard-core SDN aficionados.

**What happens when a BGP router fails?** Best case, a single BGP peering session is lost. Worst case, you lose a single router.

In theory, a BGP router might propagate a poisoned update before it falls over; based on anecdata it's as likely as a round square (but of course do prove me wrong!).

Losing a major peering session is not exactly fun (and sometimes the ripples can be felt throughout the Internet), but it might be a bit better than losing a whole controller-managed network.

{{<note info>}}In this respect, a controller-based network is similar to an OSPF routing domain: a faulty LSA is propagated across the whole area (because the flooding algorithm is not tied in any way to the SPF algorithm) and might trigger a problem in all routers participating in that OSPF area. That's one of the reasons I'd never run OSPF with untrusted third parties (like ISP customers).{{</note>}}

**What is the size of a failure domain?** When a BGP router receives an update with an attribute that causes it to hiccup (drop BGP session, crash, or do something else along these same lines), the update is not propagated beyond that router. The worst-case failure domain in a BGP network (or [blast radius](https://blog.ipspace.net/2014/09/schprokits-with-jeremy-schulman-on.html), as Jeremy Schulman would call it) is thus a single device.

{{<note>}}Remember the sequence of events that happen within a BGP router: receive update, insert it in RIB, select the best paths, and finally send best paths. If a router encounters an error anywhere along this sequence, the update that triggered the error is not propagated to the BGP neighbors.{{</note>}}

On the other hand, if you manage to hit a bug in OpenFlow controller that causes the controller to crash after receiving a crafted packet, you'll easily bring down all controllers in the cluster.

**What can be done to protect the controller (or control plane)?** It's pretty easy to protect a BGP router -- there are tons of security-related tools and knobs available in BGP (for more details, read [BGP Operations and Security RFC](https://tools.ietf.org/html/rfc7454)) -- and the receive-process-send mechanism explained in the previous section easily protects the network core from potential exploits received by edge routers.

A controller-based network is like a single device. You need a single exploit and it's game over.

### Want to Know More?

You'll find plenty of details in [SDN Architectures and Deployment Considerations](https://www.ipspace.net/SDN_Architectures_and_Deployment_Considerations) webinar and other webinars in [Advanced SDN Training track](http://www.ipspace.net/Advanced_SDN_Training).
