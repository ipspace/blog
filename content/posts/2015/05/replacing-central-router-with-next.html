---
date: 2015-05-04T08:14:00.000+02:00
tags:
- firewall
- security
- data center
title: Replacing Central Router with a Next-Generation Firewall?
url: /2015/05/replacing-central-router-with-next.html
---

<p>One of my readers sent me this question:</p>
<blockquote class="cite">After <a href="http://www.accuvant.com/blog/next-generation-network-design">reading this blog post</a> and a lot of blog posts about zero trust mode versus security zones, what do you think about replacing L3 Data Center core switches by High Speed Next Generation Firewalls?</blockquote>
<p>Long story short: just because someone writes about an idea doesn’t mean it makes sense. Some things are better left in PowerPoint.<!--more--></p>
<p>Let’s start with raw numbers (and <a href="http://blog.ipspace.net/2013/09/openflow-and-fermi-estimates.html">Fermi estimates</a>). You probably need an order of magnitude more bandwidth <em>within </em>the data center than <em>going out </em>of the data center. If you have a 10GE WAN connection, you probably need 50+ Gbps of core bandwidth in your data center (web hosting companies are an obvious exception).</p>
<p>A single ToR switch can give you 1+ Tbps of linerate layer-3 forwarding performance. In reality, if you’d redesign <a href="http://blog.ipspace.net/2013/08/how-big-is-big-private-cloud.html">most data centers</a> with state-of-the-art equipment, you’d probably be left with 2 ToR switches and a single rack of servers.</p>
<p class="info">I repeated my “Who has more than 2000 VMs” poll @ Interop Las Vegas. The result: a few people in a packed room (way less than 10% of the audience). Afterwards, I did a reality check with <a href="http://wahlnetwork.com/">Chris Wahl</a>, and he told me most of his customers are below 3000 VMs.</p>
<p>In comparison, you can get next-generation firewalls that works at 100 Gbps speeds, but it would probably be more expensive than the rest of your data center (Palo Alto <a href="https://www.paloaltonetworks.com/products/platforms/firewalls/pa-7050/overview.html">needs 400 processors</a> to get that performance, which is probably more cores than most companies need to run their application workload).</p>
<p>Next, placing a firewall in the middle of your data center makes absolutely no sense from the security perspective. You need a full-blown next-generation firewall either at the edge of your data center (the traditional architecture), or close to every VM (<a href="http://blog.ipspace.net/2015/03/microsegmentation-in-vmware-nsx-on.html">microsegmentation</a> approach), but not between internal VLANs – if an intruder breaks into a VLAN shared by multiple applications, it’s <a href="http://blog.ipspace.net/2013/04/compromised-security-zone-game-over-or.html">game over</a> anyway.</p>
<p>Also consider that you’ll probably gain nothing by deep inspection of backup traffic, SQL queries or application JSON/RPC calls? Who will configure all that stuff? Also, don’t forget that most times <a href="http://blog.ipspace.net/2013/05/are-stateless-acls-good-enough.html">packets filters might be good</a> enough for intra-DC traffic generated by applications that use static port numbers (get lost, Microsoft Outlook).</p>
<p>Finally, if you really need full visibility into traffic within your data center (which you won’t get with central firewall anyway, because you’d be missing all intra-VLAN traffic), deploy Netflow or Sflow on your virtual switches… or, if you have a really big budget, go for <a href="https://www.gigamon.com/campaign/Data-Center-Transformation/index.html">Gigamon’s Visibility Fabric</a> (hint: they run tapping VMs in promiscuous mode on every ESXi host).</p>
<h4>Want to know more about microsegmentation?</h4><p>Listen to the <a href="http://blog.ipspace.net/2015/03/microsegmentation-in-vmware-nsx-on.html">NSX Microsegmentation</a> podcast with Brad Hedlund and <a href="http://blog.ipspace.net/2015/01/palo-alto-virtual-firewalls-on-software.html">Palo Alto Virtual Firewalls</a> podcast with Christer Swartz, or watch my <a href="http://www.ipspace.net/Virtual_Firewalls">Virtual Firewalls</a> webinar.</p>

