---
title: "Cisco Virtual Security Gateway (VSG) 101"
date: "2012-10-11T06:49:00.000+02:00"
tags: [ firewalls,VXLAN,security,Data Center,Workshop,Overlay networks,virtualization ]
---

<p>I was talking about Cisco’s VSG in <a href="http://www.ipspace.net/Roadmap/Virtualization_webinars">numerous webinars</a> and <a href="http://demo.ipspace.net/get/Cloud%20Computing%20Networking%20EuroNOG.pdf">presentations</a>, but never managed to write a blog post about this interesting product. Let’s fix that, starting with a <a href="http://demo.ipspace.net/get/D2%20Cisco%20Virtual%20Security%20Gateway%20VSG.mp4">short video</a> from the <a href="http://www.ipspace.net/Cloud_Computing_Networking">Cloud Computing Networking</a> webinar.</p>
<div class="separator" style="clear: both; text-align: center;"><a href="http://demo.ipspace.net/get/D2%20Cisco%20Virtual%20Security%20Gateway%20VSG.mp4" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="300" src="/2012/10/s400-VSG+video.jpg" width="400"/></a></div>
<!--more--><h4>Short summary</h4><ul class="ListParagraph"><li>VSG is a NIC-level firewall. It’s (logically) inserted between a VM NIC and a vSwitch.</li>
<li>Being a NIC-level firewall, VSG has to be a transparent (layer-2) firewall. It has no routing or NAT functionality.</li>
<li>VSG is running in a VM (or two of them for redundancy) that can be deployed on vSphere or on Nexus 1010 appliance.</li>
<li>The VSG VM doesn’t have to be running in the same hypervisor as the VM it’s protecting (<a href="http://blog.ioshints.info/2011/07/introduction-to-virtual-firewalls.html">VMware’s <del>vSphere</del> vShield App</a> or <a href="http://blog.ioshints.info/2011/11/junipers-virtual-gateway-virtual.html">Juniper’s vGW</a> require a per-hypervisor VM).</li>
<li>VSG depends on Nexus 1000V – Nexus 1000V is the only hypervisor switch (at this moment) that can insert a remote service between a VM NIC and a port group to which the VM NIC is connected.</li>
<li>The technology used to insert a service offered by a remote VM between a VM NIC and a port group is called <a href="http://blogs.cisco.com/datacenter/vpath-the-secret-sauce-to-enabling-virtual-network-services/">vPath</a>.</li>
<li>vPath 1.0 uses layer-2 transport and thus requires a dedicated VLAN between the hypervisor switches and the service VM. vPath 2.0 supposedly runs over VXLAN as well.</li>
<li>Initial packets of every session are always redirected to the service VM. After inspecting and approving the session, the service VM can install a 5-tuple shortcut into the hypervisor switch. Subsequent packets of the same session no longer traverse the service VM.</li>
<li>vPath service insertion is configured on a Nexus 1000V <strong>port-profile</strong> (equivalent to vSwitch port group) with the <strong>vn-service </strong>configuration command.</li>
<li>vPath is Cisco’s proprietary technology. It seemed Cisco <a href="http://blogs.cisco.com/datacenter/third-party-virtual-services-on-the-cisco-nexus-1010-x-appliance-start-with-imperva-waf/">started to make the technology available to third parties</a>, but let’s wait to see whether Imperva WAF uses vPath or not. </li>
</ul>
<h4>More information</h4><p>Check out my <a href="http://www.ipspace.net/Roadmap/Virtualization_webinars">virtualization webinars</a> (all of them are included in the <a href="http://www.ipspace.net/Subscription_to_ioshints_webinars">yearly subscription</a>) and <a href="http://blogs.cisco.com/tag/virtual-security-gateway/">VSG blog posts</a> on Cisco’s web site. Also, three Packet Pushers podcasts covered VSG or vPath: <a href="http://packetpushers.net/show-49-cisco-nexus-1000v/">Show 49 (Nexus 1000V)</a>, <a href="http://packetpushers.net/show-73-cisco-asa-1000v-virtual-firewall-nexus-sponsored/">Show 74 (Cisco ASA 1000V)</a> and <a href="http://packetpushers.net/ps-show-12-cisco-vpath-2-0-and-nexus-1000v-with-prashant-ghandi-sponsored/">PQ Show 12 (vPath 2.0)</a></p>

