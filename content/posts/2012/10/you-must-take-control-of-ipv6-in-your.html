---
title: "You MUST take control of IPv6 in your network"
date: "2012-10-03T08:18:00.000+02:00"
tags: [ IPv6,security ]
---

<p>I’m positive most of you are way too busy dealing with operational issues to start thinking about IPv6 deployment (particularly if you’re working in the enterprise world; European service providers using the same “strategy” just <a href="http://www.ripe.net/internet-coordination/ipv4-exhaustion">got a rude wake-up call</a>). Bad idea – if you ignore IPv6, it will eventually blow up in your face. Here’s how:<!--more--></p>
<p>I was writing about the fun you could have <a href="http://blog.ioshints.info/2011/11/ipv6-security-getting-bored-bru-airport.html">enabling IPv6 on an unprotected wireless network</a> (or campus LAN) a while ago. The same thing can happen in your data center. Most recently-released operating systems have IPv6 enabled by default; the moment someone accidentally (or on purpose) starts sending RA messages, all the servers on the same LAN get auto-configured IPv6 addresses.</p>
<div class="separator" style="clear: both; text-align: center;"><a href="/2012/10/s1600-ServerExposure.jpg" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="109" src="/2012/10/s400-ServerExposure.jpg" width="400"/></a></div>
<p>What happens next depends on your firewall strategy and the operating system you’re using:</p>
<ul class="ListParagraph"><li>If you’re not using host-based firewalls, you have a problem anyway (but it’s not getting any worse due to IPv6). The moment one of the servers gets pwned, all other servers become an easy target;</li>
<li>If you’re running Linux, you’re probably using <strong>iptables</strong>. IPv6 is using <strong>ip6tables</strong> (you did configure them, didn’t you?). Windows is better – its firewall works on IPv4 and IPv6.</li>
<li>If you’re protecting your servers with hypervisor-based firewalls like vShield App or Virtual Security Gateway, your VMs might become exposed, as these firewalls don’t support IPv6 ... but then maybe they throw away unknown protocols. Feedback welcome!</li>
</ul>
<p>So are you safe if you’re running Windows on your servers? Actually not, this was just the appetizer. When I was asking <a href="http://packetpushers.net/author/securityprincess/">Mrs. Y</a>, the host of the <a href="http://packetpushers.net/category/podcast-post/healthy-paranoia/">excellent Healthy Paranoia security podcast</a> whether my ramblings make sense, she immediately got creative:</p>
<blockquote class="cite"><p>But I could see far worse scenarios. I could use a dual stack server environment to exploit trust between hosts, MITM attacks, DNS cache poisoning. I could set up a DHCPv6 stateless server, just setting bogus RDNS options. Or, some hosts will actually get their RDNS options from SLAAC, because they run an RDNSS.</p>
<p style="margin-top: 1em">Additionally, are you blocking transition mechanisms at the border? 6to4 and Teredo? I can always use those as exfiltration mechanisms from your servers too. I would have IPS on data center networks looking for IPv6 traffic, even if you aren't officially supporting the protocol. I'm betting there's plenty there.</p>
</blockquote>
<p>In any case, you have to take control. You can enable RA guard (you did buy switches with IPv6 support and RA guard, didn’t you?), but <a href="http://tools.ietf.org/html/draft-gont-v6ops-ra-guard-evasion-01">even that could by bypassed</a>. You could disable IPv6 on all servers, or filter IPv6 ethertype on layer-2 switches. Regardless of what you decide to do, do not ignore IPv6. It will not go away anytime soon.</p>
<h4>Resources to get you started</h4><ul class="ListParagraph"><li>I <a href="http://blog.ioshints.info/search/label/IPv6">wrote a lot about IPv6</a> and there are some <a href="http://packetpushers.net/tag/ipv6/">excellent posts on Packet Pushers web site</a>.</li>
<li>Cisco has IPv6 design guides for <a href="http://www.cisco.com/en/US/docs/solutions/Enterprise/Campus/CampIPv6.html">campus</a> and <a href="http://www.cisco.com/en/US/docs/solutions/Enterprise/Branch/BrchIPv6.html">branch</a> networks. </li>
<li>Juniper has Junos Day One books: <a href="http://www.juniper.net/us/en/community/junos/training-certification/day-one/networking-technologies-series/exploring-ipv6/">Exploring IPv6</a> and <a href="https://www.juniper.net/us/en/community/junos/training-certification/day-one/networking-technologies-series/advanced-ipv6-config/">Advanced IPv6</a>.</li>
<li>Cisco Press published several excellent IPv6 books, including <a href="http://www.amazon.com/gp/product/1587055945/ref=as_li_tf_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1587055945&amp;linkCode=as2&amp;tag=cisioshinandt-20">IPv6 Security</a> and <a href="http://www.amazon.com/gp/product/1587142279/ref=as_li_tf_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1587142279&amp;linkCode=as2&amp;tag=cisioshinandt-20">IPv6 for Enterprise Networks</a>.</li>
<li>I’ve created <a href="http://www.ipspace.net/Roadmap/IPv6_webinars">four IPv6 webinars</a>, including the upcoming <a href="http://www.ipspace.net/IPv6Sec">IPv6 security</a> webinar (<a href="http://ipv6security.eventbrite.com/">register here</a>). You can get access to all of them with the <a href="http://www.ipspace.net/Subscription_to_ioshints_webinars">yearly subscription</a>.</li>
<li>You can also attend the <a href="http://www.nil.com/ls/ip6fd">IPv6 Fundamentals, Design and Deployment</a> course.</li>
<li>Finally, if you’d like to discuss your IPv6 design or deployment ideas with me, check out my <a href="http://www.ipspace.net/ExpertExpress">consulting services</a>.</li>
</ul>
<p>Any other resources worth mentioning? Please write a comment.</p>

