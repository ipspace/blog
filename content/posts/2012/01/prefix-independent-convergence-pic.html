---
title: "Prefix-Independent Convergence (PIC): Fixing the FIB bottleneck"
date: "2012-01-27T07:18:00.000+01:00"
tags: [ IS-IS,OSPF,Service Providers,BGP ]
---

<p>Did you rush to try OSPF Loop Free Alternate on a Cisco 7200 after reading my <a href="http://blog.ioshints.info/2012/01/loop-free-alternate-ospf-meets-eigrp.html">LFA blog post</a> ... and disappointedly discovered that it only works on Cisco 7600? The reason is simple: while LFA does add feasible-successor-like behavior to OSPF, its primary mission is to improve RIB-to-FIB convergence time.<!--more--></p>
<p>If you want to know more details, I would strongly suggest you browse through the <a href="http://www.data.proidea.org.pl/euronog/1edycja/materialy/prezentacje/Pierre_Francois_IP_Fast_Reroute_Applicability.pdf">IP Fast Reroute Applicability</a> presentation Pierre Francois had @ EuroNOG 2011. To summarize what he told us:</p>
<ul class="ListParagraph"><li>It’s relatively easy to fine-tune OSPF or IS-IS and get convergence times in tens of milliseconds. SPF runs reasonably fast on modern processors, more so with incremental SPF optimizations.</li>
<li>A platform using software-based switching can use the SPF results immediately (thus there’s no real need for LFA on a Cisco 7200).</li>
<li>The true bottleneck is the process of updating distributed forwarding tables (FIBs) from the IP routing table (RIB) on platforms that use hardware switching. That operation can take a relatively long time if you have to update many prefixes.</li>
</ul>
<p>The generic optimization of the RIB-to-FIB update process is known as <em>Prefix-Independent Convergence (PIC)</em> – if the routing protocols can pre-compute alternate paths, suitably designed FIB can use that information to cache alternate next hops. Updating such a FIB no longer involves numerous updates to individual prefixes; you have to change only the next hop reachability information.</p>
<p>PIC was first implemented for BGP (you can find more details, including interesting discussions of FIB architectures, in <a href="http://www.data.proidea.org.pl/euronog/1edycja/materialy/prezentacje/Pierre_Francois_BGP_Add-Paths.pdf">another presentation Pierre Francois had @ EuroNOG</a>), which usually carries hundreds of thousands of prefixes that point to a few tens of different next hops. It seems some Service Providers carry way too many routes in OSPF or IS-IS, so it made sense to implement LFA for those routing protocols as well.</p>
<p class="info">In its simplest form, BGP PIC goes a bit beyond exiting EBGP/IBGP multipathing and copies <em>backup path information </em>into RIB and FIB. Distributing alternate paths throughout the network requires numerous additional tweaks, from modified BGP path propagation rules to modified BGP route reflector behavior. More in a future post ...</p>
<h4>The fun part – Where am I going?</h4><p>This is the second article in the path that started with OSPF Loop Free Alternates. Can you guess where I’m going to as I’m slowly unwinding the recursion spaghetti that got me here?</p>
<div class='separator'><img src="http://farm2.static.flickr.com/1219/1357377823_ea76dffe8e.jpg" /><br />No, this definitely doesn't look like my thought process (picture from <a href="http://janeyredbrick.blogspot.com/2007/09/and-now-back-to-posting.html">The Red Brick Road</a>)</div>

