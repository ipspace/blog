---
url: /2012/01/how-could-we-filter-extraneous-bgp/
title: "How could we filter extraneous BGP prefixes?"
date: "2012-01-12T06:57:00.000+01:00"
tags: [ Internet,BGP ]
---

<p>Did you know that <a href="http://www.cidr-report.org/as2.0/#Gains">approximately 40% of BGP prefixes polluting your RIB and FIB</a> are not needed, as they could be either aggregated or suppressed (because an aggregate is already announced)? We definitely need “<a href="http://www.renesys.com/blog/2009/02/the-flap-heard-around-the-worl.shtml">driver’s license for the Internet</a>”, but that’s not likely to happen, and in the meantime everyone has to keep buying larger boxes to cope with people who cannot configure their BGP routing correctly.<!--more--></p>
<p class="note">Before you start writing a comment explaining how multiple prefixes are needed due to lack of traffic engineering capabilities in BGP – the report generated by Geoff Huston takes at least some of that in account.</p>
<div class="separator"><a href="http://www.despair.com/doitlater.html"><img src="http://demotivators.despair.com/doitlaterdemotivator.jpg" width="400"/></a><br/>This is how some ISPs are approaching the fixes to their broken BGP routing</div>
<p>Bill (the reader who wrote me about this issue) is facing a very painful problem: he cannot fit the full BGP routing information he’s receiving from two upstream ISPs into his Sup720-3B and would have to upgrade to Sup720-3BXL. </p>
<p>He noticed that in many cases a BGP prefix and one or more more-specific prefixes share the same next hop, so he could easily drop the more-specific prefixes without changing the forwarding behavior. He simulated this idea on the actual contents of his BGP table and figured out that he could safely drop around 40% of the prefixes he receives. He just needs the inbound filter.</p>
<p>There is no easy way to implement the “drop superfluous more-specific prefixes” filter in Cisco IOS. You could create multiple RIBs (with <strong>neighbor soft-reconfiguration</strong> command) and implement scripting kludges that would generate inbound filters, but those kludges wouldn’t react to real-time changes in BGP tables. </p>
<p>An alternative might be a host-based BGP daemon (like Quagga) that would connect to the upstream ISPs, collect the BGP prefixes, and pass the minimum subset required to the Catalyst 6500. I was never really interested in BGP daemons and thus have no idea where to start looking for such a beast (OK, I do know how to use Google to find Quagga ;). Could you help Bill, preferably with pointers to solutions that already implemented what he’s looking for? Thank you!</p>

