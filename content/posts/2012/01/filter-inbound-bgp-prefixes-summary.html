---
url: /2012/01/filter-inbound-bgp-prefixes-summary.html
title: "Filter inbound BGP prefixes: Summary"
date: "2012-01-16T07:32:00.000+01:00"
tags: [ Internet,BGP ]
---

<p>I got plenty of responses to the <a href="https://blog.ipspace.net/2012/01/how-could-we-filter-extraneous-bgp.html"><em>How could we filter extraneous BGP prefixes post</em></a>, some of them referring to emerging technologies and clean-slate ideas, others describing down-to-earth approaches. Thank you all, you’re fantastic!<!--more--></p>
<p>Almost everyone in the “down-to-earth” category suggested a more or less aggressive inbound filter combined with default routing toward upstream ISPs. Ideally the upstream ISPs would send you <a href="https://blog.ipspace.net/2011/09/responsible-generation-of-bgp-default.html">responsibly generated default route</a>, or you could use static default routes toward well-known critical infrastructure destinations (like root name servers).</p>
<p>The best overall solution came from Killian – Cisco is <a href="ftp://ftp-eng.cisco.com/cons/isp/security/Ingress-Prefix-Filter-Templates/">maintaining a prefix filter</a> that throws away most of the unnecessary garbage.</p>
<p>Someone else also suggested (in an e-mail) dropping all prefixes that are more than three AS away. His reasoning – you’re probably not more than three autonomous systems away from a tier-1 ISP, and it doesn’t make too much sense second-guessing them.</p>
<p class="warn">When implementing this idea, make sure you’re matching three distinct AS numbers (using a regular expression <a href="http://wiki.nil.com/Filter_excessively_prepended_BGP_paths">like this one</a>), not AS paths up to three entries long. AS paths could be longer due to AS-path prepending.</p>
<p>If you want to achieve more balanced traffic load, you could combine this idea with the one from Octavio – accept all prefixes from “near” autonomous systems and all prefixes larger than /18 (or whatever would still fit into your TCAM) from the rest of the Internet.</p>
<p>In any case, you should start your contemplation with the business side of the problem: what’s the true business need for full Internet routing table? Or, as Pete put it, “<em>If you have traffic to justify the peerings, then you can presumably afford the 3CXL (or whatever).</em>”</p>

