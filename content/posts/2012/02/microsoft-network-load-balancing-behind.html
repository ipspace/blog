---
date: 2012-02-15T06:28:00.000+01:00
tags:
- data center
- workshop
- load balancing
title: Microsoft Network Load Balancing Behind the Scenes
url: /2012/02/microsoft-network-load-balancing-behind.html
---

<p>I figured out I <a href="http://www.google.com/search?q=nlb+site:ioshints.info">wrote a lot about Microsoft Network Load Balancing (NLB)</a> without ever explaining how that marvel of engineering works. To fix that omission, here’s a <a href="http://demo.ipspace.net/bin/watch?id=8050da3e-5655-11e1-96be-005056880254">short video</a> taken from the <a href="http://www.ipspace.net/Data_Center_3.0_for_Networking_Engineers">Data Center 3.0 webinar</a>.</p>
<p class="separator" style="clear: both; text-align: center;"><a href="http://demo.ipspace.net/bin/watch?id=8050da3e-5655-11e1-96be-005056880254" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="276" src="/2012/02/s400-MSNLB.png" width="400"/></a><!--more--></p>
<p><strong>Notes and links</strong></p>
<ul class="ListParagraph"><li><a href="http://support.microsoft.com/kb/283028">Microsoft NLB can use IGMP</a>, which can be used with IGMP snooping configured on the switches to limit the inbound traffic flooding to the servers that are actually interested in the traffic.</li>
<li><a href="http://technet.microsoft.com/en-us/library/bb742455.aspx">Network Load Balancing Technical Overview</a>, which includes this gem: “Experience has shown that Cisco routers currently do not accept an ARP response from the cluster that resolves unicast IP addresses to multicast MAC addresses.” (because Cisco’s engineers actually read RFCs before writing the code).</li>
<li><a href="http://www.cisco.com/en/US/products/hw/switches/ps708/products_configuration_example09186a0080a07203.shtml">Catalyst Switches for Microsoft NLB Configuration Example</a> (including the famous static ARP hack).</li>
<li>If you want to use NLB unicast mode within vSphere, you have to <a href="http://www.vmware.com/files/pdf/implmenting_ms_network_load_balancing.pdf">disable RARP packets that are automatically sent after the vMotion events</a> ... because even vSwitch hates being a hub.</li>
</ul>
<h4>More information</h4><p>Several webinars available on ipSpace.net cover <a href="http://www.ipspace.net/Roadmap/Data_center_webinars">data center-specific topics</a>:</p>
<ul class="ListParagraph"><li>Generic data center technologies and designs (including load balancing solutions that make sense) are described in <a href="http://www.ipspace.net/Data_Center_3.0_for_Networking_Engineers">Data Center 3.0 for Networking Engineer</a>.</li>
<li>You’ll find large-scale network designs (including leaf &amp; spine and Clos network architectures) in the <a href="http://www.ipspace.net/Data_Center_Fabrics">Data Center Fabric Architectures</a> webinar. </li>
<li>Learn everything there is to know about VMware’s vSwitch and other VMware-related networking solutions in <a href="http://www.ipspace.net/VMware_Networking_Deep_Dive">VMware Networking Deep Dive</a>.</li>
<li>Cloud networking-specific topics are the focus of <a href="http://www.ipspace.net/Cloud_Computing_Networking:_Under_the_Hood">Cloud Computing Networking – Under the Hood</a> webinar.</li>
</ul>
<p>And don’t forget: you get access to all these webinars (and numerous others) if you buy the <a href="http://www.ipspace.net/Subscription">yearly subscription</a>.</p>

