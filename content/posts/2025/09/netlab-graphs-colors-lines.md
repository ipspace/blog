---
title: "Changing Colors and Line Styles in netlab Graphs"
date: 2025-09-22 07:38:00+0200
tags: [ netlab ]
netlab_tag: graph
---
Last week, I explained how to [generate network topology graphs](/2021/09/netsim-tools-graphs/) (using GraphViz or D2 graphing engines) from a [_netlab_ lab topology](https://netlab.tools/topology-overview/). Let's see how we can make them look nicer (or at least more informative). We'll work with a simple [leaf-and-spine topology](https://github.com/ipspace/netlab-examples/blob/master/graphs/colors-lines/topology.yml) with four nodes[^4N]:

{{<cc>}}Baseline leaf-and-spine topology{{</cc>}}
```
defaults.device: frr
provider: clab

nodes: [ s1, s2, l1, l2 ]
links: [ s1-l1, s1-l2, s2-l1, s2-l2 ]
```

[^4N]: What (based on a true story) some vendors would sell you instead of two leaf switches, or a single, somewhat larger switch. And of course, the fabric has to be based on EBGP because [RFC 7938](https://datatracker.ietf.org/doc/html/rfc7938).

This is the graph generated by **netlab create** followed by **dot graph.dot -T png -o graph.png**:
<!--more-->
{{<figure src="/2025/09/cl-baseline.png" caption="Baseline topology graph">}}

{{<note info>}}
All topologies described in this blog post are [available on GitHub](https://github.com/ipspace/netlab-examples/tree/master/graphs/colors-lines). Click the topology links to open them.
{{</note>}}

What if we'd like to change the color of the spine devices so they stand out? *netlab* [release 25.09](https://netlab.tools/release/25.09/) makes that trivial: use **[graph.fill](https://netlab.tools/outputs/graph/#modifying-global-link-and-node-attributes)** attribute to change the node background color.

To make things a bit more interesting, we'll use a *netlab* [group](https://netlab.tools/groups/) to change these parameters for all spine nodes at once[^CPB], resulting in [this lab topology](https://github.com/ipspace/netlab-examples/blob/master/graphs/colors-lines/spine-color.yml):

{{<cc>}}Changed background color on spine nodes{{</cc>}}
```
defaults.device: frr
provider: clab

groups:
  spines:
    members: [ s1, s2 ]
    graph.fill: '#d26400'

nodes: [ s1, s2, l1, l2 ]
links: [ s1-l1, s1-l2, s2-l1, s2-l2 ]
```

[^CPB]: Remember: copy-paste makes [rockets explode](https://en.wikipedia.org/wiki/Ariane_flight_V88#Launch_failure)

{{<note info>}}
The value of the **fill** attribute has to be a [color](https://graphviz.org/docs/attr-types/color/) recognized by Graphviz and D2. You can use a color name (for example, **red**) or its RGB value. The RGB value has to be a [hex triplet](https://en.wikipedia.org/wiki/Web_colors#Hex_triplet) preceded by a hash sign, and it has to be quoted; otherwise, YAML interprets the hash sign as a comment
{{</note>}}

Here's the resulting graph:

{{<figure src="/2025/09/cl-spine-color.png" caption="Spine nodes have a darker background color">}}

The **graph.fill** and a [few other](https://netlab.tools/outputs/d2/#modifying-global-link-and-node-graph-attributes) attributes are used by GraphViz and D2 output modules, so you'll get consistent colors regardless of which graphing engine you use. Here's the equivalent D2 graph:

{{<figure src="/2025/09/d2-spine-color.png" caption="Node colors are applied to GraphViz and D2 graphs">}}

Next, let's assume that S2 is a backup switch[^WWR], and that the links S2-L1 and S2-L2 are slower than the other fabric links. We can use the **graph.width** attribute to change the link width. Here's the [improvement of our lab topology](https://github.com/ipspace/netlab-examples/blob/master/graphs/colors-lines/link-width.yml) (this time using [link groups](/2023/05/netlab-link-groups/)).

{{<cc>}}Changed link width on primary links{{</cc>}}
```
defaults.device: frr
provider: clab

groups:
  spines:
    members: [ s1, s2 ]
    graph.fill: '#d26400'

nodes: [ s1, s2, l1, l2 ]

links:
- group: primary
  members: [ s1-l1, s1-l2 ]
  graph.width: 2
- group: backup
  members: [ s2-l1, s2-l2 ]
  graph.width: 1
```

[^WWR]: For whatever weird reason, maybe the customer ran out of budget and couldn't afford two decent spine switches.

Here's the resulting graph:

{{<figure src="/2025/09/cl-line-width.png" caption="Primary links are wider">}}

Finally, let's try to do something that's (currently) impossible with the _netlab_ **graph** attributes: changing the text color. To do that, we have to define a new **graph** attribute and map it to a GraphViz attribute ([more details](https://netlab.tools/outputs/d2/#extending-d2-style-attributes))[^D2D].

[^D2D]: Admittedly, from the D2 documentation, but the same approach works for GraphViz graphs.

We can do both with [system defaults](https://netlab.tools/defaults/), first defining a new attribute...

```
defaults.outputs.graph.attributes.node.textcolor: str
```

... and then mapping the **textcolor** node attribute into Graphviz **[fontcolor](https://graphviz.org/docs/attrs/fontcolor/)** attribute:

```
defaults.outputs.graph.style_map.textcolor: fontcolor
```

{{<note info>}}
While you can add new graph attributes in a lab topology, it might be better to define them in [user defaults](https://netlab.tools/defaults/#changing-defaults-in-user-defaults-files) so that they are available in all lab topologies.
{{</note>}}

Now we can add **graph.textcolor** to the **spines** group, resulting in [this lab topology](https://github.com/ipspace/netlab-examples/blob/master/graphs/colors-lines/text-color.yml):

```
defaults.outputs.graph.attributes.node.textcolor: str
defaults.outputs.graph.style_map.textcolor: fontcolor

defaults.device: frr
provider: clab

groups:
  spines:
    members: [ s1, s2 ]
    graph.fill: '#d26400'
    graph.textcolor: white

nodes: [ s1, s2, l1, l2 ]

links:
- group: primary
  members: [ s1-l1, s1-l2 ]
  graph.width: 2
- group: backup
  members: [ s2-l1, s2-l2 ]
  graph.width: 1
```

And here's the final spiffed-up graph:

{{<figure src="/2025/09/cl-text-color.png" caption="White text looks nicer on a dark background">}}

For more details, explore other graph-related netlab articles and the documentation for the:

* [Graphviz output module](https://netlab.tools/outputs/graph/)
* [Graphviz attributes](https://graphviz.org/doc/info/attrs.html)
* [D2 output module](https://netlab.tools/outputs/d2/)
* [D2 styles](https://d2lang.com/tour/style/)
* **[netlab graph](https://netlab.tools/netlab/graph/)** command

### Kicking The (Free) Tires {#trygraphs}

Want to try out the graphs? This is how you can create them in GitHub Codespaces:

* [Start a codespace](https://github.com/codespaces/new/ipspace/netlab-examples) from the `netlab-examples` repository
* When the codespace starts, execute **netlab install graph** in the terminal window
* Change the directory to `graphs/colors-lines` with **cd graphs/colors-lines**

Now you're ready to create and view the graphs:

* Transform one of the YAML files in that directory with **netlab create -o pickle _topology_**.
* Create a graph description file with **netlab graph**.
* Create an SVG graph with **dot graph.dot -T svg -o graph.svg**, or a PNG graph with **dot graph.dot -T png -o graph.png**.
* Start a web server in your codespace with **python3 -m http.server**. The GitHub Codespaces orchestration code automatically detects a new application port and asks whether you want to open it in your browser. If you do, a new browser tab will be connected to the in-container HTTP server.
* Open **graph.svg** from the directory listing and enjoy the new graph.
* Switch back to the devcontainer browser tab, open a new terminal window in it (you're running a web server in the original terminal window), modify the topology files, and repeat the above process to create modified graphs.

Finally, don't forget to stop the codespace. You only get 60 free hours per month.
