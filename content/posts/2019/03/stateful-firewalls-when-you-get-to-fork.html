---
date: 2019-03-27T08:31:00.000+01:00
tags:
- firewall
- security
- cloud
- AWS
title: 'Stateful Firewalls: When You Get to a Fork in the Road, Take It'
url: /2019/03/stateful-firewalls-when-you-get-to-fork.html
---

<p>If you’ve been in networking long enough you’d probably noticed an interesting pattern:</p>
<ul><li>Some topic is hotly debated;</li>
<li>No agreement is ever reached even though the issue is an important one;</li>
<li>The debate dies after participants diverge enough to stop caring about the other group.</li>
</ul>
<p>I was reminded of this pattern when I was explaining the traffic filtering measures available in private and public clouds during the <a href="https://www.ipspace.net/Designing_Infrastructure_for_Private_Clouds">Designing Infrastructure for Private Clouds</a> workshop.<!--more--></p>
<p>Almost a decade ago I was observing a heated “<em><a href="https://blog.ipspace.net/2010/08/i-dont-need-no-stinking-firewall-or-do.html">I don’t need no stinking firewalls</a></em>” debate. Fast forward to 2019 and you’ll find a huge gap: enterprise environments insist on using stateful firewalls in front of application stacks, sometimes deploying complex deep packet inspection, while all you can get from public cloud providers like AWS, Azure or GCP is packet filters with reflexive ACL functionality.</p>
<p>It’s obvious which approach scales. It’s also obvious that the scalable approach (reflexive ACLs) makes perfect sense and works well assuming you have a vague idea what you’re doing.</p>
<div class="note" data-markdown="1">The <a href="https://blog.cloudflare.com/memcrashed-major-amplification-attacks-from-port-11211/">memcrashed</a> crowd proved how clueless <a href="https://blog.erratasec.com/2018/03/some-notes-on-memcached-ddos.html">some people deploying workloads in public cloud</a> could be. </div>
<p>The laws of physics haven’t changed in the meantime: any volume-based DoS attack will crash a stateful firewall before affecting the servers the firewall is protecting. Considering all this, why do we still see stateful firewalls deployed as the weakest link in the application stack?</p>
<p>The only reason I can see is the CYA mentality: security team in an enterprise environment is strictly separate from the application team which is not responsible for the security aspects of whatever they deploy. The security team, in turn, doesn’t trust the application developers and deploys the most complex firewall possible in front of the application stack hoping that Santa Claus and his $vendor elves will save the day.</p>
<p>The real fun starts when the CIO of a dysfunctional organization I just described decides it’s time to move into the cloud. You’ll either see developers that never had to care about security deploying their workloads directly into the public cloud, or security team trying to replicate enterprise environment in a public cloud and desperately trying to figure out how to push all traffic through a firewall running in a virtual machine. Fun times either way ;)</p>
<p>While it’s hard to fix siloed teams (and I stopped trying or caring a long while ago), there’s something we can try to do: educate people who might care. Matthias Luft already covered the big picture in <a href="https://www.ipspace.net/DevOps_and_Security_for_Enterprise_Environments">DevOps and Security for Enterprise Environments</a> webinar, will start the journey into cloud security with <a href="https://www.ipspace.net/Cloud_Security_Basics">Cloud Security Basics</a> webinar on April 16th, and continue with deep dive into individual topics throughout 2019.</p>
<p>You can access both webinars and attend the live session on April 16th with <a href="https://www.ipspace.net/Subscription">Standard ipSpace.net Subscription</a>.</p>

