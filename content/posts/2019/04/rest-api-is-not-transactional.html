---
url: /2019/04/rest-api-is-not-transactional.html
title: "REST API Is Not Transactional"
date: "2019-04-16T08:38:00.000+02:00"
tags: [ Automation ]
---

<p><em>This blog post was initially sent to subscribers of my SDN and Network Automation mailing list. </em><a href="http://www.ipspace.net/Subscribe/Five_SDN_Tips"><em>Subscribe here</em></a><em>.</em></p>
<p>I was walking down the infinite hallways of Cisco Live Europe chatting with the fellow Tech Field Day Extra delegates when I probably blanked out for a minute as the weirdest of thoughts hit me: “<em>REST API is not transactional</em>”</p>
<p><strong>TL&amp;DR</strong>: Apart from using structured data and having error codes REST API is functionally equivalent to Cisco IOS CLI from 1995<!--more--></p>
<h4>Let’s start with an example</h4><p>Imagine you’re configuring a complex application environment on a single switch (to make it simple). You might have to configure:</p>
<ul class="ListParagraph"><li>Several routing domains (VRFs) to enable inline load balancing between them</li>
<li>A dozen segments (VLANs)</li>
<li>Subnets on those segments</li>
<li>Routing with external world</li>
<li>Microsegmentation (the unicorn previously known as reflexive ACLs)</li>
</ul>
<p>Any one of those configuration commands could fail. You could fail to check input data and use a word as IP address, or use an impossible prefix length, or hit some configuration limits (like the number of entries in an ACL), or use duplicate names or…</p>
<p>If you <a href="https://blog.ipspace.net/2016/10/network-automation-rfp-requirements.html">bought the switch from the right vendor</a> (Juniper, Arista or Cisco IOS XR) then you’d just shrug, abort the whole thing, have it automagically removed, and retry. On those same boxes you’d also be able to say <strong>now I’m done </strong>(aka <strong>commit</strong>) and have all the changes implemented at once.</p>
<p>On a few other boxes you could shrug and <strong>rollback </strong>to previous state (assuming you were smart enough to save it when you started).</p>
<p>Both options are well known to programmers dealing with transactional databases for the last 40 years… and are completely missing in <a href="https://blog.ipspace.net/2014/07/what-is-this-api-thingy.html">REST API</a> world (unless the API provider took great pains to implement them).</p>
<h4>Now for REST API</h4><p>Now imagine you’d deploy the same application environment in (almost) any private or public cloud, be it AWS, Azure, GCP, VMware NSX, Cisco ACI… For every object you’d have to configure (VPC, subnet, security group, routing table if you’re deploying on AWS, or tenant, bridge group, EPG, contract… if you’re working with Cisco ACI) you’d execute a REST API call. Any one of those calls might fail. Now what?</p>
<p>Well, you’re on your own. Hopefully you remember what you were doing and what you already created because <a href="https://blog.ipspace.net/2018/09/infrastructure-as-code-netconf-and-rest.html"><em>you’ll have to clean up your own mess</em></a> and you’ll have absolutely no help from the orchestration system <em>because REST API is not transactional</em> so there’s no rollback.</p>
<p><strong>Long story short</strong>: people who claim how bad network device configuration methods are and how they’d be so <a href="https://blog.ipspace.net/2018/04/dont-get-obsessed-with-rest-api.html">much better if only the network devices would have REST API</a> (A) might not know what they’re talking about and (B) will get exactly what they ask for. Do we really have to repeat every mistake anyone else ever made?</p>

