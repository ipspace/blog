---
url: /2019/12/figure-out-what-problem-youre-trying-to.html
title: "Figure Out What Problem You’re Trying to Solve"
date: "2019-12-16T08:38:00.000+01:00"
tags: [ Design,bridging,WAN ]
---

<p>A long while ago I got into an hilarious Tweetfest (note to self: don’t… not that I would ever listen) starting with:</p>
<blockquote><p>Which feature and which Cisco router for layer2 extension over internet 100Mbps with 1500 Bytes MTU</p>
</blockquote>
<p>The knee-jerk reaction was obvious: OMG, not again. The ugly ghost of BRouters (or is it RBridges or WAN Extenders?) has awoken. The best reply in this category was definitely:</p>
<blockquote><p>I cannot fathom the conversation where this was a legitimate design option. May the odds forever be in your favor.</p>
</blockquote>
<p>A dozen “<em>this is a dumpster fire</em>” tweets later the problem was rephrased as:<!--more--></p>
<blockquote><p>Is TCP MSS option available when using bridging over VXLAN?</p>
</blockquote>
<p>Ahem, not in any sane implementation. Bridging (by definition) works on layer 2 (Ethernet) and any sane implementation of bridging does not touch fields two layers above it. I’m positive there’s someone right now “<a href="https://blog.ipspace.net/2019/10/the-cost-of-disruptiveness-and.html">exploring the opportunity</a>” of doing something as stupid as intercepting TCP packets and setting MSS on a Linux bridge (or equivalent). I hope they never get funded (but then there’s Flannel, so my argument is invalid).</p>
<p>Finally, the problem was rephrased along the lines of “I need the same subnet on both sides of the WAN link” which can be <a href="https://blog.ipspace.net/2019/11/stretched-layer-2-subnets-in-azure.html">solved quite trivially with smart application of host routes</a> (or <a href="https://blog.ipspace.net/2017/09/why-is-cisco-pushing-lisp-in-enterprise.html">LISP</a> if you believe in yet another layer of indirection).</p>
<p>Moral of the story: it took an amazingly long time to answer the fundamental question - <strong>What problem are we trying to solve?</strong> Turns out it wasn’t bridging over Internet, it was <a href="https://blog.ipspace.net/2018/01/revisited-need-for-stretched-vlans.html">IP address mobility</a> (or <em><a href="https://blog.ipspace.net/2015/05/reinventing-clns-with-l3-only-forwarding.html">how to emulate what CLNS had forever within the limitations of IP forwarding model</a></em>).</p>
<p>Whenever you’re faced with a similar conundrum start with simple question:</p>
<p><strong>What problem are we solving?</strong> (see above)</p>
<p><strong>Why are we solving this problem?</strong> Quite often because <a href="https://blog.ipspace.net/2013/04/this-is-what-makes-networking-so-complex.html">someone else didn’t get their job done right</a>.</p>
<p><strong>What guarantees do we have that this is a temporary fix?</strong> Hint: None, regardless of what you fervently hope for.</p>
<p><strong>What will happen the next time someone will do a similarly stupid thing?</strong> Hint: most probably you will be told “<em>You solved it the last time, do it again</em>” The moment you decide to become the <a href="https://blog.ipspace.net/2013/08/temper-your-macgyver-streak.html">hero of the duct tape</a>, you’re <a href="https://blog.ipspace.net/2013/09/layer-2-extension-otv-use-cases.html">stuck forever</a> in ever-expanding vicious circle of kludges, technical debt and general stupidity… and you’ll be blamed every time <a href="https://blog.ipspace.net/2019/05/real-life-data-center-meltdown.html">the whole thing explodes</a>.</p>
<p>In most cases, the right answer is “<em>WE DON’T DO THAT, and this is how you should do things the right way</em>”, potentially accompanied with a document documenting the risks and the technical debt that would be created to solve the stupidity… sent to the CIO for personal approval.</p>
<div class="note" data-markdown="1">Never say NO. Saying “<em>we have no properly architected and tested solution addressing this requirement</em>” sounds way more professional ;) </div>
<p>OK, let’s say this approach doesn’t work. That means we’re solving a <strong><a href="https://blog.ipspace.net/2013/01/long-distance-vmotion-stretched-ha.html">real business issue</a></strong> that costs the company <strong>real money</strong> instead of covering for someone else’s incompetence.</p>
<p><strong>How much money are we talking about?</strong> If there’s no answer to this question you know how serious the problem is.</p>
<p><strong>How does that lost money translate into extra budget I need to solve this problem?</strong> If there’s no extra budget, tell them to get lost. Obviously the problem is not serious enough.</p>
<p>Finally, once every dozen blue moons you might get into a situation where someone is ready to throw real money at the problem. At that moment it helps if:</p>
<ul><li>You understand the fundamental challenge you’re trying to solve (not “bridging over WAN” but “IP address mobility”)</li>
<li>You know the potential ways of solving the problem (host routes, LISP)</li>
<li>You have a vague idea which tool might be the right one to solve the problem (most routers should do a decent job, I would prefer Cumulus Linux due to its <em>Redistribute ARP</em> functionality)</li>
<li>You understand the requirements of the underlying infrastructure. For example, if you’re trying to do this trick between your data center and a public cloud you’re bound to figure out a few interesting public cloud packet forwarding details.</li>
</ul>
<p>Long story short: <a href="https://blog.ipspace.net/2015/03/you-must-understand-fundamentals-to-be.html">master the fundamentals</a> (so you know what you’re talking about and understand how a problem could be solved) and be prepared for the unexpected. Lots of networking engineers got prepared with <a href="https://www.ipspace.net/Webinars/">ipSpace.net webinars</a> and <a href="https://www.ipspace.net/Courses">online courses</a>. Give them a try - maybe they will work for you as well.</p>

