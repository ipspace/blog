---
url: /2011/03/wheres-my-aaaa-record.html
title: "Where’s my AAAA record?"
date: "2011-03-18T10:52:00.002+01:00"
tags: [ IPv6,Workshop ]
---

<p>I’ll conclude this week’s IPv6 saga with a fair question I’ve received several times during the last few days: “Where’s your AAAA record?” The snappy answer would be “if you can’t see it, your ISP is not ready for production-grade IPv6”; the reality is a bit more complex.</p>
<!--more--><h4>What’s going on behind the scenes</h4><p>First of all, my infrastructure spans a bit more than a single host. My blog is hosted at Google (Blogger), my web site runs in a VM within the DMZ of <a href="http://www.nil.com/english">my company</a> (if I would be vapor-inclined, I would say it runs within the publicly-accessible part of our private cloud, but we prefer to call it <a href="http://www.nil.com/go/HyperCenter">HyperCenter</a>), the ticketing system for my webinars is run by Eventbrite and the live session and recording delivery relies on Webex. There are also odd third-party bits-and-pieces, including JS-Kit (now Echo) commenting system, Google Analytics and jQuery libraries hosted at Google Code.</p>
<p><strong>Lesson#1</strong> – The infrastructure used by your web presence might be more complex than you realize. When doing an IPv6 readiness audit, make sure you cover all of the bits and pieces.</p>
<p>Blogger (and blog.ioshints.info) is reachable over IPv6, but only by those ISPs that participate in Google’s IPv6 Partner program (see the <em>Supporting documentation </em>section at the bottom of this post). The reason is very simple: global IPv6 connectivity is still not as reliable as the current IPv4 Internet due to heavy use of tunnels and isolated (usually accidental) IPv6 islands within enterprise networks. Recent research by Geoff Huston indicates that the <a href="http://www.potaroo.net/ispcol/2010-12/6to4fail.html">IPv6 connections might fail up to 50 times more often than IPv4 connections</a>. Anyone relying on satisfied visitors (including Google and myself) cannot simply risk losing the dual-stack visitors that might have working IPv4 connectivity and broken IPv6 connectivity.</p>
<p class="note">The rules are clear: if a dual-stack client receives AAAA and A records in a DNS reply, it has to try the IPv6 address first. Apple is supposedly using a different algorithm and there’s the <a href="http://tools.ietf.org/html/draft-wing-v6ops-happy-eyeballs-ipv6-01">Happy Eyeballs</a> draft, but I was only able to find an Erlang implementation (extremely useful for most of us, I guess).</p>
<p>However, nobody really knows how much damage would be done by enabling AAAA records for major web sites (like Google). The <a href="http://isoc.org/wp/worldipv6day/">World IPv6 Day</a> (June 8<span style="vertical-align: super; font-size: 80%;">th</span>) should answer that question – all the <a href="http://isoc.org/wp/worldipv6day/participants/">participating content providers</a> will start advertising A and AAAA records for their web sites and measure the impact.</p>
<p><strong>Lesson#2</strong> – Don’t break your existing web presence by deploying IPv6</p>
<p>Having web sites with AAAA records definitely helps your IPv6 troubleshooting efforts (here’s a <a href="http://isoc.org/wp/worldipv6day/ipv6-enabled-websites/">sample list you can use</a>), but at the moment, it doesn’t matter much whether your web site is reachable over IPv6 from the visitor experience perspective (my personal opinion: there are fewer visitors that cannot get to my web site because they’re using IPv6-only client than there would be those would couldn’t get there because of broken dual-stack connectivity). However, deploying production-grade IPv6 in reasonably-sized enterprise edge and getting the mission-critical web applications IPv6-enabled takes anywhere from weeks to more than a year, so the time to <em>start the education, auditing, budgeting and planning process is now</em>, not in a year’s time.</p>
<p><strong>Lesson#3</strong> – we’re not yet in panic mode, but make sure you won’t wait long enough to land there.</p>
<h4>Eating our own dog food</h4><p>Those of you, who have participated in my <a href="http://www.ioshints.info/Enterprise_IPv6_-_the_First_Steps"><em>Enterprise IPv6 – the first steps</em></a> webinar (register here) or <a href="http://entipv6.eventbrite.com/">bought its recording</a>, might remember the following list of steps you have to go through to get IPv6 deployed in your network edge:</p>
<ul class="ListParagraph"><li>IPv6 readiness audit – from network devices to applications</li>
<li>Get public (Provider Independent) address space</li>
<li>Get IPv6 connectivity from your ISPs (all of them!)</li>
<li>Pilot IPv6 project in a non-critical part of DMZ</li>
</ul>
<p>This is how far we (<a href="http://www.nil.com/">NIL Data Communications</a>) got so far:</p>
<p><strong>Readiness audit</strong>. All devices in our DMZ are IPv6-ready, apart from Cisco’s load balancers and Cisco’s Ironport SMTP gateway, so our redundant web servers cannot be made redundant on the IPv6 side (the firewalls already are after Cisco fixed the failover bugs in ASA) and we have to use NAT64 to receive e-mail over IPv6 (thank you, Cisco, we really appreciate the opportunity to test the transitioning mechanisms!). Our IT doesn’t want to risk figuring out what happens if you enable IPv6 on Lotus Notes ;), so we use NAT64 to make those web servers that use the collaboration masterpiece from the previous millennium reachable over IPv6.</p>
<p>From my perspective, all the software I use for my web site (<a href="http://www.ioshints.info">www.ioshints.info</a>) is IPv6-ready and I even remembered to make the <em>remoteIP </em>column in the logging table in mySQL database supporting my Webinar Management System 40 characters long.</p>
<p><strong>Get public address space</strong>. <a href="http://www.vyncke.org/ipv6status/whois.php/2001:67c:58::/48">Done</a>.</p>
<p><strong>Get IPv6 connectivity</strong>. Done more than a year ago. We use native IPv6 multihoming with all upstream ISPs. You can also check what <a href="http://www.vyncke.org/ipv6status/detailed.php?country=si">Eric Vyncke’s web site has to say about NIL</a> (scroll down; we’re somewhere near the bottom of the list).</p>
<p><strong>Pilot IPv6 project in your DMZ</strong>. Done. Our web servers are reachable over IPv6 as www6.nil.com. </p>
<h4>Getting more information</h4><p>The first steps you have to make when considering IPv6 deployment in your enterprise network are described in my <a href="http://www.ioshints.info/IPv6E101">Enterprise IPv6 – the first steps</a> webinar (<a href="http://www.ioshints.info/Recordings">buy the recording</a> or <a href="http://entipv6.eventbrite.com/">register for an online session</a>).</p>
<h4>Supporting documentation</h4><p>NIL is not part of Google’s IPv6 Partner Program, so the DNS query run through our web server returns the following results:</p>
<pre class="code">$ dig blog.ioshints.info<br/><br/>; &lt;&lt;&gt;&gt; DiG 9.3.3rc2 &lt;&lt;&gt;&gt; blog.ioshints.info<br/>;; global options:  printcmd<br/>;; Got answer:<br/>;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 40842<br/>;; flags: qr rd ra; QUERY: 1, ANSWER: 3, AUTHORITY: 0, ADDITIONAL: 0<br/><br/>;; QUESTION SECTION:<br/>;blog.ioshints.info.            IN      A<br/><br/>;; ANSWER SECTION:<br/>blog.ioshints.info.     78275   IN      CNAME   ghs.google.com.<br/>ghs.google.com.         78275   IN      CNAME   ghs.l.google.com.<br/>ghs.l.google.com.       269     IN      A       74.125.77.121<br/><br/>;; Query time: 3 msec<br/>;; SERVER: 193.77.3.94#53(193.77.3.94)<br/>;; WHEN: Fri Mar 18 10:45:16 2011<br/>;; MSG SIZE  rcvd: 100</pre><p>However, <a href="http://www.arnes.si/en.html">ARNES</a> (Slovenian academic network) does participate in the program and my friend <a href="http://www.linkedin.com/in/matjaz6">Matjaž</a> (their IPv6 guru) was kind enough to run the <strong>dig</strong> query for me verifying that he can reach blog.ioshints.info over IPv6:</p>
<pre class="code">$ dig AAAA blog.ioshints.info<br/><br/>; &lt;&lt;&gt;&gt; DiG 9.6.0-APPLE-P2 &lt;&lt;&gt;&gt; AAAA blog.ioshints.info ;; global options: +cmd ;; Got answer:<br/>;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 50197 ;; flags: qr rd ra; QUERY: 1, ANSWER: 3, AUTHORITY: 4, ADDITIONAL: 4<br/><br/>;; QUESTION SECTION:<br/>;blog.ioshints.info.            IN      AAAA<br/><br/>;; ANSWER SECTION:<br/>blog.ioshints.info.     31577   IN      CNAME   ghs.google.com.<br/>ghs.google.com.         437045  IN      CNAME   ghs.l.google.com.<br/>ghs.l.google.com.       26      IN      AAAA    2a00:1450:8004::79<br/><br/>;; AUTHORITY SECTION:<br/>google.com.             177852  IN      NS      ns2.google.com.<br/>google.com.             177852  IN      NS      ns4.google.com.<br/>google.com.             177852  IN      NS      ns3.google.com.<br/>google.com.             177852  IN      NS      ns1.google.com.<br/><br/>;; ADDITIONAL SECTION:<br/>ns1.google.com.         178060  IN      A       216.239.32.10<br/>ns2.google.com.         178060  IN      A       216.239.34.10<br/>ns3.google.com.         178060  IN      A       216.239.36.10<br/>ns4.google.com.         178060  IN      A       216.239.38.10<br/><br/>;; Query time: 4 msec<br/>;; SERVER: 193.2.1.72#53(193.2.1.72)<br/>;; WHEN: Fri Mar 18 09:29:10 2011<br/>;; MSG SIZE  rcvd: 248</pre>

