---
url: /2011/11/ipv6-security-getting-bored-bru-airport.html
title: "IPv6 Security: Getting Bored @ BRU Airport"
date: "2011-11-09T11:29:00.001+01:00"
tags: [ IPv6,security ]
---

<p>Yesterday’s <a href="http://translate.google.com/translate?sl=sl&amp;tl=en&amp;u=http%3A%2F%2Fgo6.si%2F6-slo-ipv6-summit%2F&amp;act=url">6<span style="vertical-align: super; font-size: 80%;">th</span> Slovenian IPv6 Summit</a> was (as always) full of awesome presentations, this time coming straight from some of the IPv6 legends: check the ones from <a href="https://vox.arnes.si/p84fru6othc/?launcher=false&amp;fcsContent=true&amp;pbMode=normal">Eric Vyncke</a> (and make sure you read his <a href="https://blog.ipspace.net/2009/04/book-review-ipv6-security.html">IPv6 Security book</a>), <a href="https://vox.arnes.si/p5t4ybu8mma/?launcher=false&amp;fcsContent=true&amp;pbMode=normal">Randy Bush</a> and <a href="https://vox.arnes.si/p5p8kzya6qz/?launcher=false&amp;fcsContent=true&amp;pbMode=normal">Mark Townsley</a>. The epic moment, however, was the “I was getting bored” part of Eric’s presentation (starts around 0:50:00). This is (in a nutshell) what he did:<!--more--></p>
<p>He was connected to a public WiFi hotspot and started an equivalent of <a href="http://www.litech.org/radvd/"><em>radvd</em></a><em>.</em> In seconds, he had more than 50 IPv6 neighbors – everyone in the airport using the same public WiFi started using IPv6 after hearing an RA message from Eric.</p>
<p>By itself, that’s nothing new. We know a rogue IPv6 “router” can wreak havoc in your network (that’s why you should always enable RA guard in your switches) – that was one of the major concerns some people had before World IPv6 Day. However, at that moment Eric could easily do man-in-the-middle attack on any IPv6 traffic – anything going to any dual-stack web server would be intercepted by his workstation.</p>
<p>To make matters worse, he could use DHCPv6 to advertise DNS server address, start a fake DNS server (some hosts prefer IPv6 DNS over IPv4 DNS) and create fake dual-stack DNS replies attract even more traffic. DNSsec would prevent that (yeah, everyone is using that) as would SSL (you’re using Facebook and Twitter over SSL, aren’t you?), but he would still be able to do significant damage.</p>
<p>As I said, the man-in-the-middle attack using fake RA messages should be well known, but there are a few other security implications:</p>
<ul class="ListParagraph"><li>Some IPsec clients don’t enforce split tunnel policy on both protocols. Even though your company’s policy requires your VPN client to send all Internet traffic to the central firewall/IDS, IPv6 traffic can bypass that (making you a perfect entry point into your company’s network);</li>
<li>Unix-based operating systems usually have two different firewalls – <em>iptables </em>for IPv4 and <em>ip6tables </em>for IPv6. If someone gives you unexpected IPv6 connectivity, you might become wide open to the Internet at large unless you’ve configured <em>ip6tables</em>.</li>
</ul>
<p>You might argue the situation is no better in the IPv4 world – a lot of hotspots are totally unprotected against ARP spoofing attack, but at least some access points give you the option to configure DHCP guard and DHCP/ARP inspection. Having no wireless experience, here’s a question for the experts: how many access points support RA guard (assuming they even know what IPv6 is)? Please share your experience in the comments.</p>

