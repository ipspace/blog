---
date: 2011-08-10T06:19:00.000+02:00
tags:
- switching
- data center
- workshop
- cloud
title: Stop reinventing the wheel and look around
url: /2011/08/stop-reinventing-wheel-and-look-around/
---

<p>Building large-scale VLANs to support IaaS services is every data center designer’s nightmare and the low number of VLANs supported by some data center gear is not helping anyone. However, as <em>Anonymous Coward </em>pointed out in a comment to my <a href="/2011/08/building-greenfield-data-center/"><em>Building a Greenfield Data Center</em></a><em> </em>post, service providers have been building very large (and somewhat stable) layer-2 transport networks for years. It does seem like someone is trying to reinvent the wheel (and/or sell us more gear).<!--more--></p>
<p>A few disclaimers and caveats first:</p>
<p><strong>The service providers don’t care about the end-to-end stability of your network</strong>. They provide you with a (hopefully stable) L2 transport you’ve asked for and limit your flooding bandwidth (be it broadcasts, multicasts or unknown unicasts). If you’re smart and connect routers to the L2 transport network, you’ll have a working solution (or not – just ask <a href="http://etherealmind.com/who-am-i/">Greg Ferro</a> about VPLS services). If you <a href="/2009/05/vpls-is-not-aspirin/">bridge your sites across a L2 transport network</a>, you’ll eventually get a total network meltdown. In the data center, we don’t have the luxury of ignoring how well the servers or applications work.</p>
<p><strong>St</strong><strong>able large L2 networks are </strong><strong>hard to engineer</strong>. I’ve been talking with a great engineer who actually designed and built a large L2 Service Provider network. It took them quite a while to get all the details right (remember: STP was the only game in town) and make the network rock solid.</p>
<p><strong>Connectivity is </strong><strong>Service Providers’ </strong><strong>core business </strong>and gets the appropriate focus and design/implementation budget. Networking in a data center is usually considered to be a minor (and <a href="http://perspectives.mvdirona.com/2010/10/31/DatacenterNetworksAreInMyWay.aspx">always way too expensive</a>) component.</p>
<p>However, regardless of the differences between service provider transport networks and data center networks, what we’re trying to do in every data center that offers IaaS services <a href="/2011/04/vcloud-architects-ever-heard-of-mpls/">relying on dumb layer-2 hypervisor switches</a> has been done numerous times in another industry. I know that learning from others never equals the thrills of figuring it all out on your own and that networking vendors need a continuous stream of reasons to sell you more (and different) boxes ... but maybe we should stop every now and then, look around, figure out whether someone else has already solved the problem that’s bothering us, and benefit from their experience.</p>
<p>Kurt Bales did exactly that a few days ago – trying to solve multi-tenancy issues that exceeded VLAN limitations of Nexus 5000, he <a href="http://www.network-janitor.net/2011/08/wholesale-virtualisation-and-selective-qinq/">decided to use service provider gear in his data center network</a>. I know he was cheating – he has Service Provider background – but you should read his excellent post (several times) and if you agree with his approach, start looking around – explore what the service providers are doing, what the SP networking gear is capable of doing, and start talking to the vendors that were traditionally strong in L2 service provider market ... or you might decide to <a href="/2011/08/imagine-ruckus-when-hypervisor-vendors/">wait a few months for L3-encapsulating hypervisor switches</a> (and as soon as <a href="http://networkheresy.wordpress.com/bio/">Martin Casado</a> is willing to admit <a href="http://nicira.com/about/">what they’re doing</a> I’ll be more than happy to blog about it).</p>
<h4>More information</h4><p>You’ll find in-depth discussions of data center architectures and virtual networking in my <a href="https://www.ipspace.net/Data_Center_3.0_for_Networking_Engineers">Data Center 3.0 for Networking Engineers</a> and <a href="https://www.ipspace.net/VMnet">VMware Networking Deep Dive</a>.</p>

