---
url: /2011/07/monitor-multiple-interfaces-with-single/
title: "Monitor multiple interfaces with a single EEM applet"
date: "2011-07-08T07:02:00.000+02:00"
tags: [ WAN,EEM ]
---

<p>Michael modified one of my EEM applets to monitor CRC errors on WAN interfaces and notify the operator (via e-mail) when an interface has more than two errors per minute. He wanted to monitor multiple interfaces and asked me whether it’s possible to modify the SNMP event detector somehow. I only had to point him to the <em>event correlation </em>feature of EEM version 2.4 and he sent me the following (tested) applet a few days later.<!--more--></p>
<pre class="code">event manager environment _email_server 10.10.10.10<br/>event manager environment _email_to lan_admin@example.com<br/>event manager environment _info_routername Router<br/>!<br/>event manager applet multiple_if <br/> event tag if_1 interface name Serial0/0/0 parameter input_errors_crc →<br/>  entry-op ge entry-val 2 entry-type increment poll-interval 60<br/> event tag if_2 interface name Serial0/0/1 parameter input_errors_crc → <br/>  entry-op ge entry-val 2 entry-type increment poll-interval 60<br/> event tag if_3 interface name Serial0/0/2 parameter input_errors_crc →<br/>  entry-op ge entry-val 2 entry-type increment poll-interval 60<br/> event tag if_4 interface name Serial0/0/3 parameter input_errors_crc →<br/>  entry-op ge entry-val 2 entry-type increment poll-interval 60<br/> event tag if_5 interface name Serial0/1/0 parameter input_errors_crc →<br/>  entry-op ge entry-val 2 entry-type increment poll-interval 60<br/> event tag if_6 interface name Serial0/1/1 parameter input_errors_crc →<br/>  entry-op ge entry-val 2 entry-type increment poll-interval 60<br/> trigger<br/>  correlate event if_1 or event if_2 or event if_3 or event if_4 or →<br/>   event if_5 or event if_6<br/> action 1.0 syslog msg "CRC failure leased line $_interface_name"<br/> action 2.0 mail server "$_email_server" to "$_email_to" →<br/>  from "$_info_routername@example.com" →<br/>  subject "CRC problems on $_info_routername interface $_interface_name" →<br/>  body "CRC failures have exceeded the threshold"</pre><p>Great job and thanks for sharing, Michael!</p>

