---
date: 2011-12-20T07:01:00.000+01:00
tags:
- firewall
- security
- NAT
title: Is NAT a security feature?
url: /2011/12/is-nat-security-feature.html
---

<p>15 years after NAT was invented, I’m still getting questions along the lines of “is NAT a security feature?” <strong>Short answer: NO!</strong></p>
<p><strong>Longer answer:</strong> NAT has some side effects that resemble security mechanisms commonly used at the network edge. That does NOT make it a security feature, more so as there are so many variants of NAT.<!--more--></p>
<h4>Basic NAT</h4><p>Basic NAT (as defined in <a href="http://tools.ietf.org/html/rfc2663">RFC 2663</a>) performs just the IP address translation (one inside host to one IP address in the NAT pool). The moment the inside host starts a session through the NAT, it becomes fully exposed to the outside world.</p>
<p>When using static basic NAT (statically defined inside-to-outside IP address mapping), the inside host is exposed all the time.</p>
<p><strong>Summary:</strong> Basic NAT provides no security.</p>
<h4>Stateless NAT</h4><p>Some IPv6-to-IPv4 (or 4-to-6) NAT algorithms are <em>stateless </em>– IPv6 address is calculated from the IPv4 using an algorithm (or device configuration). From the security standpoint, stateless NAT is no different from static basic NAT (read: useless).</p>
<h4>Network Address Port Translation (NAPT)</h4><p>NAPT (also known as PAT) keeps a list of established sessions and uses that list to perform address and port translation of inbound and outbound packets. If an unknown packet arrives from the inside interface, a new entry is created, if an unknown packet arrives from the outside interface, it’s dropped.</p>
<p>There is no “standard” NAPT behavior. <a href="http://tools.ietf.org/html/rfc4787">RFC 4787</a> describes various NAPT parameters; the ones most important to the security-related discussion are the <a href="http://tools.ietf.org/html/rfc4787#section-4.1"><em>Address and Port Mapping </em>behaviors</a>. </p>
<p>With the <em>Endpoint independent mapping</em>, the NAT translation table contains just the inside IP address and TCP/UDP port (default behavior on most low-end devices). As soon as the inside host opens a session through NAT, anyone can send TCP or UDP packets to the source port used by that host.</p>
<p>Cisco IOS usually implements <em>Address and Port-Dependent Mapping</em> – the NAT translation table contains full 5-tuple (source/destination address/port and the L4 protocol).</p>
<p>NAPT device using <em>address and port-dependent mapping </em>seems to behave like a stateful firewall, but does not inspect the contents of the TCP/UDP session and does not check the validity of TCP headers. Its behavior is almost identical to <a href="http://www.cisco.com/en/US/docs/ios/sec_data_plane/configuration/guide/sec_cfg_ip_filter_ps10591_TSD_Products_Configuration_Guide_Chapter.html">reflexive ACL feature</a>.</p>
<p><strong>Summary</strong>: NAPT does provide some packet filtering functionality. Static NAPT is identical to a simple packet filter (whatever is translated by the static NAPT rules is permitted).</p>
<h4>Other considerations</h4><p>While we definitely need firewalls and/or packet filters at the network edge, most of today’s attacks work on application-layer, using SQL injection or “Advanced Persistent Threats” like sending an Excel or PDF file with a 0-day exploit to a <a href="http://packetpushers.net/the-clicky-clickety-click-ring-tone/">click-happy user</a>. For more details, please listen to the <a href="http://packetpushers.net/">Packet Pushers</a> <a href="http://packetpushers.net/category/podcast-post/">Podcast</a> <a href="http://packetpushers.net/show-56-securing-an-internet-facing-app-part-1-host-hardening/">Show 56</a> and <a href="http://packetpushers.net/show-61-%E2%80%93-securing-an-internet-facing-app-%E2%80%93-part-2-%E2%80%93-border-routers-firewalls-idsips/">Show 61</a>.</p>
<p>Finally, I will not discuss the absurdity of the security-by-obscurity argument (<em>Let's secure the network by hiding internal addresses with NAT</em>). Please don’t even mention it in the comments.</p>

