---
url: /2011/12/dhcpv6-server-on-cisco-ios-making/
title: "DHCPv6 server on Cisco IOS: making progress"
date: "2011-12-08T07:08:00.000+01:00"
tags: [ DHCP,IPv6 ]
---

<p>DHCPv6 server on Cisco IOS got several highly useful enhancements since the first time I started looking into its behavior. Seems like most of them are implemented only in 15.xS trains (where they are most badly needed one would assume), but there’s hope those changes will eventually trickle down into mainstream IOS.<!--more--></p>
<p><strong>VRF-aware DHCPv6 server</strong> in 15.1(2)S. Previous it was <a href="/2011/09/ipv6-mplsvpn-6vpe-with-pppoe-and-radius/">impossible to do DHCPv6 prefix delegation to CPEs connected to VRF interfaces on the PE-routers</a>. With the VRF-aware DHCPv6 server you can get rid of PE-CE static routing (<a href="/2010/10/dhcpv6-relaying-another-trouble-spot/">a static route is automatically inserted on the PE-router when an IPv6 prefix is delegated to a CPE router</a>) and deploy scalable IPv6 MPLS/VPN networks. </p>
<p>Even better –using VRF-aware DHCPv6 relay, it’s possible to allow the customer to provision all its CPEs (including the inside LAN interfaces on the CPE routers and the PE-CE routing) remotely using its own central DHCPv6 server.</p>
<p><strong>DHCPv6 Relay Chaining</strong> in 15.2(1)S. This feature enables a series of DHCPv6 relays – access switch forwarding a DHCPv6 request to an aggregation-layer switch that forwards the request to the central DHCPv6 server. </p>
<p>Benefit: due to automatic creation of IPv6 static routes toward downstream DHCPv6 clients (or relays), it’s possible to build large-scale access networks without a routing protocol. All you have to do is to advertise an aggregate prefix from the aggregation-layer switch into the core and let DHCPv6-based static routes do their job in the access layer.</p>
<p><strong>DHCPv6 Bulk Lease-Query</strong> in 15.1(1)S. This feature nicely solves the problem of PE-router reload. </p>
<p>The PE-router loses all PE-to-CPE static routes for delegated DHCPv6 prefixes during the reload. The <em>lease-query</em> functionality (<a href="http://tools.ietf.org/html/rfc5007">RFC 5007</a>) allows it to query the central DHCPv6 server, receive the information about the delegated prefixes, and reinstall the static routes. <em>Bulk Lease-Query </em>(<a href="http://tools.ietf.org/html/rfc5460">RFC 5460</a>) is an enhancement that enables bulk transfer of delegated information over a TCP session. </p>
<p>Summary: A major showstopper to DHCPv6 deployment solved. Good job!</p>
<p class="update">Update 2012-01-19: The following paragraph has been rewritten; Cisco IOS release 15.1S supports RFC 4818.</p>
<p><strong>DHCPv6-RADIUS integration (RFC 4818)</strong> works correctly in <a href="/2012/01/dhcpv6-prefix-delegation-with-radius/">Cisco IOS release 15.1(3)S</a> and <a href="http://www.cisco.com/en/US/docs/ios-xml/ios/ipv6/configuration/xe-3s/ip6-adsl-dial.html#GUID-D3135236-3B94-4DAD-B671-548E0DAA3EDF">IOS XE</a>. The documentation <a href="http://www.cisco.com/en/US/docs/ios-xml/ios/ipv6/configuration/xe-3s/ip6-adsl-dial.html#GUID-D3135236-3B94-4DAD-B671-548E0DAA3EDF">still totally confuses a careless reader</a> (the <a href="http://www.cisco.com/en/US/docs/ios-xml/ios/ipv6/configuration/xe-3s/ip6-adsl-dial.html#GUID-951D082F-71F9-43EA-AA6E-036238C68DD6">sample RADIUS configuration</a> is awesome #FAIL, just check the IPv6 prefixes). Just in case you might need it I <a href="/2012/01/dhcpv6-prefix-delegation-with-radius/">published a sample tested Cisco IOS and RADIUS configuration</a>.</p>

