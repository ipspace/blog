---
url: /2006/12/log-terminal-access-to-your-router/
title: "Log terminal access to your router"
date: "2006-12-02T20:44:00.000+01:00"
tags: [ syslog,access control,logging ]
---

In <a href="/2006/11/log-user-privilege-level-changes/">a previous post</a>, I've shown how you can log the changes in interactive user's privilege level. With the <a href="http://www.cisco.com/univercd/cc/td/doc/product/software/ios123/123newft/123t/123t_4/gt_login.htm">Cisco IOS Login Enhancements</a> (introduced in IOS release 12.3(4)T, integrated in 12.4), you can also log all login successes and failures, even when using local user database (a similar functionality was previously achievable only when using central <em>TACACS+</em> or <em>RADIUS</em> server).<br/><br/>The configuration commands to enable terminal access logging are <strong>login on-success log</strong> and <strong>login on-failure log</strong>. You can also specify that you want send SNMP traps in these circumstances (with the <strong>trap</strong> option) or that you only want to log every Nth attempt with the <strong>every <em>n</em></strong> option.<!--more-->After you've configured terminal access logging, the router will start to generate <em>syslog</em> messages similar to the ones below (<em>localport: 23</em> indicates the user was using <em>telnet</em> to access the router, <em>localport: 80</em> that she was using <em>HTTP</em>):<blockquote class="code">%SEC_LOGIN-5-LOGIN_SUCCESS: Login Success [user: test] [Source: 172.16.1.1] [localport: 23] at 19:10:27 UTC Sat Dec 2 2006<br/>1d04h: %SEC_LOGIN-4-LOGIN_FAILED: Login failed [user: a] [Source: 192.168.0.10] [localport: 80] [Reason: Login Authentication Failed - BadPassword] at 19:35:53 UTC Sat Dec 2 2006</blockquote>
If the user accesses the router through the console port, both the source and localport are set to all zeroes:<blockquote class="code">%SEC_LOGIN-5-LOGIN_SUCCESS: Login Success [user: ] [Source: 0.0.0.0] [localport: 0] at 19:10:48 UTC Sat Dec 2 2006</blockquote>

