---
url: /2006/12/cisco-ios-login-enhancements.html
title: "Cisco IOS Login Enhancements"
date: "2007-01-22T09:35:00.000+01:00"
tags: [ security,syslog,access control,logging ]
---

Cisco has in IOS release 12.3(4)T (integrated into 12.4) finally introduced features (long available in Unix and Windows) that slow down dictionary attacks on a router. On top of <a href="https://blog.ipspace.net/2006/12/log-terminal-access-to-your-router.html">logging of login failures</a>, you can also slow down the login process by delaying the router response after a login failure with the <span style="FONT-WEIGHT: bold">login delay <span style="FONT-STYLE: italic">seconds</span></span> command.<br/><br/>On top of that, the you can configure the router to enter quiet mode after several login failures have been detected in specified timeframe with the <strong>login block-for <em>seconds</em> attempts <em>tries</em> within <em>seconds</em></strong> configuration command.<!--more-->The quite mode is implemented by applying an <span style="FONT-WEIGHT: bold">access-list</span> to the VTY lines. You can specify the <span style="FONT-WEIGHT: bold">access-list</span> yourself with the <span style="FONT-WEIGHT: bold">login quiet-mode access-class { <span style="FONT-STYLE: italic">acl-name-or-number</span> }</span> command, otherwise the router generates an access-list named <span style="FONT-WEIGHT: bold">sl_def_acl</span> ... <blockquote class="code">Extended IP access list sl_def_acl<br/>10 deny tcp any any eq telnet log<br/>20 deny tcp any any eq www log<br/>30 deny tcp any any eq 22 log<br/>40 permit tcp any any eq 22 log</blockquote>
and applies it with the <span style="FONT-WEIGHT: bold">access-class in</span> command to the VTY lines.<br/><br/><span style="FONT-WEIGHT: bold; COLOR: rgb(255,0,0)">Warning:</span> If you save router configuration during the quiet period, the access-class command will be saved to NVRAM.<br/><br/>The router also logs the entering and exiting of the quiet mode with log messages similar to the ones below: <blockquote class="code">1d03h: %SEC_LOGIN-4-LOGIN_FAILED: Login failed [user: ] [Source: 192.168.0.6] [localport: 23] [Reason: Login Authentication Failed] at 19:20:17 UTC Sat Dec 2 2006<br/>1d03h: %SEC_LOGIN-1-QUIET_MODE_ON: Still timeleft for watching failures is 43 secs, [user: ] [Source: 192.168.0.6] [localport: 23] [Reason: Login Authentication Failed] [ACL: sl_def_acl] at 19:20:17 UTC Sat Dec 2 2006<br/>1d04h: %SEC_LOGIN-5-QUIET_MODE_OFF: Quiet Mode is OFF, because block period timed out at 19:21:17 UTC Sat Dec 2 2006</blockquote>

