---
url: /2014/08/stp-and-expert-beginners.html
title: "STP and Expert Beginners"
date: "2014-08-04T18:45:00.000+02:00"
tags: [ bridging,virtualization ]
---

<p>Maxim and myself continued <a href="https://blog.ipspace.net/2014/07/is-stp-really-evil.html">our STP discussion</a> and eventually agreed that while STP might not be the best protocol out there (remember: it had to run on <a href="http://en.wikipedia.org/wiki/Zilog_Z80">Z80</a> CPU), it’s the <a href="http://blog.ipspace.net/2012/04/stp-loops-strike-again.html">only standardized thing that prevents nasty forwarding loops</a>, prompting Maxim to ask another seemingly simple question:</p>
<blockquote class="cite">What's so wrong with STP, that there are STP haters out there turning it off wherever they see it?</blockquote>
<p>Welcome to the wonderful world of <a href="http://www.daedtech.com/tag/expert-beginner">Expert Beginners</a>.<!--more--></p>
<p>Imagine you’re facing a problem where <a href="https://blog.ipspace.net/2014/03/what-happened-to-be-conservative-in.html">VMs get cut off from the network after a server-to-switch link is reestablished</a> or where it takes workstations “forever” to connect to the network. You might even figure out that the switch port stays stuck in something called <em>listening </em>for half a minute. Googling around you find the <em>listening </em>state has something to do with something called STP, and you have no clue why you’d need something called STP in your network. Next step: googling for configuration commands that will turn off STP.</p>
<p class="info">Please note that the VM-related behavior is effectively a broken <a href="https://blog.ipspace.net/2011/12/vmware-vswitch-baseline-of-simplicity.html">VMware vSwitch</a> design decision. SMB engineers shouldn’t have been forced to deal with stupidities like this one.</p>
<p>Alternatively, you might have configured <em>portfast </em>and <em>BPDU guard </em>in the past (based on yet another Google search result), and <a href="https://blog.ipspace.net/2011/11/virtual-switches-need-bpdu-guard.html">get hit by a Windows VM entering bridging mode</a>. You want to stop all this nonsense for good, and the only way to do that is to turn off STP.</p>
<p class="info">Do I have to mention that lack of BPDU handling is yet another vSwitch problem, and that <a href="https://blog.ipspace.net/2012/09/dear-vmware-bpdu-filter-bpdu-guard.html">VMware still doesn’t get it</a>?</p>
<p>It would be exceedingly easy to blame the expert beginners making these mistakes, but in reality it’s sad when you figure out many pointy-haired bosses think their engineers need no training, and even worse to realize that many IT practitioners think “fake it till you make it” is not a bad idea.</p>

