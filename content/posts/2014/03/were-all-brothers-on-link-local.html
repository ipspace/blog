---
url: /2014/03/were-all-brothers-on-link-local.html
title: "We’re All Brothers on Link-Local"
date: "2014-03-18T07:31:00.000+01:00"
tags: [ IPv6,security ]
---

<p>I was listening to <a href="https://www.ernw.de/download/TROOPERS_IPv6SecSummit_ERNW_IPv6_Structural_Deficits.pdf">excellent opening presentation</a> Enno Rey had at <a href="https://www.troopers.de/troopers14/troopers14-ipv6-security-summit-2014/index.html">Troopers 2014 IPv6 security summit</a> (he claimed he was ranting, but it sounded more like some of my polite blog posts) and when I’ve seen this slide I could literally hear a blog post clicking together in my head.</p>
<div class="separator"><a href="/2014/03/s1600-We're+All+Brothers+on+Link+Local.jpg" imageanchor="1"><img border="0" src="/2014/03/s400-We're+All+Brothers+on+Link+Local.jpg"/></a></div>
<p>In short: IPv6 has many shortcomings, but this might not be one of them.<!--more--></p>
<h4>The layer-2 subnet model is broken</h4><p>You probably know my opinion on the <a href="https://blog.ipspace.net/2012/05/transparent-bridging-aka-l2-switching.html">current layer-2 networking model</a> – apart from being a <a href="http://blog.ipspace.net/2012/05/layer-2-network-is-single-failure.html">single failure domain</a>, it’s also a <a href="http://blog.ipspace.net/2013/04/compromised-security-zone-game-over-or.html">single security domain</a>.</p>
<p>We can either accept that fact (and work on hardening the end-systems), <a href="https://blog.ipspace.net/2013/11/make-every-application-independent.html">split our oversized layer-2 domains into smaller ones</a> (where all hosts in a smaller domain become totally equivalent from security perspective), or implement a properly hardened network that:</p>
<ul class="ListParagraph"><li>Authenticates users before allowing them to connect to the network;</li>
<li>Assigns addresses to users in an auditable fashion;</li>
<li>Enforces source address checks on every packet sent by the user.</li>
</ul>
<p class="info">Come to think of it, we do have such a network implementation. It’s called Fibre Channel.</p>
<p>Of course the networking industry took another approach:</p>
<ul class="ListParagraph"><li><a href="http://etherealmind.com/poster-eight-levels-vendor-acceptance/">Pretending the problem doesn’t exist</a> until enough users started screaming;</li>
<li>Explaining how solving the problem breaks existing applications and is thus unreasonable;</li>
<li>Implementing layers of kludges on top of broken architecture (large-scale Ethernet subnets), resulting in overly complex solutions like <a href="http://demo.ipspace.net/get/D4%20-%20Source%20Address%20Validation%20Improvement.mp4">SAVI</a>.</li>
</ul>
<p>Obviously it’s not just the vendors’ problem – there are plenty of customers buying cheapest possible switches and later complaining how it’s impossible to properly secure them. Unfortunately some of the really expensive switches aren’t any more secure ;)</p>
<h4>Some Got It Right</h4><p>There’s a single company (AFAIK – I hope you’ll prove me wrong in the comments) that handles the layer-2/layer-3 boundary correctly, restoring the original meaning of <a href="http://en.wikipedia.org/wiki/OSI_model#Layer_2:_data_link_layer">data-link layer</a> (before <a href="https://blog.ipspace.net/2010/07/bridges-kludge-that-shouldnt-exist.html">bridges were invented</a>): Microsoft’s <a href="http://blog.ipspace.net/2013/12/hyper-v-network-virtualization-packet.html">Hyper-V Network Virtualization connects VMs straight to a layer-3 virtual switch</a> that block all rogue RA messages and terminates all ND exchanges. Amazon VPC and Juniper Contrail do something very similar, but only for IPv4.</p>
<p>Finally, there’s always the option of putting every single user in its own subnet. Good luck with that – you ops people and the switch vendors (who will run out of TCAM) will love you.</p>
<h4>Need More Information?</h4><ul class="ListParagraph"><li><a href="http://www.ipspace.net/IPv6">IPv6 webinars</a> on ipSpace.net cover a wide range of IPv6 topics, including <a href="http://www.ipspace.net/IPv6_security">IPv6 security</a>;</li>
<li><a href="http://www.ipspace.net/Data_Center_Fabrics">Data Center Fabrics</a> webinar includes information on forwarding tables (including the size of IPv6 forwarding table) in numerous data center switches from top-10 vendors.</li>
</ul>

