---
date: 2014-11-04T16:58:00.001+01:00
tags:
- SDN
- workshop
- scalability
- cloud
- overlay networks
title: Does a Cloud Orchestration System Need an Underlying SDN Controller?
url: /2014/11/does-cloud-orchestration-system-need.html
---

<p>A while ago I had an interesting discussion with a fellow SDN explorer, in which I came to a conclusion that it makes no sense to insert an overlay virtual networking SDN controller between cloud orchestration system and virtual switches. As always, I missed an important piece of the puzzle: federation of cloud instances.<p><p class="update">2014-11-04 16:48Z: CJ Williams sent me an email with information on SDN controller in upcoming Windows Server release. Thank you!<!--more--></p>
<h4>To Control or Not To Control?</h4><p>Most overlay virtual networking solutions use a network controller (mandatorily called SDN controller in these days of SDN hype) that interacts with the cloud orchestration system through an API (example: Neutron API).</p>
<div class="separator"><a href="/2014/11/s1600-CMP+SDN_OpenStack.jpg" imageanchor="1"><img border="0" src="/2014/11/s400-CMP+SDN_OpenStack.jpg"/></a></div>
<p>Microsoft is the only exception I’m aware of: their cloud orchestration system installs forwarding information directly into the Hype-V extensible virtual switches use PowerShell commandlets.</p>
<div class="separator"><a href="/2014/11/s1600-CMP+SDN_SC_VMM.jpg" imageanchor="1"><img border="0" src="/2014/11/s400-CMP+SDN_SC_VMM.jpg"/></a></div>
<p class="info">Microsoft is adding SDN controller functionality in upcoming Windows Server release. See <a href="http://channel9.msdn.com/Events/TechEd/Europe/2014/CDP-B224">Next Generation Networking in the Next Release of Windows Server</a> and other videos for TechEd Europe 2014 for more details.</p>
<p>There might be use cases where one needs a dedicated SDN controller (example: <a href="http://www.ipspace.net/ProgrammableFlow_Technical_Deep_Dive">NEC’s ProgrammableFlow controller</a> manages flows across physical and virtual switches), but unless one seeks a <a href="https://blog.ipspace.net/2013/06/network-virtualization-at-tor-switches.html">tight physical-to-virtual integration</a> (which is <a href="http://blog.ipspace.net/2011/12/decouple-virtual-networking-from.html">not exactly a good idea</a>), the SDN controller seems superfluous. After all, all we need to do is to <a href="http://blog.ipspace.net/2014/06/is-openflow-best-tool-for-overlay.html">install forwarding information</a> (<a href="http://blog.ipspace.net/2013/12/hyper-v-network-virtualization-packet.html">MAC-to-VTEP, IP-to-VTEP, ARP and IP routing entries</a>) into the soft switches.</p>
<p>Looking at a bigger picture, we don’t have dedicated compute or storage controllers either (unless some marketer with too much time on his hands decides to rebrand vCenter), and while it’s true that <a href="https://blog.ipspace.net/2013/09/why-is-network-virtualization-so-hard.html">virtual networking remains more complex than storage or compute virtualization</a>, I still wasn’t persuaded that there’s a good reason to introduce a dedicated network controller.</p>
<h4>What about hybrid clouds?</h4><p>Cloud orchestration system is supposed to be the ultimate source of truth: it knows all about virtual machines (or containers), their IP and MAC addresses, tenant subnets, security rules, and maybe even load balancing rules.</p>
<p>This paradigm starts breaking down (at least on the virtual network layer) in hybrid cloud environments – virtual machines managed by a cloud orchestration system have to communicate with non-managed endpoints in the same tenant network. Wouldn’t it be great to have an SDN controller that would communicate with tenant networks and exchange reachability information with them?</p>
<div class="separator"><a href="/2014/11/s1600-CMP+SDN_Hybrid.jpg" imageanchor="1"><img border="0" src="/2014/11/s400-CMP+SDN_Hybrid.jpg"/></a></div>
<p>Not necessarily – think about the security implications of having your SDN controller talking directly with the customers. Several vendors avoid this particular can of worms by running a routing instance as a virtual appliance in the tenant space. </p>
<div class="separator"><a href="/2014/11/s1600-CMP+SDN_Appliance.jpg" imageanchor="1"><img border="0" src="/2014/11/s400-CMP+SDN_Appliance.jpg"/></a></div>
<p>Hyper-V uses default routing toward that appliance (a quick-and-efficient solution that introduces a single point of failure), VMware NSX Edge Services Router exchanges routing information with NSX controller which then distributes it across virtual switches. In both cases, the tenants have no direct access to the SDN controller or cloud orchestration system.</p>
<p><strong>Conclusion</strong>: there’s no pressing need to introduce an SDN controller to support hybrid clouds.</p>
<h4>Federated clouds</h4><p>There is another use case where a cloud orchestration system is not good enough: federated cloud instances of the same private or public cloud. These instances have to have end-to-end reachability information to implement virtual tenant networks spanning more than one availability zone or region, and because they implicitly trust each other it makes perfect sense to implement this requirement with network controllers running some sort of distributed eventually consistent reachability information dissemination scheme (also known as a <em>routing protocol</em>).</p>
<div class="separator"><a href="/2014/11/s1600-CMP+SDN_Federation.jpg" imageanchor="1"><img border="0" src="/2014/11/s400-CMP+SDN_Federation.jpg"/></a></div>
<p>Smart overlay virtual networking vendors focusing on large-scale deployments quickly realized the benefits of reusing existing field-tested protocols: Nuage Networks VSP, Juniper Contrail and recently Cisco Nexus 1000V use MP-BGP (VPNv4 or EVPN address families) to distribute reachability information. </p>
<p>VMware NSX and Microsoft Hyper-V currently have no equivalent solution. Their networking solutions are limited to a single cloud instance and rely on tenant-space appliances to stretch virtual networks across multiple instances – an architecture functionally equivalent to MPLS/VPN Inter-AS Option A (and we all know how well that one scales).</p>
<h4>Layering and Packaging</h4><p>Finally, there’s another reason to interpose an SDN controller between cloud orchestration system and virtual switches: product packaging. It’s easier to package overlay virtual networking functionality into a standalone controller and interact with multiple cloud orchestration systems through a thin layer of glue (networking plugins like Neutron). </p>
