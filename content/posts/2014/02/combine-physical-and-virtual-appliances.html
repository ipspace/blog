---
title: "Combine Physical and Virtual Appliances in a Private Cloud"
date: "2014-02-13T06:49:00.000+01:00"
tags: [ firewalls,cloud,virtualization ]
---

<p>I was running a fantastic <em>Network Security in a Private Cloud </em>workshop a few months ago (now you see how long <a href="http://blog.ipspace.net/2013/10/how-do-you-write-blog-post-day.html">blog posts can sit in my to-write queue</a>). The discussions started (predictably) with the mission-impossible task of securing existing underdocumented applications, rigidity of networking team and their firewall rules and similar well-known topics.</p>
<p>The <a href="http://blog.ipspace.net/2013/11/typical-enterprise-application.html"><em>make all firewalls virtual and owned by the application team</em></a><em> </em>idea also encountered the expected resistance, but enabled us to start thinking in more generic terms.<!--more--></p>
<h4>Keep the Physical Firewalls</h4><p>Nobody was willing to get rid of the physical firewalls separating the private cloud from the Internet. The idea of <a href="http://blog.ipspace.net/2013/07/cloud-as-appliance-design.html">connecting the outside network straight to a set of servers</a> (even though they might be in a separate cluster and running solely VM-based firewall appliances) was simply too radical.</p>
<p>However, we also quickly agreed that it doesn’t make sense to maintain thousands of firewall rules on the Internet-facing physical firewalls. Those firewalls should do the basic traffic scrubbing and potentially some content inspection. They could also be combined with IDS/IPS systems or traffic monitoring systems. Most importantly, these devices wouldn’t do any application-specific filtering. Their ruleset would be kept simple and thus easy to monitor and audit.</p>
<p class="note">If you’re building a perimeter defense for a dedicated private cloud infrastructure that does not rely on external services, <a href="http://blog.ipspace.net/2010/08/i-dont-need-no-stinking-firewall-or-do.html">you might not need firewalls at all</a>. Simple packet filters are more than good enough to block unwanted incoming traffic; <a href="http://blog.ipspace.net/2013/03/the-spectrum-of-firewall-statefulness.html">stateful firewalls</a> add value primarily in scenarios where inside clients access outside servers.</p>
<p>The outside perimeter built with trusted physical appliances would thus separate the Internet Wild West from a scrubbed (but still not very trusted) DMZ segment. Proxy servers, shared caching servers and some load balancers could connect straight to that segment. </p>
<div class="separator"><a href="/2014/02/s1600-2Level_FW.png" imageanchor="1"><img border="0" src="/2014/02/s400-2Level_FW.png"/></a></div>
<h4>Add the Applications</h4><p>Individual application stacks would connect to the scrubbed DMZ segment through <a href="http://blog.ipspace.net/2013/05/simplify-your-disaster-recovery-with.html">application-specific firewalls implemented in virtual machines</a> (an approach known in Roman times as <em>divide</em><em> </em><em>e</em><em>t i</em><em>mpera</em>).</p>
<p>The application teams could use vShield Edge, F5 BIG-IP VTM or any other VM appliance that offers firewalling and load balancing in the same VM instance, and the simpler single-VM applications might use <a href="http://blog.ipspace.net/2012/11/virtual-firewall-taxonomy.html">VM NIC firewalls</a> (available in one form or another in most private cloud ecosystems). Each VM appliance would contain the rules specific to the protected application, <a href="http://blog.ipspace.net/2013/12/omg-who-will-manage-all-those-virtual.html">making configuration, monitoring and auditing relatively simple</a>.</p>
<p>Most importantly, the security team would generate sample VM images that the application teams could deploy from a central catalog, making sure the application teams start with a well-configured initial state that they could use as-is or modify it for their own needs (obviously taking full responsibility for any deviation from the baseline).</p>
<h4>Need More Information?</h4><p>I can help you design a similar solution through one or more <a href="http://www.ipspace.net/ExpertExpress">virtual meetings</a>; we could also set up an <a href="http://www.ipspace.net/Consulting">on-site workshop</a> with your team and your peers. For more technical details, check out my <a href="http://www.ipspace.net/Cloud">cloud infrastructure resources</a> and register for the <a href="http://www.ipspace.net/BCloud">Designing Private Cloud Infrastructure</a> webinar.</p>

