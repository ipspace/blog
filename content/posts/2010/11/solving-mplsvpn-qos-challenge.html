---
date: 2010-11-05T08:46:00.000+01:00
tags:
- VPN
- workshop
- MPLS VPN
- QoS
title: Solving the MPLS/VPN QoS challenge
url: /2010/11/solving-mplsvpn-qos-challenge.html
---

<p>Two weeks ago I <a href="https://blog.ipspace.net/2010/10/qos-over-mplsvpn-networks.html">wrote about the challenges</a> you’ll encounter when trying to implement end-to-end QoS in an enterprise network that uses MPLS/VPN service as one of its transport components. Most of the issues you’ll encounter are caused by the position of the user-SP demarcation point. The Service Providers smartly “assume” the demarcation point is the PE-router interface ... and everything up to that point (including their access network) is your problem.</p>
<p style="clear: both; text-align: center;"><a href="/2010/11/s1600-mplsqos_before.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="87" src="/2010/11/s400-mplsqos_before.png" width="400"/></a></p>
<!--more--><p>The only workable solution to the QoS-across-MPLS/VPN problem I found (and believe me, every time I meet a customer using MPLS/VPN, the issue pops up) is to move the demarcation point. Instead of trying to deal with the hidden complexities of unknown access networks, ask the Service Provider to install their CE-routers at your premises, like they did in the old days when they were trying to sell Frame Relay as <em>Managed Network </em>service.</p>
<p style="clear: both; text-align: center;"><a href="/2010/11/s1600-mplsqos_after.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="87" src="/2010/11/s400-mplsqos_after.png" width="400"/></a></p>
<p>The only task left to you is to shape your outbound traffic to the contractual rate (and <a href="http://wiki.nil.com/Traffic_shaping_in_Cisco_IOS">queue within the shaping queue</a> if necessary) and the rest is now purely the Service Provider’s responsibility. Make sure you have enforceable SLA violation penalties in your contract, deploy SLA-measurement tools (our <a href="http://www.nil.si/go/nil_monitor">NIL Monitor</a> comes to mind), show your SP account manager the graphs (just to let them know you might have supporting documentation to enforce the penalties) ... and watch the QoS miraculously work as expected (OK, it helps if you’re big enough and if they know what they’re doing).</p>
<h4>More information</h4><p>If you’d like to get an overview of numerous VPN services, their benefits, drawbacks and challenges you might encounter deploying them, check out my <a href="http://www.ioshints.info/Choose_the_optimal_VPN_service"><em>Choose the Optimal VPN Service</em></a> webinar (<a href="http://choosevpn.eventbrite.com/">register here</a> or <a href="http://choosevpn.eventbrite.com/">buy a recording</a>).</p>
<p class="note"><strong>Note:</strong> This brilliantly simple solution was mentioned to me by one of my customers. For obvious reasons I have to keep quiet, but you know who you are.</p>

