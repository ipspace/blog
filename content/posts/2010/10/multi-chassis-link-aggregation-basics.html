---
title: "Multi-chassis link aggregation (MLAG) basics"
date: "2010-10-01T07:24:00.008+02:00"
tags: [ Link aggregation,switching,Data Center,Workshop,LAN ]
---

<p>If you ask any Data Center networking engineer about his worst pains, I’m positive Spanning Tree Protocol (STP) will be very high on the shortlist. In a well-designed fully redundant hierarchical network where every device connects to at least two devices higher in the hierarchy, you lose half the bandwidth to STP loop prevention whims.</p>
<p style="clear: both; text-align: center;"><a href="/2010/10/s1600-STP_Blocking.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="/2010/10/s320-STP_Blocking.png" width="313"/></a></p>
<p>Of course you can try to dance around the problem:</p>
<!--more--><ul class="ListParagraph"><li>Push routing as far south (<a href="http://twitter.com/ioshints/status/24790826440">down is no longer popular with Data Center vendors</a>) as you can ... and get a violent kickback from the server admins when they realize <a href="http://blog.ioshints.info/2010/09/vmotion-elephant-in-data-center-room.html">they cannot move the VMs at will anymore</a>;</li>
<li>Play with per-VLAN costs in PVST+ or MSTP, ensuring the need for constant supervision and magnificent job security;</li>
<li>Deploy hot-off-the-press technologies like <a href="http://blog.ioshints.info/2010/06/thrills-of-trill.html">TRILL or FabricPath</a>.</li>
</ul>
<p>... or you could decide to use a more humble approach and deploy multi-chassis link aggregation.</p>
<h4>Link Aggregation Basics</h4><p>Link aggregation is an ancient technology that allows you to bond multiple parallel links into a single virtual link (from the STP perspective). With parallel links being replaced by a single link, STP detects no loops and all the physical links can be fully utilized.</p>
<p style="clear: both; text-align: center;"><a href="/2010/10/s1600-LAG_Basic.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="200" src="/2010/10/s200-LAG_Basic.png" width="109"/></a></p>
<p>For whatever reason, vendors like to use all other terms but link aggregation. You’ll hear about <em>port channel</em>, <em>Etherchannel</em>, <em>link bonding</em> or <em>multi-link trunking</em>.</p>
<h4>Multi-Chassis Link Aggregation</h4><p>Imagine you could pretend two physical boxes use a single control plane and coordinated switching fabrics ... then the links terminated on two physical boxes actually terminate within the same control plane and you could aggregate them. Welcome to the wonderful world of Multi-Chassis Link Aggregation (MLAG).</p>
<p style="clear: both; text-align: center;"><a href="/2010/10/s1600-MCLA.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="200" src="/2010/10/s200-MCLA.png" width="178"/></a></p>
<p>MLAG nicely solves the STP problem: no bandwidth is wasted and close-to-full redundancy is retained (make sure you always read the smallprint to understand what happens if the switch hosting the control plane fails).</p>
<h4>Standardization? No, thanks</h4><p>MLAG is obviously a highly desirable tool in your design/deployment toolbox ... but no vendor (including those that promote their <a href="http://h30507.www3.hp.com/t5/HP-Networking/bg-p/167/label-name/converged%20networking">standard-based open approach</a>) has taken the pains to start the standardization effort. Proprietary technology lock-in is obviously still a lucrative approach.</p>
<p>The architectural approaches used by individual vendors are widely different: sometimes they completely separate the control plane from the switching matrix (high-end solution from Juniper), turn one of the control planes into half-comatose state (Cisco with VSS), use cooperative control planes (Cisco with vPC) or a stacking (preferably called <em>distributed</em> or <em>intelligent</em>) solution (Cisco, HP and Juniper).</p>
<h4>More information</h4><p>You’ll get a high-level overview of all virtualization, LAN reference architectures, multi-chassis link aggregation, port extenders and large-scale bridging (including TRILL and FabricPath) in my <a href="http://www.ioshints.info/DC30">Data Center 3.0 for Networking Engineers</a> webinar (<a href="http://www.ioshints.info/SingleRecording?code=DC30">buy a recording</a> or <a href="http://www.ioshints.info/Subscription">yearly subscription</a>).</p>

