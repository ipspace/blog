---
date: 2010-06-28T06:30:00.005+02:00
tags:
- DMVPN
- security
- IP routing
title: uRPF violation logging not working on 12.4T
url: /2010/06/urpf-violation-logging-not-working-on.html
more_blurb: True
---

<p>One of the scenarios I’m discussing in the <a href="http://www.ipspace.net/DMVPN"><em>DMVPN webinar</em></a> is redundant DMVPN network with two ISPs. It’s not a particularly complex setup ... unless the ISPs decide to deploy anti-spoofing filters (more precisely: unicast RPF checks) in which case it becomes crucially important which outbound interface you use for your DMVPN tunnel.</p>
<p>Anyhow, I was trying to make the whole thing work in a lab and it was repeatedly failing, so I decided to log uRPF violations. According to the documentation, it’s a piece of cake:</p>
<!--more--><ul class="ListParagraph"><li>Define an ACL that denies and logs packets</li>
<li>Use the ACL in <strong>ip verify unicast source </strong>interface configuration command.</li>
</ul>
<p>Sounds simple. I’ve used these configuration commands ...</p>
<pre class="code">interface Serial2/3<br/> description Link to R2<br/> ip address 10.0.8.13 255.255.255.252<br/> ip verify unicast source reachable-via rx 199<br/> encapsulation ppp<br/> no peer neighbor-route<br/>!<br/>access-list 199 deny   ip any any log</pre><p>... and it worked like a charm in 15.0(1)M, my <em>Internet </em>router generated lots of syslog messages similar to these:</p>
<pre class="code">%SEC-6-IPACCESSLOGP: list 199 denied udp 10.0.8.10(0) -&gt; 10.0.8.2(0)<br/>%SEC-6-IPACCESSLOGP: list 199 denied udp 10.0.8.10(0) -&gt; 10.0.7.17(0)</pre><p>12.4T? Accepts the ACL parameter and remains mum. Great inter-release consistency ;)</p>
