---
date: 2010-05-24T07:09:00.005+02:00
tags:
- IP services
- SAN
- workshop
title: 'iSCSI: Moore’s Law won'
url: /2010/05/iscsi-moores-law-won.html
---

<p>A while ago I was <a href="https://blog.ipspace.net/2009/12/iscsi-and-san-two-decades-of-rigid.html">criticizing the network-blindness of the storage industry</a> that decided to run 25-year old protocol (SCSI) over the most resource-intensive transport protocol (TCP) instead of fixing their stuff or choosing a more lightweight transport mechanism. My argument (although theoretically valid) became moot a few months ago: <a href="http://download.intel.com/support/network/sb/inteliscsiwp.pdf">Intel and Microsoft have demonstrated an iSCSI solution</a> that can saturate a 10GE link and perform more than 1 million I/O operations per second. Another clear victory for the Moore’s Law.</p>
<p class="more">You’ll find introduction to SCSI, Fiber Channel, iSCSI and server virtualization in the <a href="https://www.ipspace.net/Next-generation_IP_services"><em>Next Generation IP Services</em></a> webinar.</p>
<!--more--><p><strong>Why is this important?</strong> iSCSI was always considered an inferior (but admittedly cheaper) solution when compared with Fiber Channel (FC). This benchmark clearly shows that iSCSI performance no longer lags behind FC. iSCSI is thus a viable alternative for network designers that want to build converged LAN/SAN networks.</p>
<p><strong>How did they do it?</strong> Intel has built a large number of <a href="http://download.intel.com/support/network/sb/inteliscsiwp.pdf">TCP acceleration techniques in its Gigabit Ethernet chipsets</a> (<a href="http://blog.fosketts.net/2010/03/19/microsoft-intel-starwind-iscsi/">here’s a quick summary</a>). For example, the <a href="http://download.intel.com/design/network/prodbrf/321731.pdf">Intel 82599 10GE controller</a> handles IP, TCP and UDP checksums, transmit-side TCP segmentation and <a href="http://docs.google.com/viewer?a=v&amp;q=cache:xAB_yAf-wI4J:citeseerx.ist.psu.edu/viewdoc/download%3Fdoi%3D10.1.1.85.5266%26rep%3Drep1%26type%3Dpdf+tcp+receive+side+coalescing&amp;hl=en&amp;pid=bl&amp;srcid=ADGEESj7vxxbw7tFiU6miAoY4dk0Qtv9A7bCvXPXcrhYY-3tDfK7QnF9rl7NFtmD1H">receive-side coalescing</a>. Going even further, recent Intel CPUs based on <a href="http://en.wikipedia.org/wiki/Intel_Nehalem_(microarchitecture)">Nehalem</a> and <a href="http://en.wikipedia.org/wiki/Intel_Westmere_(microarchitecture)">Westmere</a> <a href="http://en.wikipedia.org/wiki/Microarchitecture">microarchitectures</a> have dedicated instructions that can <a href="http://download.intel.com/design/intarch/papers/323405.pdf">compute CRC checksums extremely efficiently</a>.</p>
<p class="note">You might think that you don’t need CRC32 checksum in iSCSI as TCP already checksums its payload and the transmission errors are discovered by layer-2 checksums. Not true, go through <a href="https://www.research.ibm.com/haifa/satran/ips/PaloAlto-MarkBakke-crc-recovery.pdf">this presentation from Mark Bakke</a> (IBM Research).</p>
<p><strong>Why did Intel create such a chipset?</strong> Definitely not just to solve the iSCSI performance problems; iSCSI is just one of the high-bandwidth TCP applications, other such applications include web hosting of static content or <a href="https://blog.ipspace.net/2009/07/netflix-summary.html">Netflix-style video streaming</a>. Without TCP offload, an Intel-based server tops out at Fast Ethernet or Gigabit Ethernet speeds (with CPU running at 100% utilization). Offload functions in the Gigabit Ethernet controllers help you get the 10GE speeds at reasonable CPU loads.</p>
<p class="note">Last but not least, you might wonder why I’m interested in this topic. Chipsets and computer architectures were my first (geek) love before I’ve discovered networking. I’ve even designed and <a href="http://en.wikipedia.org/wiki/Wire_wrap">wire-wrapped</a> my own <a href="http://en.wikipedia.org/wiki/Z80">Z80</a>-based motherboard and run an <a href="http://en.wikipedia.org/wiki/CP/M">emulation of CP/M environment</a> and <a href="http://en.wikipedia.org/wiki/Turbo_pascal">Turbo Pascal</a> on it.</p>

