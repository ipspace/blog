---
title: "Shorter display of OSPF database"
date: "2008-07-14T07:24:00.004+02:00"
tags: [ OSPF,Tcl,command line interface,Show filters ]
---

Recently I had to explore the behavior of Cisco IOS OSPF implementation and had to inspect OSPF database on routers in various areas. If you're only interested in the contents of the database (not in low-level troubleshooting), variety of LSA fields (including LS Age, Options, Checksum, Length ...) are just cluttering the printout, so I fine-tuned the show filter to exclude all the non-relevant fields, ending with <b>show ip ospf database <em>parameters</em> | exclude LS|Options|Check|Len|(MTID:[ 0-9]+$)</b> (the MTID field appears in IOS release 12.2SRC).<!--more-->To make the command more useful, I've changed it into a short Tcl script (using <a href="http://blog.ioshints.info/2008/07/simple-cli-extensions-handling-special.html">steps from the post explaining how to execute complex CLI commands from Tcl</a>) stored in <em>flash:ospfdb.tcl</em> … <pre class="code">set cmd {show ip ospf database }<br/>append cmd $argv<br/>append cmd { | excl LS|Options|Check|Len|(MTID:[ 0-9]+$)}<br/>puts [exec $cmd]</pre>… and defined <b>alias exec ospfdb flash:ospfdb.tcl</b>. I could then easily inspect the contents of various parts of OSPF database I was interested in, for example:<br/><pre class="code">a3#<b>ospfdb external 0.0.0.0</b><br/> <br/>            OSPF Router with ID (10.0.1.3) (Process ID 1)<br/> <br/>                Type-5 AS External Link States<br/> <br/>  Link State ID: 0.0.0.0 (External Network Number )<br/>  Advertising Router: 10.0.1.5<br/>  Network Mask: /0<br/>        Metric Type: 2 (Larger than any link state path)<br/>        Metric: 1 <br/>        Forward Address: 0.0.0.0<br/>        External Route Tag: 1</pre><div class="more">You can find more Tclsh-related information in the <a href="http://wiki.nil.com/Tclsh_on_Cisco_IOS_tutorial">Tclsh on Cisco IOS tutorial</a>. Sample Tclsh scripts are available in the <a href="http://wiki.nil.com/Tclsh_script_library">Tclsh script library</a>. If you need expert help in planning, developing or deploying Tclsh scripts in your network, <a href="http://blog.ioshints.info/2006/01/contact-me.html">contact the author</a>.</div>

