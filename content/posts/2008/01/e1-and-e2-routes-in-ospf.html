---
url: /2008/01/e1-and-e2-routes-in-ospf.html
title: "OSPF route selection rules"
date: "2011-04-16T07:32:00.000+02:00"
tags: [ OSPF ]
---

<p>OSPF implementation in Cisco IOS deviates slightly from OSPF/NSSA standards (<a href="http://tools.ietf.org/html/rfc2328">RFC 2328</a> and <a href="http://tools.ietf.org/html/rfc3101">RFC 3101</a>). These are the OSPF route selection rules as implemented by Cisco IOS release 12.2(33)SRE1 (all recent releases probably behave identically): </p>
<p><strong>Note:</strong> Update history is at the end of the post</p>
<!--more--><ul><li>Intra-area routes are preferred over inter-area or external routes <em>regardless of their cost</em>; see <a href="http://tools.ietf.org/html/rfc2328#page-170">Section 16.2 paragraph (6) of the OSPF RFC</a>.</li>
<li>Inter-area routes are preferred over external routes; see <a href="http://tools.ietf.org/html/rfc2328#page-169">Section 16.2 paragraph (5) of the OSPF RFC</a>.</li>
<li>E1 routes are preferred over E2 routes; see <a href="http://tools.ietf.org/html/rfc2328#page-174">Section 16.4 paragraph (6) of the OSPF RFC</a>.</li>
<li>External routes received from an intra-area ASBR should be preferred over external routes received from ASBRs in other areas. <a href="http://blog.ioshints.info/2008/02/common-sense-prevails-over-rfc-2328.html">Cisco IOS ignores this rule</a> even after configuring <strong>no compatible rfc1583</strong> (<a href="http://tools.ietf.org/html/rfc2328#page-175">Section 16.4.1</a> of the OSPF RFC) <li>When comparing E1 routes, the route metric is the external cost added to the internal cost; see <a href="http://tools.ietf.org/html/rfc2328#page-175">Section 16.4 paragraph (6.d) of the OSPF RFC</a>.</li>
<li>The internal cost of an E1/E2 route is the cost between the current router and the forwarding address specified in the Type-5 LSA (or originating ASBR if the forwarding address is set to 0.0.0.0); see <a href="http://tools.ietf.org/html/rfc2328#page-173">Section 16.4 paragraph (3) of the OSPF RFC</a>.</li>
<li>When comparing E2 routes, only the external costs are compared; see <a href="http://tools.ietf.org/html/rfc2328#page-174">Section 16.4 paragraph (6.b) of the OSPF RFC</a>.</li>
<li>If multiple E2 routes have the same external cost, the internal cost (as above) is compared; see <a href="http://tools.ietf.org/html/rfc2328#page-175">Section 16.4 paragraph (6.d) of the OSPF RFC</a>.</li>
<li>NSSA (type-7 LSA) routes should be preferred over external (type-5 LSA) routes (<a href="http://tools.ietf.org/html/rfc3101#page-13">paragraphs (6.c) and (6.e) of Section 2.5</a>  of RFC 3101). Cisco IOS prefers external routes over NSSA routes; even if they have the same cost as the external routes (and <strong>maximum-path</strong> is configured), NSSA routes are not entered in the IP routing table.</li>
<li>It seems the final tie-breaker is the LSA stability (or its position in the topology database/SPF tree?). For example, if the router cannot enter all equal-cost external routes into the IP routing table (based on <strong>maximum-path</strong> value), it appears to select the more stable ones (described by LSAs that have been longer in the OSPF topology database).</li>
</li>
</ul>
<div class="update">Update history:<ul><li>The original version of this post was published on 2008-01-17.</li>
<li>The post was updated and renamed on 2011-03-30 after a lengthy (and very productive) discussion with one of my readers.</li>
<li>2011-04-16: Fixed the final tie-breaker part.</li>
<li>2016-02-19: Fixed a typo - early OSPF RFC was RFC 1583, not RFC 1683</li>
</ul>
</div>

