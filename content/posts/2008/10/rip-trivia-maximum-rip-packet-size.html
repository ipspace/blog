---
title: "RIP trivia: maximum RIP packet size varies between Cisco and Juniper routers"
date: "2008-10-03T06:44:00.001+02:00"
tags: [ RIP ]
---

<div class="bloggerBody"><p>Let’s conclude the RIP week with an interesting observation made by Yuri Selivanov: when using MD5 authentication with RIP, Cisco routers send 532-byte UDP datagrams while Juniper routers send 512-byte UDP datagrams. The maximum number of route entries (RTE) in a RIP datagram and its size thus varies based on authentication mechanism and router software:</p>
<table cellpadding="0" cellspacing="0" class="codeTable"><tr class="TRFirst"><th style="text-align: left;">Authentication type</th><th style="text-align: left;">Cisco IOS</th><th style="text-align: left;">JunOS</th></tr><tr><td valign="top">None</td><td valign="top">25/512</td><td valign="top">25/512</td></tr><tr><td valign="top">Password</td><td valign="top">24/512</td><td valign="top">24/512</td></tr><tr class="TRLast"><td class="TDLast" valign="top">MD5</td><td class="TDLast" valign="top">24/532</td><td class="TDLast" valign="top">23/512</td></tr></table><p>Somehow people expect RIP datagrams to be at most 512 bytes long, which (as you can see from the table) is not always the case.</p>
<!--more--><p>Obviously I've tried to figure out whether that’s another bug in Cisco IOS (as I’ve reported in the past, the developers sometimes <a href="http://blog.ioshints.info/2006/12/cisco-ios-violates-rfc-2616-http11.html">tend to</a> <a href="http://blog.ioshints.info/2008/08/eem-violates-rfc-822.html">ignore</a> <a href="http://blog.ioshints.info/2008/09/mpls-te-if-you-want-standard-compliance.html">the standards</a>), but it turns out (in my opinion) that the problem lies in ambiguous RFC (<a href="http://tools.ietf.org/html/rfc2082">RFC 2082</a> and <a href="http://tools.ietf.org/html/rfc4822">RFC 4822</a>). </p>
<p>RIP v2 standard (<a href="http://tools.ietf.org/html/rfc2453">RFC 2453</a>) states that a RIP packet contains at most 25 RTEs and that the authentication uses the first RTE, allowing up to 24 RTEs in the RIP update. RIPv2 cryptographic authentication standard (<a href="http://tools.ietf.org/html/rfc4822">RFC 4822</a>) uses the information in the first RTE (matching the specs of RFC 2453) and appends variable-length authentication data after the RIP packet. </p>
<p>For MD5 authentication the digest size happens to be 16 bytes; together with the 4-byte header the authentication trailer happens to be 20 bytes, which is equal to RTE size. Juniper developers thus decided to reduce the number of useful RTEs to 23, whereas Cisco developers read the standard more literally. Anyhow, if anyone would care to implement HMAC-SHA1 digest instead of MD5, the authentication data would be 20 byte long, resulting in an 24-byte authentication trailer.</p>
</div>

