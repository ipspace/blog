---
title: "OSPF ignores subnet mask mismatch on point-to-point links"
date: "2008-10-16T06:34:00.001+02:00"
tags: [ OSPF,PPP,WAN ]
---

<div class="bloggerBody"><p>The common wisdom says that the subnet mask mismatch will stop the OSPF adjacency from forming (I’ve included a <a href="http://blog.ioshints.info/2008/10/troubleshooting-ospf-adjacencies.html">sample debugging printout in yesterday’s post</a>). In reality, the subnet mask is checked only on the multi-access interfaces and is ignored on point-to-point links. The source of this seemingly weird behavior is Section 10.5 of <a href="http://tools.ietf.org/html/rfc2328">RFC 2328</a> which says:</p>
<blockquote class="cite">The generic input processing of OSPF packets will have checked the validity of the IP header and the OSPF packet header. <b>Next, the values of the Network Mask, HelloInterval, and RouterDeadInterval fields in the received Hello packet must be checked against the values configured for the receiving interface.  Any mismatch causes processing to stop and the packet to be dropped.</b> In other words, the above fields are really describing the attached network's configuration. <b>However, there is one exception to the above rule: on point-to-point networks and on virtual links, the Network Mask in the received Hello Packet should be ignored.</b></blockquote>
<script>startHide()</script><p>Cisco conforms strictly to the RFC and allows OSPF neighbors to form adjacency over a point-to-point link (Frame Relay subinterface in my test lab) even when the subnet masks don't match. The routers in the lab happily formed the OSPF adjacency even though I've used a /24 mask on one end of the link and a /30 mask on the other end:</p>
<pre class="code">S1#<strong>show ip ospf interface brief</strong><br />Interface    PID   Area    IP Address/Mask    Cost  State Nbrs F/C<br />Se1/0.100    1     1       <span class=" high">10.0.8.1/24</span>        64    P2P   1/1<br />Lo0          1     1       10.0.0.1/32        1     LOOP  0/0<br />S1#<strong>show ip ospf neighbor Serial1/0.100</strong><br />Neighbor ID     Pri   State       Dead Time   Address    Interface<br />10.0.0.11         0   FULL/  -    00:00:38    10.0.8.2   Serial1/0.100<br /><br />C1#<strong>show ip ospf interface brief</strong><br />Interface    PID   Area    IP Address/Mask    Cost  State Nbrs F/C<br />Fa0/0        1     0       10.0.1.1/24        10    BDR   1/1<br />Lo0          1     0       10.0.0.11/32       1     LOOP  0/0<br />Se1/0.100    1     1       <span class=" high">10.0.8.2/30</span>        64    P2P   1/1<br />Se1/0.101    1     1       0.0.0.0/0          64    P2P   1/1<br />C1#<strong>show ip ospf neighbor Serial1/0.100</strong><br />Neighbor ID     Pri   State           Dead Time   Address         Interface<br />10.0.2.2          0   FULL/  -        00:00:37    10.0.8.1        Serial1/0.100</pre><p class="note">This behavior was brought to my attention by Shahid Rox. Thanks.</p>
<script>endHide()</script></div>

