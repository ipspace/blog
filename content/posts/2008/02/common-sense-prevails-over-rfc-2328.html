---
url: /2008/02/common-sense-prevails-over-rfc-2328.html
title: "Common sense prevails over RFC 2328"
date: "2008-02-14T07:44:00.000+01:00"
tags: [ OSPF ]
---

<p>When trying to extract the OSPF route selection rules from <a href="http://rfc.net/rfc2328.html">RFC 2328</a>, I've stumbled across a <a href="http://rfc.net/rfc2328.html#p175">very weird rule (section 16.4.1)</a>: if an ASBR within a non-backbone area advertises an external route (or if the forwarding address is within the non-backbone area), it's preferred over external routes advertised by ASBRs in other areas <em>regardless of its metric</em>. I simply had to test this on Cisco IOS … and found out that Cisco engineers prefer common sense to OSPF RFC.<!--more--></p>
<p>I've built a sample network where two routers (<em>10.0.0.11</em> in area 1, <em>10.0.0.3</em> in the backbone area) advertise the same external routes. The router in area 1 advertises the routes with a higher metric:</p>
<pre class="code">S2#<strong>ospfExternals</strong><br/> <br/>External OSPF routes for OSPF process ID 1<br/> <br/>  Prefix                Cost   Tag            ASBR Forward addr<br/>==================================================================<br/>&gt; 10.1.0.1/32          10 E1     1        10.0.0.3<br/>  10.1.0.1/32        2000 E1     1       10.0.0.11<br/>&gt; 10.1.0.2/32           5 E2     2        10.0.0.3<br/>  10.1.0.2/32         200 E2     2       10.0.0.11</pre><p>You can use the <strong>show ip ospf route</strong> command to verify which ASBR is within the area. An abbreviated printout is included:</p>
<pre class="code">S2#<strong>show ip ospf route</strong><br/> <br/>    Intra-area Router Path List<br/>i 10.0.0.11 [64] via 10.0.2.17, Serial1/2, ASBR, Area 1, SPF 2<br/>i 10.0.0.2 [64] via 10.0.2.13, Serial1/1, ABR, Area 1, SPF 2<br/>i 10.0.0.1 [64] via 10.0.2.5, Serial1/0, ABR, Area 1, SPF 2<br/> <br/>    Inter-area Router Path List<br/>I 10.0.0.3 [128] via 10.0.2.5, Serial1/0, ASBR, Area 1, SPF 2</pre><p>As you can see, 10.0.0.11 is within area 1, whereas 10.0.0.3 is in another area. Still, IOS prefers external routes advertised by 10.0.0.3 due to their lower metric:</p>
<pre class="code">S2#<strong>show ip ospf route</strong><br/>    External Route List<br/>*&gt;  10.1.0.1/32, Ext1, cost 138, tag 1<br/>      via 10.0.2.5, Serial1/0<br/>*&gt;  10.1.0.2/32, Ext2, cost 5, tag 2<br/>      via 10.0.2.5, Serial1/0</pre>

