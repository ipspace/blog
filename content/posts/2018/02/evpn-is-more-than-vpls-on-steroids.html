---
url: /2018/02/evpn-is-more-than-vpls-on-steroids.html
title: "EVPN Is More than VPLS on Steroids"
date: "2018-02-13T10:34:00.000+01:00"
tags: [ EVPN,MPLS VPN ]
---

<p><a href="https://www.linkedin.com/in/tiziano-tofoni-1361759/">Tiziano Tofoni</a> wrote a lengthy comment on my <a href="https://blog.ipspace.net/2018/02/using-evpn-in-very-small-data-center.html">EVPN in small data center fabrics</a> blog post continuing the excellent discussion we started over a beer last October. Today I’ll address the first part:</p>
<blockquote class="cite">I think that EVPN is an excellent standard for those who love Layer 2 (L2) services, we may say that it is an evolution of the implementation of the VPLS service, which addresses some limits in the original standard (RFCs 4761 and 4762). </blockquote>
<p>I might be missing something, but in my opinion there’s no similarity between EVPN and VPLS (apart from the fact that they’re trying to solve the same problem).<!--more--></p>
<p>VPLS is the result of <a href="https://en.wikipedia.org/wiki/Favela#/media/File:1_rocinha_favela_closeup.JPG">organic evolution</a> of <a href="https://tools.ietf.org/html/rfc3251">anything-over-MPLS</a> idea:</p>
<ul class="ListParagraph"><li>The process started with P2P transport of Frame Relay frames and ATM cells over MPLS LSPs;</li>
<li>Ethernet transport was the next logical step, first as P2P circuits, and later as emulated LANs;</li>
<li>BGP control plane was introduced to solve scalability challenges caused by lack of automation.</li>
</ul>
<p class="info">Want to know how to automate VPN service provisioning? I published a <a href="https://github.com/ipspace/MPLS-infrastructure">simple case study on GitHub</a>; for more details join the <a href="http://www.ipspace.net/Ansible_for_Networking_Engineers">Ansible for Networking Engineers</a> webinar or online course. You might also want to explore the <a href="https://blog.ipspace.net/2018/02/automation-win-mplsvpn-service.html">solution Francois Herbet built</a> while attending <a href="http://www.ipspace.net/Building_Network_Automation_Solutions">Building Network Automation Solutions</a> online course.</p>
<p>At no time did VPLS evolve from wire-focused service to endpoint-focused service like MPLS/VPN officially known as <a href="https://tools.ietf.org/html/rfc4364">BGP/MPLS IP VPN</a>.</p>
<p>EVPN is (almost) like MPLS/VPN but using MAC and IP addresses as well as IP prefixes as endpoint identifiers. It also solved a number of other problems including:</p>
<p><strong>Localization of dynamic MAC learning.</strong> MAC addresses are gathered by EVPN PE-routers and transported across the core network in BGP updates. VPLS relied exclusively on dynamic MAC learning. You could use this behavior to block unknown unicast flooding across EVPN backbone.</p>
<p><strong>Combining L2 and L3 forwarding information</strong>. EVPN endpoint information can include MAC and IP addresses, enabling proxy ARP functionality on EVPN PE-routers thus further reducing the flooding across EVPN backbone.</p>
<p><strong>Support for </strong><strong>host </strong><strong>IP addresses and external prefixes</strong>. EVPN can transport IP addresses of attached endpoints or external IP prefixes within the same address family, resulting in an (almost) universal L2+L3 control plane. </p>
<p>The missing bit: IP multicast (well, I’m not missing it ;).</p>
<p><strong>Edge multihoming</strong>. Have you ever tried to implement multihoming at VPLS edge? The STP tricks you had to use on top of mesh of pseudowires got ridiculously complex – someone had to write a whole CiscoPress book dedicated primarily to this topic. </p>
<p>EVPN has built-in support for edge multihoming based on Ethernet Segment Identifiers (ESI). Preventing layer-2 forwarding loops is still tricky, but at least it’s a contained problem solved within the standard, not a heap of kludges.</p>
<p><strong>Edge load balancing</strong>. EVPN standard describes how you can use ESI to enable load balancing across EVPN backbone toward a device that’s connected to two PE-routers (MLAG). Using that functionality, some vendors (starting with Juniper) managed to eliminate the need for MLAG clusters at the network edge – a significant reduction in complexity (note: not everyone agrees with me).</p>
<h4>Want ot know more?</h4><p>I’ll describe the differences between three major network virtualization solutions (VMware NSX, Cisco ACI and EVPN-based transport fabrics) in <a href="http://www.ipspace.net/VMware_NSX,_Cisco_ACI_or_Standard-Based_EVPN">NSX, ACI or EVPN webinar</a> on March 1<span style="vertical-align: super; font-size: 80%;">st</span> 2018, and Dinesh Dutt will go <a href="http://www.ipspace.net/EVPN_Technical_Deep_Dive">deep into how EVPN works</a> on March 6<span style="vertical-align: super; font-size: 80%;">th</span> 2018.</p>
<p>Both webinars (including live sessions) are part of <a href="https://www.ipspace.net/Subscription">standard ipSpace.net subscription</a>.</p>

