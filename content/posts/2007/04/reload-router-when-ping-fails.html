---
url: /2007/04/reload-router-when-ping-fails.html
title: "Reload a router when ping fails"
date: "2007-04-05T10:55:00.000+02:00"
tags: [ network management,You've asked for it,EEM ]
---

One of my readers has <a href="https://blog.ipspace.net/2007/01/youve-asked-for-it-series.html">asked an interesting question</a>: can you reload a router when pinging a specific IP address from it fails? While there are other ways of dealing with stuck interfaces or routing processes, sometimes such a drastic measure is the only workaround, so here's how you do it:<ul><li>Configure an IP SLA measurement (you'll find the necessary commands in the <em>Not-so-Very-Static Routes</em> section of my <a href="http://www.nil.com/ipcorner">IP Corner</a> article <a href="http://www.nil.com/ipcorner/SmallSiteMultiHoming/">Small Site Multihoming</a>). You might want to use the <strong>after</strong> parameter in the <a href="http://www.cisco.com/univercd/cc/td/doc/product/software/ios124/124tcr/tsla_r/sla_02ht.htm#wp1046915"><strong>ip sla schedule</strong></a> command to ensure the router does not get reloaded immediately after the startup due to IP routing table not being populated.</li>
<li>Configure a tracked object based on the IP SLA measurement with the <strong>track <em>object-id</em> rtr <em>sla-id</em> reachability</strong> command</li>
<li>Configure an EEM applet that will reload the router if the tracked object enters the down state</li>
</ul>
Use configuration similar to the one below for the EEM applet:<pre class="code">event manager applet PingHasFailed<br/> event track 100 state down<br/> action 1.0 syslog msg "Ping has failed, reloading the router"<br/> action 2.0 reload</pre><strong>Note:</strong> this article is part of <a href="https://blog.ipspace.net/2007/01/youve-asked-for-it-series.html">You've asked for it</a> <a href="https://blog.ipspace.net/search/label/You%27ve%20asked%20for%20it">series</a>.

