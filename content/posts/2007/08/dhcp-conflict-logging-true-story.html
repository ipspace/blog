---
url: /2007/08/dhcp-conflict-logging-true-story/
title: "DHCP conflict logging: the true story"
date: "2007-08-30T07:09:00.000+02:00"
tags: [ DHCP ]
---

<p>The on-line configuration help for the <strong>ip dhcp conflict logging</strong> configuration command (<em>logging: Record address conflicts in a log file</em>) is one of the more misleading texts I've found in Cisco IOS (and the <a href="http://www.cisco.com/univercd/cc/td/doc/product/software/ios124/124cr/hiad_r/adr_i1h.htm#wp1173972">CCO documentation</a> is not much better). Here's how it actually works ...<!--more--></p>
<p>If you have configured <strong>ip dhcp ping</strong> parameters (highly recommended), the router will ping the IP address it intends to allocate to a client before replying to the DHCP request. If the router receives <em>ICMP Echo Reply</em> message (response to ping), the address is obviously in use. If the DHCP conflict logging is enabled (default), the router will log the conflict with a <em>syslog</em> message (not in a separate log file) and put the address on the list of conflicts. The addresses on that list (displayed with <strong>show ip dhcp conflict</strong>) are not used in the future (similar to the addresses configured with the <strong>ip dhcp excluded-addresses</strong> command). To reuse a conflicting address, the network operator has to remove it from the list with the <strong>clear ip dhcp conflict <em>address</em></strong> (or <em>*</em> for all addresses) command.</p>
<p>The DHCP conflict logging makes sense if the router uses persistent DHCP bindings (called <em>DHCP database agents</em> in Cisco IOS), otherwise any addresses allocated prior to a router reload would be reported as conflicts after the bindings are lost. If you don't use DHCP agents, it's thus best to turn off conflict logging with the <strong>no ip dhcp conflict logging</strong> configuration command. Even without conflict logging, there's no DHCP functionality loss and no chance of duplicate address allocation, as the router would still check whether an IP address is active before allocating it (and later on, it would be willing to re-check the conflicting IP address).</p>
<p>If you don't use DHCP database agents and you don't disable conflict logging (default setup), you'll have to clear the conflicts manually after a reload and you might potentially exhaust the DHCP pool because of a large number of blocked conflicting addresses.</p>

