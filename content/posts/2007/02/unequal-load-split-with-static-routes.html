---
url: /2007/02/unequal-load-split-with-static-routes.html
title: "Unequal load split with static routes"
date: "2007-02-12T13:07:00.000+01:00"
tags: [ You've asked for it,IP routing,load balancing ]
---

<p>Unequal load-sharing with static routes is almost impossible as there is no configuration command to assign non-default traffic share count to a static route. For example, if you configure two default routes, one pointing to a low-speed interface and another one pointing to a high-speed interface, there is no mechanism to force majority of the traffic onto the high-speed link (IOS ignores interface bandwidth when calculating load sharing ratios).</p>
<p>You can, howerer, use a workaround: if you configure multiple routes for the same prefix pointing to the same interface, that interface will attract proportionally more outbound traffic.</p>
<!--more--><p>For example, let's assume you have two point-to-point serial subinterfaces, one three times as fast as the other:</p>
<pre class="code">interface Serial0/0/0.100 point-to-point<br/> bandwidth 1000<br/> ip address 172.16.1.1 255.255.255.252<br/>!<br/>interface Serial0/0/0.200 point-to-point<br/> ip address 172.16.1.5 255.255.255.252<br/> bandwidth 3000<br/></pre><p>To shift more traffic onto Serial0/0/0.200, you can create two default routes pointing to the second interface, one pointing to the interface itself, the other one to the next-hop router:</p>
<pre class="code">ip route 0.0.0.0 0.0.0.0 Serial0/0/0.100<br/>ip route 0.0.0.0 0.0.0.0 Serial0/0/0.200<br/>ip route 0.0.0.0 0.0.0.0 172.16.1.6<br/></pre><p>This setup will give you a 1:2 sharing ratio. To shift even more traffic to the higher-speed interface, one has to get more creative</p>
<ul><li>Create a bogus host route for a bogus next-hop pointing to the actual next-hop router (and make sure you don't advertise the bogus route into your routing protocols).</li>
<li>Configure yet another static route pointing to the bogus next-hop. Due to recursive lookup done by Cisco IOS, the bogus next-hop will be resolved into the actual next-hop IP address.</li>
</ul>
<p>In our example, you could use:</p>
<pre class="code">ip route 10.255.255.1 255.255.255.255 172.16.1.6<br/>ip route 0.0.0.0 0.0.0.0 10.255.255.1</pre><p>The results are as expected: the traffic split is the desired 1:3 ratio</p>
<pre class="code">a1#<b>show ip route 0.0.0.0 0.0.0.0</b><br/>Routing entry for 0.0.0.0 0.0.0.0, supernet<br/>  Known via "static", distance 1, metric 0 (connected), candidate default path<br/>  Routing Descriptor Blocks:<br/>    172.16.1.6<br/>      Route metric is 0, traffic share count is 1<br/>    10.255.255.1<br/>      Route metric is 0, traffic share count is 1<br/>  * directly connected, via Serial0/0/0.100<br/>      Route metric is 0, traffic share count is 1<br/>    directly connected, via Serial0/0/0.200<br/>      Route metric is 0, traffic share count is 1<br/><br/>a1#<b>show ip cef 0.0.0.0 0.0.0.0 internal</b><br/>0.0.0.0/0, version 43, epoch 0, attached, per-destination sharing<br/>0 packets, 0 bytes<br/>  via 172.16.1.6, 0 dependencies, recursive<br/>    traffic share 1<br/>    valid adjacency<br/>  via 10.255.255.1, 0 dependencies, recursive<br/>    traffic share 1<br/>    valid adjacency<br/>  via Serial0/0/0.100, 0 dependencies<br/>    traffic share 1<br/>    valid adjacency<br/>  via Serial0/0/0.200, 0 dependencies<br/>    traffic share 1<br/>    valid adjacency<br/><br/>  0 packets, 0 bytes switched through the prefix<br/>  tmstats: external 0 packets, 0 bytes<br/>           internal 0 packets, 0 bytes<br/>  Load distribution: 0 1 2 3 0 1 2 3 0 1 2 3 0 1 2 3 (refcount 1)<br/><br/>  Hash  OK  Interface                 Address         Packets<br/>  1     Y   Serial0/0/0.200           point2point           0<br/>  2     Y   Serial0/0/0.200           point2point           0<br/>  3     Y   Serial0/0/0.100           point2point           0<br/>  4     Y   Serial0/0/0.200           point2point           0<br/>  5     Y   Serial0/0/0.200           point2point           0<br/>  6     Y   Serial0/0/0.200           point2point           0<br/>  7     Y   Serial0/0/0.100           point2point           0<br/>  8     Y   Serial0/0/0.200           point2point           0<br/>  9     Y   Serial0/0/0.200           point2point           0<br/>  10    Y   Serial0/0/0.200           point2point           0<br/>  11    Y   Serial0/0/0.100           point2point           0<br/>  12    Y   Serial0/0/0.200           point2point           0<br/>  13    Y   Serial0/0/0.200           point2point           0<br/>  14    Y   Serial0/0/0.200           point2point           0<br/>  15    Y   Serial0/0/0.100           point2point           0<br/>  16    Y   Serial0/0/0.200           point2point           0</pre><br/><strong>Note:</strong> this article is part of <a href="https://blog.ipspace.net/2007/01/youve-asked-for-it-series.html">You've asked for it</a> <a href="https://blog.ipspace.net/search/label/You%27ve%20asked%20for%20it">series</a>.

