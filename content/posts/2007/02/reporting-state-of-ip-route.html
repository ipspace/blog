---
url: /2007/02/reporting-state-of-ip-route/
title: "Reporting a state of an IP route"
date: "2007-02-09T09:14:00.000+01:00"
tags: [ network management,logging,EEM ]
---

Have you ever wanted to be notified when your router loses a specific route (for example, the default route toward the Internet)? In IOS release 12.4T you can do it with a combination of <a href="http://www.cisco.com/en/US/products/ps6566/products_feature_guide09186a008063c9bf.html#wp1047054">Enhanced Object Tracking</a> and <a href="http://www.cisco.com/en/US/products/ps6441/products_feature_guide09186a00804aae8c.html">Embedded Event Manager 2.2</a>.<!--more-->As the first step, you configure a <strong>track</strong> object that will monitor the state of an IP route with the <strong>track ip route</strong> command.<pre class="code">track 100 ip route 0.0.0.0 0.0.0.0 reachability</pre>After the <strong>track</strong> object has been created, you can monitor its state with an EEM applet (in the configuration example it only generates a <em>syslog</em> message, but you could also send an email to the network administrator).<pre class="code">event manager applet TrackRoute_0.0.0.0<br/> event track 100 state any<br/> action 1.0 syslog msg "route is $_track_state"</pre>And now a test run ...<br/><blockquote class="code">a1#<strong>conf t</strong><br/>Enter configuration commands, one per line. End with CNTL/Z.<br/>a1(config)#<strong>ip route 0.0.0.0 0.0.0.0 loopback 0</strong><br/>a1(config)#<strong>^Z</strong><br/>01:08:47: %SYS-5-CONFIG_I: Configured from console by console<br/>01:08:51: %HA_EM-6-LOG: TrackRoute_0.0.0.0: route is up<br/>a1#<strong>conf t</strong><br/>Enter configuration commands, one per line. End with CNTL/Z.<br/>a1(config)#<strong>interface loopback 0</strong><br/>a1(config-if)#<strong>shutdown</strong><br/>01:09:10: %SYS-5-CONFIG_I: Configured from console by console<br/>01:09:11: %LINK-5-CHANGED: Interface Loopback0, changed state to administratively down<br/>01:09:21: %HA_EM-6-LOG: TrackRoute_0.0.0.0: route is down</blockquote>
As you can see from the example, there is a significant delay before the track object responds to a route change. You can adjust this delay with the <strong>track timer ip route <em>seconds</em></strong> global configuration command (default is 15 seconds).

