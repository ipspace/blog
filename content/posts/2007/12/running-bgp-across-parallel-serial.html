---
url: /2007/12/running-bgp-across-parallel-serial.html
title: "Running BGP across parallel serial links"
date: "2007-12-13T07:26:00.000+01:00"
tags: [ BGP,load balancing ]
---

<a href="http://www.nil.com/ipcorner"><img src="http://www.nil.com/C1256F0A00429755/free_tips_IP_Corner.gif" style="float: right; margin: 2px 0px 6px 3px; border-width: 0px;"/></a>Whenever I'm describing the idea of running BGP across parallel serial links with duplicate IP addresses (like I did in the November <a href="http://www.nil.com/ipcorner">IP Corner</a> article, <a href="http://www.nil.com/ipcorner/LoadBalancingBGP/"><em>Load Balancing in BGP Networks</em></a>, section <em>External BGP Load Balancing</em>), there's always someone asking “does it really work?” … so I'm enclosing a tested working configuration.<!--more--><table class="codeTable"><tr><th>AS 11</th><th>AS 12</th></tr><tr><td><blockquote class="code">interface Serial1/1<br/> ip address 10.0.1.9 255.255.255.252<br/> encapsulation ppp<br/>!<br/>interface Serial1/2<br/> ip address 10.0.1.9 255.255.255.252<br/> encapsulation ppp<br/>!<br/>router bgp 11<br/> bgp log-neighbor-changes<br/> neighbor 10.0.1.10 remote-as 12</blockquote>
</td><td><blockquote class="code">interface Serial1/1<br/> ip address 10.0.1.10 255.255.255.252<br/> encapsulation ppp<br/>!<br/>interface Serial1/2<br/> ip address 10.0.1.10 255.255.255.252<br/> encapsulation ppp<br/>!<br/>router bgp 12<br/> bgp log-neighbor-changes<br/> network 172.16.0.0<br/> neighbor 10.0.1.9 remote-as 11<br/>!<br/>ip route 172.16.0.0 255.255.0.0 Null0</blockquote>
</td></tr></table>Here are a few printouts. First the BGP neighbors …<pre class="code">AS11#<strong>show ip bgp summary ¦ begin Neighbor</strong><br/>Neighbor   V  AS MsgRcvd MsgSent TblVer  InQ OutQ Up/Down  State/PfxRcd<br/>10.0.1.10  4  12      13      12      2    0    0 00:09:02        1</pre>… then the BGP routing table …<pre class="code">R2#<strong>show ip bgp | begin Network</strong><br/>   Network     Next Hop    Metric LocPrf Weight Path<br/>*&gt; 172.16.0.0  10.0.1.10        0             0 12 i</pre>… and finally the <a href="https://blog.ipspace.net/2006/10/cef-load-sharing-details.html">internal details of the CEF entry</a> (that's the only way to actually verify that the load balancing is taking place):<pre class="code">AS11#<strong>show ip cef 172.16.0.0 internal</strong><br/>172.16.0.0/16, version 35, epoch 0, per-destination sharing<br/>0 packets, 0 bytes<br/>  tag information from 10.0.1.10/32, shared<br/>    local tag: 17<br/>  via 10.0.1.10, 0 dependencies, recursive<br/>    next hop 10.0.1.10, Serial1/1 via 10.0.1.10/32<br/>    valid adjacency<br/>    tag rewrite with Se1/1, point2point, tags imposed: {}<br/> <br/>  Recursive load sharing using 10.0.1.10/32<br/>  Load distribution: 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 (refcount 2)<br/> <br/>  Hash  OK  Interface                 Address         Packets  Tags imposed<br/>  1     Y   Serial1/1                 point2point           0    none<br/>  2     Y   Serial1/2                 point2point           0    none<br/>  3     Y   Serial1/1                 point2point           0    none<br/>  4     Y   Serial1/2                 point2point           0    none<br/>  5     Y   Serial1/1                 point2point           0    none<br/>  6     Y   Serial1/2                 point2point           0    none<br/>  7     Y   Serial1/1                 point2point           0    none<br/>  8     Y   Serial1/2                 point2point           0    none<br/>  9     Y   Serial1/1                 point2point           0    none<br/>  10    Y   Serial1/2                 point2point           0    none<br/>  11    Y   Serial1/1                 point2point           0    none<br/>  12    Y   Serial1/2                 point2point           0    none<br/>  13    Y   Serial1/1                 point2point           0    none<br/>  14    Y   Serial1/2                 point2point           0    none<br/>  15    Y   Serial1/1                 point2point           0    none<br/>  16    Y   Serial1/2                 point2point           0    none<br/></pre>

