---
url: /2007/06/fix-ios-quiet-mode-for-ios-https-server.html
title: "Fix the IOS quiet mode for the IOS HTTP(S) server"
date: "2007-06-04T07:41:00.000+02:00"
tags: [ security,network management,EEM ]
---

The <a href="http://www.cisco.com/univercd/cc/td/doc/product/software/ios124/124cg/hsec_c/part30/h_login.htm">IOS documentation claims</a> that <a href="/2006/12/cisco-ios-login-enhancements.html">the quiet mode the router enters after a series of login failures</a> blocks all telnet (or ssh) sessions as well as HTTP requests. Unfortunately the latter is wrong; you can execute any HTTP request on the router during the quiet mode.<br/><br/>If you want to block HTTP requests during the quiet mode, you can use EEM applets to change the HTTP server configuration when the quiet mode is started and completed.<br/>First you need to configure a standard numbered IP access list that will be used to block HTTP requests during the quiet mode (the <strong>ip http access-class</strong> command accepts only numbered ACLs), for example:<pre class="code">access-list 95 deny any log</pre>Then you define two EEM applets: one that triggers when the router enters the quiet mode (matching the SEC_LOGIN-1-QUIET_MODE_ON syslog message) and another that runs when the quiet mode is finished (triggered with the SEC_LOGIN-5-QUIET_MODE_OFF). Both applets modify the router configuration, changing the access-list used in <strong>ip http access-class</strong> configuration command.<pre class="code">event manager applet EnterQuietMode<br/> event syslog occurs 1 pattern "SEC_LOGIN-1-QUIET_MODE_ON" period 1<br/> action 1.0 cli command "configure terminal" <br/> action 1.1 cli command "ip http access-class 95" <br/> action 2.0 syslog msg "Entered Quiet mode on HTTP server"<br/>!<br/>event manager applet ExitQuietMode<br/> event syslog occurs 1 pattern "SEC_LOGIN-5-QUIET_MODE_OFF" period 1<br/> action 1.0 cli command "configure terminal"<br/> action 1.1 cli command "ip http access-class 70"<br/> action 2.0 syslog msg "Exiting Quiet mode on HTTP server"</pre><!--more-->A sample logging printout is illustrating the operation of this solution is included below: <blockquote class="code">%SEC_LOGIN-1-QUIET_MODE_ON: Still timeleft for watching failures is 38 secs, [user: a] [Source: 10.0.0.2] [localport: 80] [Reason: Login Authentication Failed - BadPassword] [ACL: sl_def_acl] at 11:35:04 UTC Thu May 3 2007<br/>%HA_EM-6-LOG: EnterQuietMode: Entered Quiet mode on HTTP server<br/>%SYS-5-CONFIG_I: Configured from console by vty0<br/>%SEC-6-IPACCESSLOGNP: list 95 denied 0 0.0.0.0 -&gt; 10.0.0.2, 1 packet<br/>%SEC_LOGIN-5-QUIET_MODE_OFF: Quiet Mode is OFF, because block period timed out at 11:36:34 UTC Thu May 3 2007<br/>%HA_EM-6-LOG: ExitQuietMode: Exiting Quiet mode on HTTP server<br/>%SYS-5-CONFIG_I: Configured from console by vty0</blockquote>
<strong>Note:</strong> the SYS-5-CONFIG_I messages are generated when the EEM applets modify router configuration.<br/>

