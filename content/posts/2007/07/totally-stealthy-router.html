---
url: /2007/07/totally-stealthy-router.html
title: "Totally Stealthy Router"
date: "2007-07-17T07:23:00.000+02:00"
tags: [ security,You've asked for it ]
---

<a href="http://insecure.org/nmap/index.html"><img alt="" border="0" id="BLOGGER_PHOTO_ID_5074762091485532018" src="http://bp0.blogger.com/_K_pkZO5-tTg/Rm0tPCadD3I/AAAAAAAAAFw/hpOh377R87U/s200/nmap_btn_euroboy.gif" style="FLOAT: right; MARGIN: 0px 0px 10px 10px; CURSOR: hand"/></a>In response to the post detailing router response to port scans, one of my readers asked an interesting question: <blockquote style="FONT-STYLE: italic">“I was wondering if there was a way to prevent the router from sending those TCP RST packets administratively prohibited ICMP messages back to scanners for TCP and UDP respectively. I basically want my router to drop all packets period without replying back in any way, shape, form, or fashion.”</blockquote>
Here's how you do it: <ul><li>No TCP RST packets should be sent as responses to port scans. Inbound access list dropping all IP packets achieves that.</li>
<li>Outbound traffic, both from the protected LAN as well as from the router itself (ping, telnet, DNS, NTP ...) should be allowed. Configure <strong>ip inspect</strong> with <strong>router-traffic</strong> option.</li>
<li>Disable generation of ICMP unreachables with the <strong>no ip unreachables</strong> interface configuration command.</li>
</ul>
<!--more-->The relevant parts of router configuration are included below:<pre class="code">ip inspect name Internet tcp router-traffic<br/>ip inspect name Internet udp router-traffic<br/>ip inspect name Internet icmp router-traffic<br/>!<br/>interface FastEthernet0/0<br/> ip address <em>a.b.c.d x.y.z.w</em><br/> ip access-group Internet in<br/><span class="high"> no ip unreachables</span><br/> ip inspect Internet out<br/>!<br/>ip access-list extended Internet<br/> deny ip any any</pre><div class="note"><span>Notes: </span><ul><li>The sample router configuration is taken from a SOHO router doing PAT on the public interface. You might have to adjust the <em>Internet</em> access-list to your needs.</li>
<li>This article is part of <a href="http://ioshints.blogspot.com/2007/01/youve-asked-for-it-series.html">You've asked for it</a> <a href="http://ioshints.blogspot.com/search/label/You%27ve%20asked%20for%20it">series</a>.</li>
</ul>
</div>

