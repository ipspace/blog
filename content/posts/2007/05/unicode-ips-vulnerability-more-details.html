---
url: /2007/05/unicode-ips-vulnerability-more-details/
title: "Unicode IPS vulnerability: more details"
date: "2007-05-16T07:15:00.001+02:00"
tags: [ security,web ]
---

Cisco has released <a href="http://www.cisco.com/en/US/customer/products/products_security_response09186a008083f82e.html">security response</a> acknowledging that the IPS software does not properly handle a rarely used Unicode encoding. Reading the security notice you might be left wondering what's going on. Here's the whole story.<br/><br/>Within an URI (web address), the ASCII characters can be encoded in one of three ways:<ul><li>Unless they are <em><a href="http://www.ietf.org/rfc/rfc2396.txt">reserved</a></em>, they can be included in the URI directly (for example, you can always use the letter <em>a</em> in an URI).</li>
<li>You can always escape a character using its hexadecimal value. Letter <em>a</em> can thus be written as <em>%61</em>.</li>
<li>Unicode character set includes <a href="http://www.unicode.org/charts/PDF/UFF00.pdf">full-width form of ASCII characters</a>, where letter <em>a</em> can be encoded as a two-byte value <em>0xFF61</em> (or <em>%ff%61</em> in an URI)</li>
</ul>
The IPS software (standalone or integrated in Cisco IOS) does not recognize the sequence <em>%ff%61</em> as letter <em>a</em>. It's thus possible to evade some IPS triggers by replacing ASCII characters with their full-width Unicode encoding.<br/><br/>The vulnerability by itself does not open new attack routes, unless you use the IPS as the only means of protection of a vulnerable system (which is a bad practice anyway).

