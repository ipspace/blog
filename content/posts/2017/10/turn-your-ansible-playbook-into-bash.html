---
title: "Turn Your Ansible Playbook into a Bash Command"
date: "2017-10-12T10:38:00.000+02:00"
tags: [ Automation,Ansible ]
---

<p>In <a href="http://blog.ipspace.net/2017/09/collect-ssh-keys-with-ansible.html">one of the previous blog posts</a> I described the playbook I use to collect SSH keys from network devices. As I use it quite often, it became tedious to write <strong>ansible-playbook </strong><strong><em>path-to-playbook </em></strong>every time I wanted to run the collection process.</p>
<p>Ansible playbooks are YAML documents, and YAML documents use # to start comments, so I thought &ldquo;<em>what if I&rsquo;d use </em><em>a YAML comment </em><em>to add </em><a href="https://en.wikipedia.org/wiki/Shebang_(Unix)"><em>shebang</em></a><em> and turn my YAML document into a script</em>&rdquo;</p>
<p>TL&amp;DR: It works. Now for the longer story&hellip;<!--more--></p>
<p>Bash (or any other shell) will try to execute a file that has <em>execute </em>bit set. Use <strong>chmod +x </strong><strong><em>playbook </em></strong>to make the playbook executable.</p>
<p>Text files with <em>execute </em>bit set are assumed to be shell scripts unless the first line in the file starts with <strong>#!</strong> sequence which specifies the absolute path to the script interpreter to use.</p>
<p>You can use <strong>which ansible-playbook </strong>to find path to <strong>ansible-playbook </strong>command on your system and add that as the first line of your playbook:</p>
<pre class="code">#!/usr/local/bin/ansible-playbook</pre><p>It&rsquo;s even better to use <strong>env </strong>command. It&rsquo;s always (I hope) in <strong>/usr/bin</strong> directory and uses PATH variable to find the command you want executed. The first line of your Ansible playbook should therefore be:</p>
<pre class="code">#!/usr/bin/env&nbsp;ansible-playbook</pre><p>Cherry on the cake: add a symbolic link to your playbook into one of the directories in your search path. For example:</p>
<pre class="code">$&nbsp;ln&nbsp;&ndash;s&nbsp;/vagrant/tools/ssh-keys/get-keys.yml&nbsp;~/bin/get-ssh-keys</pre><p>Now you can execute your Ansible playbook like any other Linux command.</p>
<p>Supposedly, you can add environment variables to <strong>env </strong>command line. I tried to do that to change Ansible STDOUT callback to <strong>dense </strong>but it didn&rsquo;t work. A solution to this challenge would be highly appreciated ;)</p>
<p><strong>No idea what I&rsquo;m talking about?</strong><strong> </strong>Check out the <a href="http://www.ipspace.net/Ansible_for_Networking_Engineers">Ansible for Networking Engineers</a> webinar and online course.</p>

