---
date: 2017-01-23T08:24:00.000+01:00
tags:
- design
- firewall
- data center
title: Never Take Two Chronometers to Sea
url: /2017/01/never-take-two-chronometers-to-sea.html
---

<p>One of the quotes I found in the <a href="http://blog.ipspace.net/2017/01/worth-reading-mythical-man-month.html">Mythical Man-Month</a> came from the pre-GPS days: “<em>never go to sea with two chronometers, take one or three</em>”, and it’s amazing the networking industry (and a few others) never got the message.<!--more--></p>
<h4>Wait, What?</h4><p>If you’re not a naval history buff, you probably have no idea what I’m talking about, so here’s the TL&amp;DR version:</p>
<p><strong>What is a chronometer?</strong> The <a href="https://en.wikipedia.org/wiki/Marine_chronometer">mechanic version of Stratum 0 NTP server</a> ;) – a very precise clock.</p>
<p><strong>Why did they need it?</strong> It’s relatively easy to measure latitude while on open seas. It’s <a href="https://en.wikipedia.org/wiki/History_of_longitude">really hard to measure longitude</a>, and the marine chronometers were the best (although expensive) solution.</p>
<p class="more"><a href="https://en.wikipedia.org/wiki/Lunar_distance_(navigation)">Lunar distance navigation</a> is a must-read for true geeks ;)</p>
<p><strong>Why should you take three? </strong>Two things can go wrong with a chronometer: it can fail or it can be imprecise. If you have two chronometers, it’s impossible to figure out which one is imprecise and should be disregarded. You might decide to use one as primary and the other one as backup based on whatever criteria, but then you’re acting as the third party (witness) in this protocol.</p>
<p>If you have three, you take the average time of the two that are closer together.</p>
<p><strong>Long story short</strong>: it’s impossible to get a reliable high-availability solution with two components (or even number of components).</p>
<h4>Why is this relevant?</h4><p>Have you ever deployed redundant firewalls or load balancers? How many nodes are in a typical cluster? Got my point?</p>
<p>How about data center switches implementing MLAG? Or stackable switches like HP IRF or Juniper Virtual Chassis that support at most 4 or 10 nodes (depending on the model)?</p>
<p>There’s a good reason the server clustering solutions with two nodes use a disk as a witness. Networking industry obviously never got the memo, the obvious exceptions being VMware NSX controller (because it was designed by people who actually understood voting protocols) and Cisco ACI controller.</p>
<h4>Meh, you’re just spreading FUD</h4><p>Sure. I’ve <a href="http://www.ipspace.net/ExpertExpress">seen enough real-life failures</a> to <a href="http://blog.ipspace.net/2016/11/reliability-of-clustered-solutions.html">believe in simpler solutions</a>, but of course you shouldn’t trust anything you read in a blog post. For a long list of split-brain failures from production environments, read <a href="http://queue.acm.org/detail.cfm?id=2655736">this ACM queue article</a>. Enjoy!</p>

