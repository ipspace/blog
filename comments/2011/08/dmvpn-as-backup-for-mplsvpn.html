<div class="comments post" id="comments">
  <h4>7 comments:</h4>
  <div class="comments-content">
    <div class="comment-thread">
        <ol>
      <div>
        <li class="comment" id="665216912855236341">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Sam Crooks</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c665216912855236341" href="#665216912855236341">25 August 2011 16:48</a>
              </span>
            </div>
            <div class="comment-content">We use this exact scenario, but with eBGP for the routing protocol as you describe at the end.  It works great except a few caveats:<br /><br />1) we have found that we must use some sort of marking scheme (community in our case) on the hub side to ensure that remote site routes learned over the DMVPN path are not advertised to the MPLS VPN service from the hub<br />2) a local pref/as path prepend scheme is needed to ensure MPLS VPN path is used over DMVPN<br />3) a community-based scheme to set local-preference at the hub based on a community attached to a route advertised from the remote site can be very useful when in a restrictive change environment, as inbound and outbound paths are controlled from the remote site only.<br /><br /> 8-)<br /><br />We have had some concerns with running out of private AS numbers, as we use a similar scheme for customer connectivity on our extranet, so we are considering a model where we use iBGP and set the next hop with a route-map to make iBGP behave more like eBGP and to avoid the need to run an IGP to the remote sites over DMVPN for NLRI information.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="2453241661905283507">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Jon Harald BÃ¸vre</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2453241661905283507" href="#2453241661905283507">25 August 2011 18:56</a>
              </span>
            </div>
            <div class="comment-content">Almost exactly as our configurations involving DMVPN.<br />Running eBGP, let remote side decide return path using local-preference outbound and signaling MED inbound (seen from spoke)<br />Always AS65000. as-override not configured on Hub, as spokes will get default route from hub anyway.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="4705965314440788512">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">idl3mind</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c4705965314440788512" href="#4705965314440788512">05 November 2011 00:23</a>
              </span>
            </div>
            <div class="comment-content">I used to work at a large law firm. We used OSPF for our internal routing and BGP for MPLS VPN. The edge routers used redistribution of OSPF into BGP. Worked well for us.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="3711124927522895479">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c3711124927522895479" href="#3711124927522895479">05 November 2011 09:00</a>
              </span>
            </div>
            <div class="comment-content">It&#39;s manageable if MPLS/VPN OSPF routes appear as inter-area routes. Use multiple areas over DMVPN and increase cost of DMVPN tunnels.<br /><br />The problem becomes harder if the SP manages the CE-router and sends you MPLS/VPN routes as E2 OSPF routes.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="8324475024431356865">
          <!--
          <div class="avatar-image-container">
            <img src="https://lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/00575020907507158220" rel="nofollow">Steve</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8324475024431356865" href="#8324475024431356865">04 July 2019 04:32</a>
              </span>
            </div>
            <div class="comment-content">Hi Sam,<br /><br />I&#39;m using your comment 1 for similar structure. On the hub I&#39;m setting community the routes I get from dmvpn spokes and with route map out to mpls peering I&#39;m denying routes matching this community. It&#39;s not working though? Am I doing it wrong way?</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="4357375171305554043">
          <!--
          <div class="avatar-image-container">
            <img src="https://lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/00575020907507158220" rel="nofollow">Steve</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c4357375171305554043" href="#4357375171305554043">04 July 2019 12:19</a>
              </span>
            </div>
            <div class="comment-content">Hi Sam, I solved this problem, but I have another problem now. Dmvpn as a backup for mpls. Ebgp for mpls and ibgp for dmvpn. I used local-as feature for ibgp. But how can I redistribute ibgp learned(local-as) routes to eigrp? I can redistribute ebgp learned (original bgp as in hub) routes to eigrp for the DC devices reach to spokes via mpls. What about via dmvpn?</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="73058814675657410">
          <!--
          <div class="avatar-image-container">
            <img src="https://lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/00575020907507158220" rel="nofollow">Steve</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c73058814675657410" href="#73058814675657410">05 July 2019 07:13</a>
              </span>
            </div>
            <div class="comment-content">Hi Sam,<br /><br />I figured it out, It&#39;s about enabling ibgp redist into igp. It&#39;s disabled by default.</div>
          </div>
        </li>
      </div>
  </ol>

    </div>
  </div>
</div>
