<div class="comments post" id="comments">
  <h4>22 comments:</h4>
  <div class="comments-content">
    <div class="comment-thread">
        <ol>
      <div>
        <li class="comment" id="3824442016251120063">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Russell Heilling</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c3824442016251120063" href="#3824442016251120063">24 August 2011 10:38</a>
              </span>
            </div>
            <div class="comment-content">Another reason why EBGP may be seen inside an enterprise network would the use of a carrier provided MPLS L3VPN, as only EBGP is supported when BGP is used at the PE-CE interface.  Support for IBGP is in the works, but currently still at draft stage: http://tools.ietf.org/html/draft-ietf-l3vpn-ibgp-08</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="4339184077255577751">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Xavier</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c4339184077255577751" href="#4339184077255577751">24 August 2011 10:45</a>
              </span>
            </div>
            <div class="comment-content">You might use ibgp with confederations, which would feel more the right way to do it, rather than doing ebgp with multiple AS.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="3909858477373235137">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Peter John Hill</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c3909858477373235137" href="#3909858477373235137">24 August 2011 12:24</a>
              </span>
            </div>
            <div class="comment-content">After a few months, it might not be as surprising as it is now for the reader. I&#39;d much rather use eBGP to craft route policy than any IGP. IGP&#39;s are great for fast convergence and finding the shortest path, but there is a reason we don&#39;t use it on the Internet.<br /><br />There are many ways to route a large global network with multiple security domains and different teams of network engineers working independently. I can&#39;t imagine Google or Microsoft not using eBGP internally. It provides such a very nice clean delineation between different parts of the network. I have do direct knowledge of the MSFT network, so I&#39;ll use them as an example, I hope that their Bing and XBox Live and MSDN sites are managed somewhat independently, after all they are all likely pretty big networks with different security requirements and perhaps different protocol requirements. XBox, for example, might want to leverage multicast, whereas Bing might want to optimize for protocol simplicity. When different parts of the network have different business requirements, IMHO, it makes sense to isolate them with eBGP.<br /><br />Confederations are great whenever one group of engineers wants to divide up their own network into more manageable chunks, but with my example above, do confederations still seem to be the most logical solution? I think ASN scale more with the number of network engineers than routers. Just a SWAG.<br /><br />Cheers!</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="630406763240315939">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">laf</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c630406763240315939" href="#630406763240315939">24 August 2011 14:07</a>
              </span>
            </div>
            <div class="comment-content">Hi,<br /><br />Can you update your website so we can share these articles on Twitter or even facebook?</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="1670989521130732027">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c1670989521130732027" href="#1670989521130732027">24 August 2011 15:12</a>
              </span>
            </div>
            <div class="comment-content">How about clicking the &quot;facebook&quot; or &quot;twitter&quot; button just above my bio?</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="5435903733339741251">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">John Dozier</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5435903733339741251" href="#5435903733339741251">24 August 2011 15:20</a>
              </span>
            </div>
            <div class="comment-content">It&#39;s also important to consider whether IBGP or EBGP will integrate with other services (like MPLS/VPLS). Some companies I know use EIGRP in combination with VPLS. They are currently considering moving to EBGP though.<br /><br />Great article - keep up the good work Ivan!<br /><br />John</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="4217785114872624259">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Will</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c4217785114872624259" href="#4217785114872624259">25 August 2011 00:11</a>
              </span>
            </div>
            <div class="comment-content">Ivan,<br /><br />Great post.  In fact it was absolutely fabulous.<br /><br />Would love to see a diagram of what you&#39;re talking about to be sure I fully understand (I dont ...quite , right now).</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="9111548728532167396">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">mihalachioaie</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c9111548728532167396" href="#9111548728532167396">26 August 2011 19:05</a>
              </span>
            </div>
            <div class="comment-content">Ivan,<br />can you please clarify your stament &quot;If you want to scale your network or make sure the access network flaps donâ€™t affect the core, IBGP is the tool to use.&quot; ? Is eBGP not as scalable or stable? <br />Besides limited number of private ASNs needed for a large enterprise network are there any other disadvantages of using eBGP? <br />Thanks George</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="3215036864769025600">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c3215036864769025600" href="#3215036864769025600">26 August 2011 19:19</a>
              </span>
            </div>
            <div class="comment-content">I probably should have said &quot;If you _only_ want to scale your network ... use IBGP&quot;. Reworded. Does it make more sense now?<br /><br />EBGP is absolutely stable and scalable (even more so than IBGP), but is slower to converge.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="9000213884500903675">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">plapukhov</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c9000213884500903675" href="#9000213884500903675">27 August 2011 07:42</a>
              </span>
            </div>
            <div class="comment-content">I believe that using modifier &quot;absolutely&quot; is not entirely accurate :)  eBGP is /relatively/ scalable, but alas still the only deployed inter-AS routing protocol. Stability at large-scale deployments could be questioned, especially if it&#39;s not explicitly defined - e.g. Internet routing tables are never entirely stable and hence global routing using BGP never converges. Scalability is also tricky, and this problem has been intensely discussed for the last 6-7 years at least. While I&#39;m 100% sure you are perfectly familiar with both of these facts, I still wanted to point out that BGP has some well-known drawback and could not serve as a &quot;bulletproof&quot; solution. There are many common issues associated with BGP deployments that are not very well documented, for some reason :)</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="7361032570402519509">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">plapukhov</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c7361032570402519509" href="#7361032570402519509">27 August 2011 07:46</a>
              </span>
            </div>
            <div class="comment-content">Peter, it is interested that you selected MSFT network as your example :) I&#39;m not sure if I can talk about it openly, but the design follows many &quot;well-known&quot; templates with some quirks, providing some level of isolation, as you mentioned. Management is another tricky issue, and I believe it is the major scaling factor for large network - probably even more important than platform and protocol limitations. It is interesting that on the networks of that scale, implementation and operations play much more significant role than architectures, in my opinion. After all, designing an architecture for a large network is not that hard. Implementing, operating and maintaing it in good posture is much more challenging problem :)</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="5001677167857165003">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5001677167857165003" href="#5001677167857165003">27 August 2011 11:54</a>
              </span>
            </div>
            <div class="comment-content">Would you be happy with &quot;EBGP is like democracy&quot; - not perfect, but still the best option available?  :-E</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="4345817134069475405">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Yap Chin Hoong</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c4345817134069475405" href="#4345817134069475405">29 August 2011 05:29</a>
              </span>
            </div>
            <div class="comment-content">Hi all, I would like to take this opportunity to seek some info on a scenario I discovered recently.<br /><br />I have discovered that an IBGP route is not being removed from the IP RIB and BGP table when the IBGP neighbor address (which is also the BGP Next Hop) is within the range of an IBGP-learnt supernet route.<br />This is discovered when a PBR with the &quot;verify-reachability&quot; option is not working as intended upon link failures to the next-hop IBGP neighbor. Indeed, the &quot;recurvise&quot; option for PBR is the best option, but apparently it is a C3750 switch running 12.2SE and the &quot;recurvise&quot; option is not available. :)<br /><br />This is documented as Scenario #3 in the following blog post.<br />http://www.itcertnotes.com/2011/08/observation-upon-ibgp-and-ebgp-route.html<br /><br />Appreciate someone can share some info on whether this behavior is described somewhere in the BGP RFCs, and whether this is Cisco-specific. Thanks. :-)</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="2747203990371382670">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2747203990371382670" href="#2747203990371382670">29 August 2011 07:17</a>
              </span>
            </div>
            <div class="comment-content">It&#39;s a FAD (functions-as-designed)  8-)<br /><br />If the BGP next hop is reachable (even though it&#39;s reachable through a BGP route), the BGP route is considered valid. You might want to check the fast fallover and BGP next hop checking features available in Cisco IOS.<br /><br />http://www.nil.si/ipcorner/DesigningBGPNetworks/<br />http://www.cisco.com/en/US/docs/ios/12_4t/ip_route/configuration/guide/brbadv.html#wp1109430</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="5159554092529660769">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Yap Chin Hoong</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5159554092529660769" href="#5159554092529660769">29 August 2011 07:49</a>
              </span>
            </div>
            <div class="comment-content">Thanks Ivan for the fast response! Will look into the links later... :)</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="4395079298477070488">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Pierre-Louis Gingembre</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c4395079298477070488" href="#4395079298477070488">29 August 2011 15:46</a>
              </span>
            </div>
            <div class="comment-content">Hi all,<br /><br />I was wondering if it was possible to use IBGP over an MPLS VPN network to interconnect routers on different sites, in many different countries. I am working on an enterprise network which is migrating with two different SPs for the MPLS VPN (not all sites will be eligible to the two SPs) and I don&#39;t want to rely on an IGP for this kind of infrastructure. I was thinking about using IBGP between my enterprise routers over the two MPLS VPNs, do you think it is possible ? a good idea ? I&#39;m not sure that EBGP would be a good decision because on every site I would have to manage the two SPs on every site multihomed with a common AS number on each site.<br /><br />Your point of view ?<br /><br />Thx<br />/plg</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="7203520733307067206">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c7203520733307067206" href="#7203520733307067206">29 August 2011 18:29</a>
              </span>
            </div>
            <div class="comment-content">I wouldn&#39;t try to make it work with IBGP, unless both service providers offer Carrier&#39;s carrier service. Once I&#39;ve been involved in a similar design using IBGP and it was &quot;somewhat&quot; nasty.<br /><br />You should also consider using the ISPs as pure IP transport and run LISP or DMVPN over their IP infrastructures.<br /><br />BTW, if you&#39;d like to discuss your design with me, this might not be a bad option: http://www.ioshints.info/ExpertExpress</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="6060072041413293267">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Andrew WEISS</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c6060072041413293267" href="#6060072041413293267">07 September 2011 17:05</a>
              </span>
            </div>
            <div class="comment-content">Makes sense though we don&#39;t have all the details.  I assume that this is cBGP or confederated BGP as we used to call it in the old days.  Question though, point to point interface and router loopbacks (or equiv) require an IGP like OSPF or ISIS since BGP requires an IGP to for finding next-hop information or routes are inaccessible.  Statics are possible, but sloppy.  <br /><br />The following configuration is what 95% of all ISPs run and clearly the Chief Network Architect of this global network comes from an ISP.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="5673312734784698612">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Andrew WEISS</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5673312734784698612" href="#5673312734784698612">07 September 2011 17:10</a>
              </span>
            </div>
            <div class="comment-content">If the VPN is purchased from a major carrier like BT, AT&amp;T or Verizon (RFC2547bis MPLS), then yes, BGP or MP-BGP is always used on the carriers network to supply the service.  The IGP that you use is your choice, however, an EGP like BGP is not recommended since it&#39;s &quot;heavy&quot; and unnecessary.  OSPF/EIGRP are the better choices.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="1628945930864156142">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c1628945930864156142" href="#1628945930864156142">08 September 2011 08:08</a>
              </span>
            </div>
            <div class="comment-content">Depends on what they&#39;re doing. If they redistribute BGP into IGP on the PE-router then using IGP might make sense; if they have their own CE-routers and redistribute BGP-into-IGP on the CE-router, all the MPLS/VPN communities are lost and you get external OSPF/EIGRP routes. In that case, EBGP is a way better option. See also:<br /><br />http://blog.ioshints.info/2011/08/dmvpn-as-backup-for-mplsvpn.html</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="754960870998145611">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Jason Guy</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c754960870998145611" href="#754960870998145611">14 August 2014 14:52</a>
              </span>
            </div>
            <div class="comment-content">Hi Ivan, great article.  I work with a lot of large Data Center&#39;s, and these massively scalable DCs (MSDC) are all using BGP for the routing. A question came up recently regarding the use of IBGP or EBGP.  Typically the DC is laid out in a spine leaf architecture, where a row of large routers make up the spine, and the leaf is a top-of-rack (ToR) switch/router.  I tested both IBGP and EBGP in this setup, and found the performance and convergence times to be the same. Both use ECMP to utilize all available links.<br />-IBGP requires the spine router to all be route-reflectors, and a route-map is used on the leaf peering to set the nexthop to the peering address.  This essentially makes IBGP function like EBGP.<br />-To deploy EBGP, the spine is all one AS, and each leaf is a different AS.  So every leaf router is its own AS. I found this to consume a lot of private AS space, and operationally be a lot more complicated.<br />Do you see any other advantages or disadvantages with either design?  I think this is a really cool use of BGP in the MSDC&#39;s, and wanted to share this since it shows how IBGP can be used without an IGP. :)</div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="4170818178992869227">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13457151406311272386" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c4170818178992869227" href="#4170818178992869227">14 August 2014 16:41</a>
              </span>
            </div>
            <div class="comment-content">One of them is easier to understand (EBGP with no additional magic tricks), the other one is easier to provision (because you use the same configuration template everywhere and don&#39;t have to keep track of AS numbers).</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="1101">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Syed Khalid Ali</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c1101" href="#1101">22 March 2022 12:11</a>
              </span>
            </div>
            <div class="comment-content"><p>Hi Ivan,</p>

<p>This question has always puzzled me. From an enterprise customer preservative, should I run iBGP or iBGP+ IGRP (OSPF/ISIS/EIGRP) or IGP while doing mutual redistribution on the edge routers. I was hoping if you could share some thoughtful insight on when to select one over the another?</p>

<p>Thanks,
Khalid</p>
</div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="1115">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow"> Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c1115" href="#1115">28 March 2022 11:25</a>
              </span>
            </div>
            <div class="comment-content">See https: //blog.ipspace.net/2022/03/bgp-igp-enterprise-network.html<br />


</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
  </ol>

    </div>
  </div>
</div>
