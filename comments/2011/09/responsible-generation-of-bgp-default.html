<div class="comments post" id="comments">
  <h4>11 comments:</h4>
  <div class="comments-content">
    <div class="comment-thread">
        <ol>
      <div>
        <li class="comment" id="6959475035920830288">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Brad Hedlund</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c6959475035920830288" href="#6959475035920830288">17 September 2011 16:06</a>
              </span>
            </div>
            <div class="comment-content">Pretty cool Ivan.<br />If your ToR switches are L3, running BGP, you could use a similar technique to gracefully take a Spine switch out of service for maintenance, or other problems.  Just log in to the Spine switch and shutdown the Loopback interface that would trigger BGP to remove route advertisements to the ToR switches.  The ToR move the flows to another Spine switch, at which point you can begin your maintenance.  RIght?<br /><br />Cheers,<br />Brad</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="7760696502870994226">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Anonymous</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c7760696502870994226" href="#7760696502870994226">17 September 2011 17:07</a>
              </span>
            </div>
            <div class="comment-content">How about looking at PfR for this? <br /><br />Thanks,<br />Andy</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="9196000735774123330">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">NotSoAnonymous</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c9196000735774123330" href="#9196000735774123330">17 September 2011 22:03</a>
              </span>
            </div>
            <div class="comment-content">Pick 4 less than /22 prefixes from 4 different continents and then match them in a route map so that they are ANDed.<br /><br />Basically, if all 4 are down then you could responsibly say that your connectivity to Internet has some huge problem and should recall the default route.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="7582239332903882241">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c7582239332903882241" href="#7582239332903882241">18 September 2011 08:51</a>
              </span>
            </div>
            <div class="comment-content">You just proved there&#39;s always a simpler way ;) Thank you! <br /><br />Sometimes I forget to step back and look at the bigger picture.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="945275920764294496">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Chris</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c945275920764294496" href="#945275920764294496">24 September 2011 17:47</a>
              </span>
            </div>
            <div class="comment-content">Last year I worked on a internet service outage problem for a client.  Their load balancers had an &quot;internet health&quot; criteria as a part of providing the load-balanced services.  The check involved pinging well-known internet services that would &quot;never go down&quot;:<br />- altavista<br />- friendster<br />- kozmo.com<br />- pets.com<br /><br />I betcha can guess what went wrong...<br /><br />Relying on specific prefixes that I don&#39;t control seems risky for the same reasons.  They could get deaggregated, and I&#39;d never know until the last one went offline.<br /><br />BGP table size, presence of AS-paths longer than 3 hops, and presence of well-known ASes all seem like safer long-term, zero-maintenance schemes.</div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="1939931286161059427">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/05200309897513789407" rel="nofollow">Howie</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c1939931286161059427" href="#1939931286161059427">18 March 2013 19:11</a>
              </span>
            </div>
            <div class="comment-content">Something more fundamental and well-known like anycasted root nameservers should work well for this though, shouldn&#39;t it? Those are already very nearly hardwired in some software (e.g. local DNS resolvers), and so should rarely change.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="2854597064818182187">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13457151406311272386" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2854597064818182187" href="#2854597064818182187">18 March 2013 19:14</a>
              </span>
            </div>
            <div class="comment-content">That&#39;s what I would usually recommend these days.</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="5319534513695794909">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">ND</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5319534513695794909" href="#5319534513695794909">08 December 2011 12:39</a>
              </span>
            </div>
            <div class="comment-content">I used to put 4/8 and 12/8 as anchors for default and filter everything else. Maybe some ASs for traffic engineering. It works as it should, ATT and L3 must see everybody on Internet being Tier-1s.<br />I don&#39;t like 0/0 walking inside ISP so each iBGP peer had 2 statics 0/0 -&gt; 4/8 and -&gt;12/8. And for even better safety last resort on borders poining to connected ebgp peers.<br />Never failed.<br />If both these T1s go offline you may safely change IT industry for new opportunities.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="6984455808707060711">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Jose Jara</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c6984455808707060711" href="#6984455808707060711">08 November 2012 12:19</a>
              </span>
            </div>
            <div class="comment-content">Hi,<br /><br />regarding this comment:<br /><br />&quot;The catch is in the “match in the IP routing table” part – you cannot use any of the BGP attributes as matching criteria in the route map.&quot;<br /><br />Well, you can use BGP attibutes as long as you match an ip prefix in the routing table. So, Ip prefix in the routing table AND BGP Attribute will work. By the way, running some tests I found out something interesting:<br /><br />- An Ip prefix, 1.0.0.0/8, is generated by two different routers in different AS&#39;es (lets say AS 1 and AS 2) . The eBGP neighbor of those is advertising the default conditionally as long as it receives the 1.0.0.0/8 from AS 1. So, it generates the default just in case it receives it from AS 1 and it works. If we receive it from AS 2, it will not be generated.<br /><br />However, if we create a static route 1.0.0.0/8 pointing to null 0, it generates the default route, even though is local and obviously is not receiving it from AS 1. But, if you add a sentence matching the next hop of the eBGP neighbor (AS 1) in the route-map, it will not generate the default. So, it seems that it checks the routing table first and then, if there is a valid match, it checks the Local BGP Table.<br /><br />Hope this helps,<br />Jose.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="6113924501429301108">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/07931582409793748608" rel="nofollow">Unknown</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c6113924501429301108" href="#6113924501429301108">26 March 2013 21:14</a>
              </span>
            </div>
            <div class="comment-content">So the configuration that I have, where I match a prefix, and its next-hop attribute, is just matching the prefix? <br /><br />It appears to be working on a foundry I have (knock on wood), but I&#39;m definitely headed back to the lab.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="1430052569668290127">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Anonymous</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c1430052569668290127" href="#1430052569668290127">20 December 2017 22:18</a>
              </span>
            </div>
            <div class="comment-content">Track 8.8.8.8, 208.67.222.222 and 208.67.220.220.  Then use &#39;bool&#39; in your sla tracking.</div>
          </div>
        </li>
      </div>
  </ol>

    </div>
  </div>
</div>
