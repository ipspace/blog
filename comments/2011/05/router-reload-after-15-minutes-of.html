<div class="comments post" id="comments">
  <h4>16 comments:</h4>
  <div class="comments-content">
    <div class="comment-thread">
        <ol>
      <div>
        <li class="comment" id="5308617941880475694">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Mkhan9</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5308617941880475694" href="#5308617941880475694">19 May 2011 07:36</a>
              </span>
            </div>
            <div class="comment-content">Awesome!!!!!!!!!</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="506016195784143212">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">JÃ³natan Natti</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c506016195784143212" href="#506016195784143212">19 May 2011 12:26</a>
              </span>
            </div>
            <div class="comment-content">Just a thought. But in my experience it&#39;s usually enough to do a shut/no shut on the cellular interface to get the 3G back up and running.<br />I&#39;ve got this same request a while ago, to reload the router if 3G has been down for a few minutes.<br />(This was based on the customers experience with other 3G solutions, so it seems common that 3G users have to reload their equipment...)<br />But this ended with using EEM/TCL and doing shut/no shut on the cellular interface before reloading the router. (different timers). So if shut/no shut fixed the problem, SLA recovered and the router didn&#39;t have to reload. (And we preserve the logging buffers, and the recovery is quicker, etc.)<br /><br />There&#39;s also another issue regarding 3G.<br />Most 3G equipment can fallback to GPRS/EDGE if the if the 3G signal is to weak or unavailable, and this can happen automatically.<br />However, from what I&#39;ve heard*, the 3G equipment will not try to go back to 3G even if the 3G signal is available, if there is any data flowing. It will wait until there&#39;s no data transfer going on before going from GPRS/EDGE back to 3G.<br />(* I&#39;ve not verified this myself, but I heard this from someone who&#39;s more familiar with 3G equipment than I am.)</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="6489427495640341482">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Marshall</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c6489427495640341482" href="#6489427495640341482">19 May 2011 18:44</a>
              </span>
            </div>
            <div class="comment-content">You can also just reboot the cellular modem using &quot;test cellular 0 2 modem-power-cycle&quot;.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="719334899982625324">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">DavidB</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c719334899982625324" href="#719334899982625324">19 May 2011 22:26</a>
              </span>
            </div>
            <div class="comment-content">A provider we hired to configure our 3G dmvpn oob routers had this problem aswell, he got in contact with TAC and they provided him after some faultsearching with a working IOS. Dont know about public release though...</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="4347076685979699123">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Joe C</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c4347076685979699123" href="#4347076685979699123">05 June 2011 14:04</a>
              </span>
            </div>
            <div class="comment-content">Ivan,  <br /> <br />I have done similar EEM scripts in my role. But I don&#39;t reload the router, I only reload the 3G-HWIC instead and I do it after I miss 8x IP SLA consecutive pings at 1min intervals and default ping timeout of 5s.  <br /> <br />I can share my config if you wish, let me know.  <br /> <br />Cheers,  <br />Joe.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="7147005795986574323">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c7147005795986574323" href="#7147005795986574323">05 June 2011 18:52</a>
              </span>
            </div>
            <div class="comment-content">That would be fantastic. Just paste it as a comment or post a link to somewhere.<br /><br />Thank you! Ivan</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="4622364500840815804">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">andrew</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c4622364500840815804" href="#4622364500840815804">27 June 2011 11:41</a>
              </span>
            </div>
            <div class="comment-content">is it necessary to have this on your conf:<br /><br />snmp-server enable traps ipsla</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="5329889856373993442">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">andrew</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5329889856373993442" href="#5329889856373993442">27 June 2011 11:42</a>
              </span>
            </div>
            <div class="comment-content">Joe,<br />please share</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="6048225873127595270">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Moris</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c6048225873127595270" href="#6048225873127595270">26 October 2011 18:29</a>
              </span>
            </div>
            <div class="comment-content">i would appriciate any help with this one :<br /> <br />i have an ipsla that pings a host .<br />if syslog message &quot;%TRACKING-5-STATE: 222 ip sla 333 reachability Up-&gt;Down&quot; has happened 2 times in 3 minutes, its putting a null route .<br /> <br />what i would like to know is how can i make it that this Null route would be removed only if its been 30 Minutes since the last syslog message &quot;%TRACKING-5-STATE: 222 ip sla 333 reachability Down-&gt;Up&quot; ?<br /><br />the thing is i need to know i can have a reliable backup link with a mechanism to verify it [the 30minutes safe period].<br /> <br />track 222 ip sla 223 reachability<br />ip sla 223<br />icmp-echo x.x.x.x source-ip y.y.y.y<br />threshold 500<br />frequency 5<br />ip sla schedule 223 life forever start-time now<br />ip sla reaction-configuration 223 react timeout threshold-type xOfy 2 5 action-type trapOnly<br />!<br />event manager applet IPSEC_TUNNEL_2_FAIL<br />event syslog pattern &quot;%TRACKING-5-STATE: 222 ip sla 223 reachability Up-&gt;Down&quot;<br />trigger occurs 2 period 180<br />action 1.0 cli command &quot;enable&quot;<br />action 2.0 cli command &quot;config t&quot;<br />action 3.0 cli command &quot;ip route 192.168.255.5 255.255.255.255 Null0 name NULL_WHEN_IPSLA223_FAIL&quot;<br />action 3.1 cli command &quot;exit&quot;<br />action 4.0 syslog msg &quot;IPSEC_VPN_TUNNEL2 TIMEOUT - MOVING TO IPSEC_TUNNEL1&quot;<br /> <br />i was thinking on using watchdog timer but i understand it counts down from the time of a trigger . thats great , but if the sla is flapping and i get two &quot;Down-&gt;Up&quot; - i think it would initiate multiple times the specific eem , no ? if yes - then in case of a continouse flapping ill get into trouble ...<br /> <br />Thank you</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="8971942706018347074">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="http://www.netcorr.com" rel="nofollow">Chr13</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8971942706018347074" href="#8971942706018347074">15 August 2014 23:34</a>
              </span>
            </div>
            <div class="comment-content">Until Joe C shares his complete config with ip sla, I can share you 2 useful eem applets to reload the Cellular module. <br /><br />! 1) Manual reload, using &quot;event manager run reload.3g.module&quot;<br />!    You can use this if you still have access to the router.<br /><br />event manager applet reload.3g.module<br /> event none<br /> action 1.0 cli command &quot;enable&quot;<br /> action 1.1 cli command &quot;configure terminal&quot;<br /> action 1.2 cli command &quot;service internal&quot;<br /> action 1.3 cli command &quot;end&quot;<br /> action 2.0 cli command &quot;test cellular 0 modem-power-cycle&quot;<br /> action 3.1 cli command &quot;configure terminal&quot;<br /> action 3.2 cli command &quot;no service internal&quot;<br /> action 3.3 cli command &quot;end&quot;<br /> action 4.0 syslog msg &quot;Cellular0 module has been rebooted. Reason: unknown Cisco bug.&quot;<br /><br /><br />! 2) Automatic reload (based on a syslog. Usually the hwic throws an error when is faulty).<br />!    You can adapt this to a tracked object and execute it.<br /><br />event manager applet auto.reload.3g.module<br /> event syslog pattern &quot;CISCO800-2-MODEM_REMOVAL_DETECTED: Cellular0 modem is now REMOVED&quot;<br /> action 1.0 cli command &quot;enable&quot;<br /> action 1.1 cli command &quot;configure terminal&quot;<br /> action 1.2 cli command &quot;service internal&quot;<br /> action 1.3 cli command &quot;end&quot;<br /> action 2.0 cli command &quot;test cellular 0 modem-power-cycle&quot;<br /> action 3.1 cli command &quot;configure terminal&quot;<br /> action 3.2 cli command &quot;no service internal&quot;<br /> action 3.3 cli command &quot;end&quot;<br /> action 4.0 syslog msg &quot;Cellular0 module has been rebooted. Reason: unknown Cisco bug.&quot;<br />!<br /><br />All the best,<br />CR<br /></div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="452738589655745246">
          <!--
          <div class="avatar-image-container">
            <img src="https://lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13457151406311272386" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c452738589655745246" href="#452738589655745246">16 August 2014 10:47</a>
              </span>
            </div>
            <div class="comment-content">Thank you!</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="4888317606983313134">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Anonymous</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c4888317606983313134" href="#4888317606983313134">28 January 2015 12:07</a>
              </span>
            </div>
            <div class="comment-content"> Can I ask what version of IOS you are running to be able to configure the event manager applet to &quot;trigger&quot; please.<br /><br />In the command string that starts with event.......my ios 12.4.15......does not have this command......so I can try to use either &quot;event snmp...&quot; or &quot;event syslog...&quot; but neither will give me the option to configure &quot;trigger occurs&quot;....<br /><br /><br />many thanks.<br /><br /></div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="8662962625969579369">
          <!--
          <div class="avatar-image-container">
            <img src="https://lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13457151406311272386" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8662962625969579369" href="#8662962625969579369">28 January 2015 16:59</a>
              </span>
            </div>
            <div class="comment-content">Those options probably work only in IOS 12.4T or even 15.x.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="771968069657711646">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Anonymous</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c771968069657711646" href="#771968069657711646">30 January 2015 09:47</a>
              </span>
            </div>
            <div class="comment-content">Thanks for the reply...........I&#39;ll see if I can upgrade to either of those and see if it works.<br />I&#39;ll let you know how I get on.<br /><br />regards.<br />Dave S.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="1493625768326269622">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Anonymous</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c1493625768326269622" href="#1493625768326269622">30 January 2015 10:39</a>
              </span>
            </div>
            <div class="comment-content">No there&#39;s definitely something else missing, I can use 12.4.24.T8 or even 15.1.4 and I get exactly the same results...??????<br /><br />For example:<br />Router(config)#event manager applet Link_Down_Reload<br />Router(config-applet)#event snmp oid 1.3.6.1.4.1.9.9.42.1.2.9.1.6.10 <br />get-type exact entry-op lt entry-val &quot;2&quot; poll-interval 10 ?<br /><br />  average-factor  Period used for rate based calculations<br />  entry-type      Entry comparison type<br />  exit-comb       Exit combination operator<br />  exit-event      Raise an exit event upon exit<br />  exit-op         Exit operator<br />  exit-time       Time before event monitoring is reenabled<br />  exit-type       Exit comparison type<br />  exit-val        Exit comparison value<br />  maxrun          Maximum runtime of applet<br />  <br /><br />as you can see there is no option for the next part of the command to set the &quot;trigger&quot; vlaues.<br /><br />There is another example in the post that uses syslog.........this also sets a trigger value that I d not get an option for.<br /><br />event manager applet Link_Down_Reload<br />event syslog pattern &quot;%LINK-3-UPDOWN: Interface ATM0, changed state to down&quot; ?<br /><br /> maxrun                 Maximum runtime of applet<br />  occurs                 Number of occurrences before raising event<br />  period                 Occurrence period<br />  priority               Screen messages that have specified priority<br />  severity-critical      Critical conditions, immediate attention needed<br />  severity-debugging     Debugging messages<br />  severity-fatal         System is unusable<br />  severity-major         Major conditions<br />  severity-minor         Minor conditions<br />  severity-normal        Normal event, signifying returning to normal state<br />  severity-notification  Basic notification, informational messages<br />  severity-warning       Warning conditions<br />  <br /><br />again there is no option to set the trigger values.....????<br /><br /><br />Any ideas...????<br /><br />many thanks.<br /><br />Dave S.<br /></div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="3441977608256895807">
          <!--
          <div class="avatar-image-container">
            <img src="https://lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13457151406311272386" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c3441977608256895807" href="#3441977608256895807">30 January 2015 13:43</a>
              </span>
            </div>
            <div class="comment-content">Trigger is a separate EEM command available in 12.4(20)T or later. </div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
  </ol>

    </div>
  </div>
</div>
