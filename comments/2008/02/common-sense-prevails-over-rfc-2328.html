<div class="comments post" id="comments">
  <h4>11 comments:</h4>
  <div class="comments-content">
    <div class="comment-thread">
        <ol>
      <div>
        <li class="comment" id="8172893203798376196">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/00963478939764648991" rel="nofollow">Unknown</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8172893203798376196" href="#8172893203798376196">14 February 2008 14:20</a>
              </span>
            </div>
            <div class="comment-content">I believe the RFC <B>procedure</B> for the want of better word, is a loop prevention mechanism, despite how stupid a network design you would have to have, to fall foul of it. :)</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="1619756433103704556">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13457151406311272386" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c1619756433103704556" href="#1619756433103704556">14 February 2008 15:00</a>
              </span>
            </div>
            <div class="comment-content">Actually I cannot see why this would prevent loops (but any example to the contrary is most welcome :).<BR/><BR/>On the other hand, OSPF already has a few other loop-generating mechanisms, as I've <A HREF="http://www.nil.com/ipcorner/OSPFDistanceVector/" REL="nofollow">documented in my latest IP Corner article</A>.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="8493868648058153730">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13725507544544474766" rel="nofollow">beatbox32</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8493868648058153730" href="#8493868648058153730">14 February 2008 20:18</a>
              </span>
            </div>
            <div class="comment-content">I'm curious as to why this is in the RFC as well. I can't see any obvious purpose.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="2455656721940658242">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Anonymous</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2455656721940658242" href="#2455656721940658242">19 February 2008 10:18</a>
              </span>
            </div>
            <div class="comment-content">Can anyone kindly explain me the topology in which this Cisco-specific OSPF behavior was seen. <BR/><BR/>You may either post the same in the same topic "Common sense prevails over RFC2328" or you can send an email to my jishnub@yahoo.com</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="8785145121757644059">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13457151406311272386" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8785145121757644059" href="#8785145121757644059">20 February 2008 11:36</a>
              </span>
            </div>
            <div class="comment-content">It happens in a very simple topology: let's assume you have ASBR in Area 0, ABR between Area 0 and Area 1 and two routers in Area 1, one of them being ASBR and having very high link cost to the rest of the network.<BR/><BR/>ASBR in Area 0 is thus closer to routers in Area 1 than ASBR in Area 1 and if they both advertise the same external route, the one from Area 0 is used.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="5267231184510347284">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Anonymous</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5267231184510347284" href="#5267231184510347284">27 February 2008 07:25</a>
              </span>
            </div>
            <div class="comment-content">From the topology that you have mentioned, I cant actually make out in what way Cisco is smart in selecting a E-route on basis of cost and not on inter-area/intra-area path. Referring to your topology, it would be prudent for a non-bkbone router (in Area 1) to select the E-route coming from its direct neighbor (or even adjacent neighbor) rather via another router (connected backbone router). Well again, the confusion would arise what would the ABR (connected to backbone ASBR and Area1) do? <BR/>Jishnu</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="963233723105093497">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">chrismarget</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c963233723105093497" href="#963233723105093497">02 February 2011 23:37</a>
              </span>
            </div>
            <div class="comment-content">Yes, I&#39;m three years late to this party.<br /><br />The reason for preferring intra-area external routes is explained in section G.7 of RFC 2178.<br /><br />I thought that I&#39;ve duplicated this behavior on IOS before, but currently cannot.  12.4(25d) with &#39;no compatible rfc1583&#39; in the OSPF configuration stanza.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="1161631786815928635">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/17555664891506980151" rel="nofollow">wizard</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c1161631786815928635" href="#1161631786815928635">23 April 2016 01:04</a>
              </span>
            </div>
            <div class="comment-content">Setting up the topology as shown in Figure 19 of Appendix G.7 of RFC 2178 with IOS 15.4(2)T in 2016 actually causes the loop that Richard Woundy identified/discovered in mid 1990s. The no compatible rfc1583 command has no effect on the AS-external selection criteria, but only on the metric selection for aggregated type 3 LSAs.<br />It seems that the topology as designed in Figure 19 of Appendix G.7 of RFC2178 is currently not supported by IOS.<br />From http://www.cisco.com/c/en/us/support/docs/ip/open-shortest-path-first-ospf/117824-config-ospf-00.html i gather that Cisco Disabled RFC1583Compatibility by default on its NX-OS, and at last actually implemented RFC2178 and RFC2328.</div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="313147022657506949">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13457151406311272386" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c313147022657506949" href="#313147022657506949">23 April 2016 09:25</a>
              </span>
            </div>
            <div class="comment-content">This is why I love to blog ;) ... every now and then someone writes a fantastic comment that sends me down yet another rabbit hole.<br /><br />Thank you!</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="3611645968397267038">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Pavel</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c3611645968397267038" href="#3611645968397267038">01 March 2018 15:32</a>
              </span>
            </div>
            <div class="comment-content">I&#39;ve been reading RFC 2328 sections 16.4 and 16.4.1 for 2 days already and I&#39;m not sure that Cisco implemented RFC 2328 wrong.<br /><br />In the case above we have: <br />a) 2 different ASBRs that are in different areas (area 0 and area 1) <br />b) 2 different ASBRs advertise same external network with different E2 metrics<br /><br />Section 16.4.1 is part of section 16.4 so we might not refer just 16.4.1 alone.<br /><br />When I follow Section 16.4 I consider &quot;Each of the AS-external-LSAs is considered in turn&quot; as RFC says. For each AS-external-LSA I come to 16.4(3) but I skip 16.4.1 here because we do not have &quot;multiple routing table entries for the ASBR&quot;. I think that example in the post doesn&#39;t have multiple routing table entries for the ASBR for each of 2 AS-external-LSA either.<br /><br />So my procedure comes to 16.4(6)(b) where AS-external-LSA with smallest E2 metric wins.<br /><br />Please note that we could get into 16.4.1 from 16.4(6)(c) in case E2 metrics match (that is why Richard Woundy G.7 problem is solved)  <br /><br />Am I reading RFC properly?<br /><br />Can anyone give comments on this?</div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="1144240436786153875">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/17555664891506980151" rel="nofollow">wizard</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c1144240436786153875" href="#1144240436786153875">02 April 2018 09:59</a>
              </span>
            </div>
            <div class="comment-content">There are two ways to get into section 16.4.1 of RFC 2328:<br /><br />1. When you have multiple paths to the same ASBR. This will happen in the 16.4(3) step. In this case, both the metric type and the E2 metric value will be ignored when preferring the intra-area path to the same ASBR over a backbone or inter-area path to the ASBR. Comparing E2 metric values at this stage of the path preference algorithm is pointless. We are not comparing AS-external LSAs from different ASBRs to find the best AS-external LSA (and in turn the best ASBR). We are at this point of the algorithm still trying to find the best path to this AS-external LSA&#39;s ASBR. Even of we go to section 16.4.1 and come back, the LSA&#39;s cost will be compared to other LSA&#39;s costs at step 16.4(6)(b).<br /><br />2. When comparing two paths to the same external prefix via two different ASBRs. This will happen in the 16.4(6)(c) step. In this case, we already know that the E2 metric value is identical for the two AS-external LSAs. This test has happened in step 16.4(6)(b). If the E2 metric values were different, the cheapest of the two AS-external LSAs would have been preferred in step  16.4(6)(b), ending the discussion there, and we would not have reached step  16.4(6)(c). In this case, the intra-area ASBR is preferable to the backbone or inter-area ASBR for the two equal-cost AS-external LSAs.<br /><br />So, as per RFC 2328, E2 metric value is king. The lowest E2 metric value is always preferred. The 16.4.1 section only affects how the path to the ASBR is determined, and which ASBR will be chosen in the case of equal E2 metric values.<br /><br />Cisco IOS implements none of these two cases.</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
  </ol>

    </div>
  </div>
</div>
