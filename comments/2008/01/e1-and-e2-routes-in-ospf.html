<div class="comments post" id="comments">
  <h4>26 comments:</h4>
  <div class="comments-content">
    <div class="comment-thread">
        <ol>
      <div>
        <li class="comment" id="9202407025366810273">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Anonymous</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c9202407025366810273" href="#9202407025366810273">28 July 2008 11:48</a>
              </span>
            </div>
            <div class="comment-content">its a good one.<BR/><BR/>regards<BR/>shivluy</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="1299915927323853267">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Anonymous</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c1299915927323853267" href="#1299915927323853267">11 December 2008 15:58</a>
              </span>
            </div>
            <div class="comment-content">Excelent information.<BR/><BR/>I've been searching for this for hours, but always you just find information about E1, E2 routes and what they mean...as you said...not the whole story..<BR/><BR/>thanks a lot/....</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="2984164504139238098">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Anton Yurchenko</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2984164504139238098" href="#2984164504139238098">31 March 2011 02:05</a>
              </span>
            </div>
            <div class="comment-content">Big big thanks! I had pieces of it written down, but pieces about Cisco specific behavior are excellent finds.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="7763197741507568721">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Otis White</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c7763197741507568721" href="#7763197741507568721">25 October 2011 18:16</a>
              </span>
            </div>
            <div class="comment-content">I have a question about OSPF default originates.<br /><br />I have 4 ABR in once OSPF domain. Three of the ABRs are generating a OSPF default route with a metric of 200 and 1 is using a metric of 1000. The show ip ospf database external 0.0.0.0 shows that the default originate with 200  as an E2 and the default originate with the metric of 1000 as and E2 route.  The ABR with a metric of 1000 is the BDR and the ABR with metrics of 200 are the DRs. The default route for clients of the DRs prefer the BDR default route with a metric of 1000 over the default of the DR with a metric of 200. Any ideas on how to fix this situation?<br /><br /><br />Thanks,</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="3850315929856177882">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c3850315929856177882" href="#3850315929856177882">25 October 2011 18:33</a>
              </span>
            </div>
            <div class="comment-content">DR/BDR doesn&#39;t matter. They just influence how updates are flooded through the network.<br /><br />Make sure all routers originate either E1 or E2 default routes (not a mix).</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="8934768099492466364">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Anonymous</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8934768099492466364" href="#8934768099492466364">28 August 2012 17:41</a>
              </span>
            </div>
            <div class="comment-content">Can someone please tell what the tie breaker is, i have 2 routes in OSPF that are teh same but it prefers the first one when both are recieved<br /><br /><br /><br />192.168.5.0/24  172.17.18.2 (172.17.18.2 Rid) 20  A Oi  tunnel.5 <br />192.168.5.0/24  172.17.19.2 (192.168.5.11 Rid)  20  A Oi  tunnel.200 </div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="1648386866632049318">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/16111534966079333136" rel="nofollow">Unknown</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c1648386866632049318" href="#1648386866632049318">23 October 2012 14:18</a>
              </span>
            </div>
            <div class="comment-content">It is well known (and in every textbook) that in IOS intra-area through the backbone are preferred over intra-area across a nonzero area, cost notwithstanding, but I cannot find any reference for this behaviour in RFC2328. Do you know the reason for this feature (or bug)?<br /><br />One similar case where behaviour is different is identical externals from the same ASBR, which is also an ABR, received across two distinct areas from another ABR in the same areas: these are selected by cost, with possible ECM, at least in 12.4(4)T1. This seems to be consistent with section 16.4.1 of RFC2328.<br /><br />No matter how many times you read RFC2328, there is always one more case that forces you to read it again and fire up GNS3.<br /><br /></div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="2994106737638720014">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/16111534966079333136" rel="nofollow">Unknown</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2994106737638720014" href="#2994106737638720014">06 November 2012 12:22</a>
              </span>
            </div>
            <div class="comment-content">Well, apparently I did misread all those textbooks, and IOS follows RFC. Intra-area routes from two different areas (a corner case not as easy to see as I previously believed) are treated by the ABR exactly as externals, selected by cost with possible ECM.<br /></div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="2560770869440296139">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/07345674420526592526" rel="nofollow">vPackets</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2560770869440296139" href="#2560770869440296139">07 March 2013 13:46</a>
              </span>
            </div>
            <div class="comment-content">Ivan I have a comment here :<br /><br />Inter-area routes are preferred over external routes; see Section 16.2 paragraph (5) of the OSPF RFC.<br /><br />This is 100% true :)<br />In case of redistribution, an O-E2 Route can be preferred over an O route ... :(<br /><br />Quote from :<br />http://www.cisco.com/en/US/tech/tk365/technologies_white_paper09186a0080531fd2.shtml#routepref <br /><br />&quot;The OSPF route selection rule is that intra-area routes are preferred over inter-area routes, which are preferred over external routes. However, this rule should apply to routes learned via the same process. In other words, there is no preference between external routes from one process compared to internal routes of other process.&quot;<br /><br /><br />I don&#39;t want to flood your blogpost but this is the result of the test:<br /><br />O E2    1.1.1.1 [110/20] via 23.0.0.2, 00:00:16, FastEthernet0/1<br /><br />               Type-5 AS External Link States<br /><br />Link ID         ADV Router      Age         Seq#       Checksum Tag<br />1.1.1.1         1.1.1.1         1307        0x80000001 0x009BFC 0<br /><br />R2(config-router)#distance ospf intra-area 109<br /><br />O       1.1.1.1 [109/11] via 12.0.0.1, 00:00:09, FastEthernet0/0<br /><br /><br /><br />Hope you enjoy the sharing !<br /><br />See ya !<br /><br /><br />Nic<br /><br /><br /></div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="8890734508739338846">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/04307048708921860961" rel="nofollow">Vikram Deshmukh</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8890734508739338846" href="#8890734508739338846">11 December 2013 13:45</a>
              </span>
            </div>
            <div class="comment-content">Does only ABR sends default route to neighbor , while we enable default originate ?<br />or it is not specific.</div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="3880752011329668501">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13457151406311272386" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c3880752011329668501" href="#3880752011329668501">11 December 2013 13:50</a>
              </span>
            </div>
            <div class="comment-content">Any router can originate E1 or E2 default route (unless it&#39;s in a stub area). On top of that, ABR would originate default route into stub/NSSA areas.</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="1898029098735675780">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/11523584888419995274" rel="nofollow">wingnut</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c1898029098735675780" href="#1898029098735675780">23 December 2013 16:53</a>
              </span>
            </div>
            <div class="comment-content">I&#39;m trying this out on junipers and cannot explain this<br /><br />Area 0        Area 1 <br /><br />  ---------------R2 ( ABR )  -------------------- <br />R1                                               R4<br />  ---cost 100----R3 ( ABR and ASBR ) ------------<br />                      E1 Redistibuted at R3    <br /><br />Costs not indicated are 1<br /><br />the route from R1 to E1 will always be the highcost direct link<br /><br />I can only conclude that R1 prefers this link as it considers ASBR as in its own area<br />but I cannot find this documented in the RFC<br />do you have any idea ?<br /></div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="5069447470372775034">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/01369430756856742351" rel="nofollow">BETEP</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5069447470372775034" href="#5069447470372775034">27 October 2015 14:29</a>
              </span>
            </div>
            <div class="comment-content">Hi! Article need update. In Cisco IOS Release 15.1(2)S and later releases, RFC 3101 replaces RFC 1587, and RFC 3101 behavior is automatically enabled.<br /></div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="4151025164454155189">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/05508898600714936580" rel="nofollow">Il Conte</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c4151025164454155189" href="#4151025164454155189">19 February 2016 12:40</a>
              </span>
            </div>
            <div class="comment-content">Hi Ivan,<br /><br />When you say &quot; Cisco IOS ignores this rule even after configuring no compatible rfc1683 (Section 16.4.1 of the OSPF RFC)&quot; it should say &quot; Cisco IOS ignores this rule even after configuring no compatible rfc1583 (Section 16.4.1 of the OSPF RFC)&quot;<br /><br />Apart from this, thanks for the post!</div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="8674302475082635095">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13457151406311272386" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8674302475082635095" href="#8674302475082635095">19 February 2016 19:26</a>
              </span>
            </div>
            <div class="comment-content">Fixed. Thank you!</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="6729621539628750279">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/17555664891506980151" rel="nofollow">wizard</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c6729621539628750279" href="#6729621539628750279">11 April 2016 09:17</a>
              </span>
            </div>
            <div class="comment-content">Hello Ivan,<br /><br />i think that N2P=1 routes are preferred over E2 routes, which are preferred over N2P=0 routes. P is the P-bit.<br />This behaviour is actually a bit more compliant with RFC3101, Section 2.5, (6)(e).<br />i believe i have verified this with IOS 15.2(4)M2 in gns3.</div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="5261011057005211683">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/14394946059855604777" rel="nofollow">Unknown</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5261011057005211683" href="#5261011057005211683">20 May 2016 20:34</a>
              </span>
            </div>
            <div class="comment-content">Yes, I did so also.<br /><br />This is the part confirming this:<br /><br />N2 route is preferred over E2 route<br /><br />R4#sh ip ospf database external <br /><br />            OSPF Router with ID (4.4.4.4) (Process ID 1)<br /><br />                Type-5 AS External Link States<br /><br />  LS age: 12<br />  Options: (No TOS-capability, DC, Upward)<br />  LS Type: AS External Link<br />  Link State ID: 100.100.100.0 (External Network Number )<br />  Advertising Router: 4.4.4.4<br />  LS Seq Number: 80000001<br />  Checksum: 0x8871<br />  Length: 36<br />  Network Mask: /24<br />        Metric Type: 2 (Larger than any link state path)<br />        MTID: 0 <br />        Metric: 18 <br />        Forward Address: 192.168.1.1<br />        External Route Tag: 0<br /><br />  LS age: 18<br />  Options: (No TOS-capability, DC, Upward)<br />  LS Type: AS External Link<br />  Link State ID: 100.100.100.0 (External Network Number )<br />  Advertising Router: 5.5.5.5<br />  LS Seq Number: 80000007<br />  Checksum: 0x1348<br />  Length: 36<br />  Network Mask: /24<br />        Metric Type: 2 (Larger than any link state path)<br />        MTID: 0 <br />        Metric: 18 <br />        Forward Address: 0.0.0.0<br />        External Route Tag: 0<br /><br />R4#sh ip ospf database nssa-external <br /><br />            OSPF Router with ID (4.4.4.4) (Process ID 1)<br /><br />                Type-7 AS External Link States (Area 1)<br /><br />  Routing Bit Set on this LSA in topology Base with MTID 0<br />  LS age: 79<br />  Options: (No TOS-capability, Type 7/5 translation, DC, Upward)<br />  LS Type: AS External Link<br />  Link State ID: 100.100.100.0 (External Network Number )<br />  Advertising Router: 1.1.1.1<br />  LS Seq Number: 8000000A<br />  Checksum: 0x3CB6<br />  Length: 36<br />  Network Mask: /24<br />        Metric Type: 2 (Larger than any link state path)<br />        MTID: 0 <br />        Metric: 18 <br />        Forward Address: 192.168.1.1<br />        External Route Tag: 0<br /><br />R4#sh ip ospf border-routers <br /><br />            OSPF Router with ID (4.4.4.4) (Process ID 1)<br /><br /><br />                Base Topology (MTID 0)<br /><br />Internal Router Routing Table<br />Codes: i - Intra-area route, I - Inter-area route<br /><br />i 1.1.1.1 [2] via 192.168.1.1, GigabitEthernet1/0, ASBR, Area 1, SPF 28<br />i 5.5.5.5 [2] via 192.168.47.7, GigabitEthernet3/0, ASBR, Area 0, SPF 7<br />i 2.2.2.2 [2] via 192.168.47.7, GigabitEthernet3/0, ABR/ASBR, Area 0, SPF 7<br />i 2.2.2.2 [2] via 192.168.1.2, GigabitEthernet1/0, ABR/ASBR, Area 1, SPF 28<br />i 3.3.3.3 [2] via 192.168.47.7, GigabitEthernet3/0, ABR/ASBR, Area 0, SPF 7<br />i 3.3.3.3 [2] via 192.168.1.3, GigabitEthernet1/0, ABR/ASBR, Area 1, SPF 28<br /><br />R4#sh ip route 100.100.100.100<br />Routing entry for 100.100.100.0/24<br />  Known via &quot;ospf 1&quot;, distance 110, metric 18, type NSSA extern 2, forward metric 2<br />  Last update from 192.168.1.1 on GigabitEthernet1/0, 00:00:50 ago<br />  Routing Descriptor Blocks:<br />  * 192.168.1.1, from 1.1.1.1, 00:00:50 ago, via GigabitEthernet1/0<br />      Route metric is 18, traffic share count is 1<br /></div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="4835047620095833761">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/14394946059855604777" rel="nofollow">Unknown</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c4835047620095833761" href="#4835047620095833761">20 May 2016 20:35</a>
              </span>
            </div>
            <div class="comment-content">Yes, I agree. I have confirmed this hereunder on the same IOS train:<br /><br />N2 route is preferred over E2 route<br /><br />R4#sh ip ospf database external <br /><br />            OSPF Router with ID (4.4.4.4) (Process ID 1)<br /><br />                Type-5 AS External Link States<br /><br />  LS age: 12<br />  Options: (No TOS-capability, DC, Upward)<br />  LS Type: AS External Link<br />  Link State ID: 100.100.100.0 (External Network Number )<br />  Advertising Router: 4.4.4.4<br />  LS Seq Number: 80000001<br />  Checksum: 0x8871<br />  Length: 36<br />  Network Mask: /24<br />        Metric Type: 2 (Larger than any link state path)<br />        MTID: 0 <br />        Metric: 18 <br />        Forward Address: 192.168.1.1<br />        External Route Tag: 0<br /><br />  LS age: 18<br />  Options: (No TOS-capability, DC, Upward)<br />  LS Type: AS External Link<br />  Link State ID: 100.100.100.0 (External Network Number )<br />  Advertising Router: 5.5.5.5<br />  LS Seq Number: 80000007<br />  Checksum: 0x1348<br />  Length: 36<br />  Network Mask: /24<br />        Metric Type: 2 (Larger than any link state path)<br />        MTID: 0 <br />        Metric: 18 <br />        Forward Address: 0.0.0.0<br />        External Route Tag: 0<br /><br />R4#sh ip ospf database nssa-external <br /><br />            OSPF Router with ID (4.4.4.4) (Process ID 1)<br /><br />                Type-7 AS External Link States (Area 1)<br /><br />  Routing Bit Set on this LSA in topology Base with MTID 0<br />  LS age: 79<br />  Options: (No TOS-capability, Type 7/5 translation, DC, Upward)<br />  LS Type: AS External Link<br />  Link State ID: 100.100.100.0 (External Network Number )<br />  Advertising Router: 1.1.1.1<br />  LS Seq Number: 8000000A<br />  Checksum: 0x3CB6<br />  Length: 36<br />  Network Mask: /24<br />        Metric Type: 2 (Larger than any link state path)<br />        MTID: 0 <br />        Metric: 18 <br />        Forward Address: 192.168.1.1<br />        External Route Tag: 0<br /><br />R4#sh ip ospf border-routers <br /><br />            OSPF Router with ID (4.4.4.4) (Process ID 1)<br /><br /><br />                Base Topology (MTID 0)<br /><br />Internal Router Routing Table<br />Codes: i - Intra-area route, I - Inter-area route<br /><br />i 1.1.1.1 [2] via 192.168.1.1, GigabitEthernet1/0, ASBR, Area 1, SPF 28<br />i 5.5.5.5 [2] via 192.168.47.7, GigabitEthernet3/0, ASBR, Area 0, SPF 7<br />i 2.2.2.2 [2] via 192.168.47.7, GigabitEthernet3/0, ABR/ASBR, Area 0, SPF 7<br />i 2.2.2.2 [2] via 192.168.1.2, GigabitEthernet1/0, ABR/ASBR, Area 1, SPF 28<br />i 3.3.3.3 [2] via 192.168.47.7, GigabitEthernet3/0, ABR/ASBR, Area 0, SPF 7<br />i 3.3.3.3 [2] via 192.168.1.3, GigabitEthernet1/0, ABR/ASBR, Area 1, SPF 28<br /><br />R4#sh ip route 100.100.100.100<br />Routing entry for 100.100.100.0/24<br />  Known via &quot;ospf 1&quot;, distance 110, metric 18, type NSSA extern 2, forward metric 2<br />  Last update from 192.168.1.1 on GigabitEthernet1/0, 00:00:50 ago<br />  Routing Descriptor Blocks:<br />  * 192.168.1.1, from 1.1.1.1, 00:00:50 ago, via GigabitEthernet1/0<br />      Route metric is 18, traffic share count is 1<br /></div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="8867228222145365596">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Pavel</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8867228222145365596" href="#8867228222145365596">29 March 2018 21:50</a>
              </span>
            </div>
            <div class="comment-content">Hello Ivan,<br /><br />I&#39;m testing E2 routes selection with Cisco IOS Version 15.4(2)T4. The purpose is to get clear understanding of OSPF E2 selection (and perhaps implementation bugs).<br /><br />The topology is the following:<br />  <br /><br />R1(ASBR) =(192.168.1.0/24, area 0)= R2 =(192.168.2.0/24, area 1)= R3 (ASBR)<br />             ||<br />       R4<br />IP @ as follloing:<br />R1 - 192.168.1.1<br />R2 - 192.168.1.12, 192.168.2.12<br />R3 - 192.168.2.3<br />R4 - 192.168.2.23<br /><br />Router R4 is in network 192.168.2.0/24 (if the schema below corrupts during comment posting)<br /><br />R1 advertises E2 prefix with metric 19, R3 advertises same prefix with metric 20.<br /><br />R4 chooses route towards R1. <br /><br />R4#show ip route <br />Codes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP<br />       D - EIGRP, EX - EIGRP external, O - OSPF, IA - OSPF inter area <br />       N1 - OSPF NSSA external type 1, N2 - OSPF NSSA external type 2<br />       E1 - OSPF external type 1, E2 - OSPF external type 2<br />       i - IS-IS, su - IS-IS summary, L1 - IS-IS level-1, L2 - IS-IS level-2<br />       ia - IS-IS inter area, * - candidate default, U - per-user static route<br />       o - ODR, P - periodic downloaded static route, H - NHRP, l - LISP<br />       a - application route<br />       + - replicated route, % - next hop override<br /><br />Gateway of last resort is 192.168.2.12 to network 0.0.0.0<br /><br />O*E2  0.0.0.0/0 [110/19] via 192.168.2.12, 00:07:06, Ethernet0/0<br />O IA  192.168.1.0/24 [110/20] via 192.168.2.12, 00:07:06, Ethernet0/0<br />      192.168.2.0/24 is variably subnetted, 2 subnets, 2 masks<br />C        192.168.2.0/24 is directly connected, Ethernet0/0<br />L        192.168.2.23/32 is directly connected, Ethernet0/0<br /><br />R4#show ip ospf database external <br /><br />            OSPF Router with ID (192.168.2.23) (Process ID 1)<br /><br />  Type-5 AS External Link States<br /><br />  Routing Bit Set on this LSA in topology Base with MTID 0<br />  LS age: 1456<br />  Options: (No TOS-capability, No DC, Upward)<br />  LS Type: AS External Link<br />  Link State ID: 0.0.0.0 (External Network Number )<br />  Advertising Router: 192.168.1.1<br />  LS Seq Number: 80000003<br />  Checksum: 0x84CD<br />  Length: 36<br />  Network Mask: /0<br /> Metric Type: 2 (Larger than any link state path)<br /> MTID: 0 <br /> Metric: 19 <br /> Forward Address: 0.0.0.0<br /> External Route Tag: 0<br /><br />  LS age: 850<br />  Options: (No TOS-capability, No DC, Upward)<br />  LS Type: AS External Link<br />  Link State ID: 0.0.0.0 (External Network Number )<br />  Advertising Router: 192.168.2.3<br />  LS Seq Number: 80000005<br />  Checksum: 0x77D4<br />  Length: 36<br />  Network Mask: /0<br /> Metric Type: 2 (Larger than any link state path)<br /> MTID: 0 <br /> Metric: 20 <br /> Forward Address: 0.0.0.0<br /> External Route Tag: 0<br /><br />R4# <br /><br /><br />The 4th rule above states that: <br /><br />&quot;External routes received from an intra-area ASBR should be preferred over external routes received from ASBRs in other areas. Cisco IOS ignores this rule even after configuring no compatible rfc1583 (Section 16.4.1 of the OSPF RFC)&quot;<br /><br />This rule doesn&#39;t go well with what I see. It seems to me that multiple ASBRs is a different setup if to compare to multiple path to one ASBR. <br />With multiple ASBR the rules should have the following order:<br />1) When comparing E2 routes, only the external costs are compared, Section 16.4 paragraph (6.b)<br />2) (if we still can&#39;t select the best) External routes received from an intra-area ASBR should be preferred over external routes received from ASBRs in other areas, Section 16.4.1 takes it&#39;s turn.<br /><br />What do you think to this point?<br /><br />Thanks in advance.<br /><br />Pavel</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="5636008952151363976">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/17555664891506980151" rel="nofollow">wizard</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5636008952151363976" href="#5636008952151363976">02 April 2018 10:10</a>
              </span>
            </div>
            <div class="comment-content">I would recommend you set up the topology of Figure 19  of Appendix G.7 of RFC 2178 with IOS 15.4(2)T, and explicitly disable rfc1583 compatibility with the `no compatible rfc1583` command.<br />Then issue the following commands on A1 and B1:<br />sh ip ospf rib 10.0.0.0<br /><br />You will see that for each router,<br />the next hop for 10.0.0.0/8 is the other router.<br /></div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="4078999850277410969">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Pavel</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c4078999850277410969" href="#4078999850277410969">02 April 2018 16:17</a>
              </span>
            </div>
            <div class="comment-content">Hello Wizard,<br /><br />Thanks for your reply. I have read Appendix G.7 of RFC 2178 before and it doesn&#39;t give the answer to my question. <br /><br />We consider situations only with RFC1583Compatibility = disabled.<br /><br />Appendix G.7 of RFC 2178 talks about one ASBR but we have two ASBRs. This is a crucial difference to my mind and we have 2 options here. <br /><br />1/ If we have 1 ASBR and 2 paths to ASBR (this is not our case)<br />In this case RFC 2328 16.4(3) pruning procedure kicks in according to Section 16.4.1:<br /><br />(3) ...<br />If the forwarding address is set to 0.0.0.0, packets should<br />be sent to the ASBR itself. Among the multiple routing table<br />entries for the ASBR, select the preferred entry as follows. &lt;&lt;&lt; true, we have 2 path to ASBR<br />If RFC1583Compatibility is set to &quot;disabled&quot;, prune the set  &lt;&lt;&lt; pruning takes place<br />of routing table entries for the ASBR as described in<br />Section 16.4.1. In any case, among the remaining routing<br />table entries, select the routing table entry with the least<br />cost; when there are multiple least cost routing table<br />entries the entry whose associated area has the largest OSPF<br />Area ID (when considered as an unsigned 32-bit integer) is<br />chosen.  <br /><br />P. 16.4.1 decides which patch is the best according to the rule:<br /><br />&quot;Intra-area paths using non-backbone areas are always the<br />most preferred.&quot;<br /><br /><br /><br />2/ If we have 2 ASBR and 2 paths to ASBRs, i.e. 1 path to each ASBR (this is our case)<br /><br />In this case RFC 2328 16.4(3) pruning procedure DOESN&#39;T kick and Section 16.4.1 is not applied at this step:<br /><br />(3) ...<br />If the forwarding address is set to 0.0.0.0, packets should<br />be sent to the ASBR itself. Among the multiple routing table<br />entries for the ASBR, select the preferred entry as follows. &lt;&lt;&lt; false, we have 1 path to ASBR<br />If RFC1583Compatibility is set to &quot;disabled&quot;, prune the set  &lt;&lt;&lt; pruning doesn&#39;t take place<br />of routing table entries for the ASBR as described in<br />Section 16.4.1. In any case, among the remaining routing<br />table entries, select the routing table entry with the least<br />cost; when there are multiple least cost routing table<br />entries the entry whose associated area has the largest OSPF<br />Area ID (when considered as an unsigned 32-bit integer) is<br />chosen.  <br /><br />As soon as 16.4.1 doesn&#39;t kick in we use 16.4(6)(b) to select the best E2 route<br /><br /><br />16.4(6)(b) ...<br />Type 1 external paths are always preferred over type 2<br />external paths. When all paths are type 2 external<br />paths, the paths with the smallest advertised type 2<br />metric are always preferred.<br /><br /><br /><br />Makes sense?<br /><br />BR</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="9083778965871543465">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/17555664891506980151" rel="nofollow">wizard</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c9083778965871543465" href="#9083778965871543465">03 April 2018 18:44</a>
              </span>
            </div>
            <div class="comment-content">You are almost 100% in your original post with the two rules at the end, but i would correct them to the following:<br /><br />With multiple ASBRs, the rules for selecting the AS-external LSA that will be preferred are the following:<br />1) When comparing E2 routes, only the external costs (E2 metric value) are compared, as per Section 16.4 paragraph 6.b<br />2) If we still can&#39;t select the best, it means that the external cost has tied. External routes received from a non-backbone intra-area ASBR should be preferred over external routes received from ASBRs in other areas, as per Section 16.4.1.<br /><br />I am not sure which network you are talking about in your latest reply, but i will assume you are talking about the network in G.7 of RFC 2178. In this network, we have A1 selecting one of the two AS-external LSAs it has received, and then we have B1 making a similar decision. Both AS-external LSAs have the same E2 metric. Both routers have the same two AS-external LSAs in their LSDB:<br /><br />1. from A3, and<br />2. from B3<br /><br />First, we will examine A1:<br /><br />The forwarding cost to reach A3 (from A1) is 6. The forwarding cost to reach B3 is 4 (as advertised by B2). As per RFC 2328, section 16.4 (6)(d), the least forwarding cost will be preferred:<br /><br />                                                 Type 2<br />external paths advertising equal type 2 metrics are<br />compared by looking at the distance to the forwarding<br />addresses.<br /><br />A1 does not distinguish between A3 (which is a backbone intra-area ASBR) and B3 (which is an inter-area ASBR).<br /><br />Therefore, A1 will prefer routing to B3 via B1.<br /><br />Now let&#39;s look at B1:<br /><br />B1 has one path to B3, and one path to A3:<br /><br />1. cost of intra-area path to B3: 8<br />2. cost of intra-area path to A3: 7<br /><br />According to RFC1583 rules, B1 will prefer to use the path to A3, causing a loop.<br /><br />Now assume that the algorithm from RFC 2328 is used, and B1 installs the path to network N (10.0.0.0/8) into the OSPF RIB via A3 (because the AS-external LSA from A3 was examined first).<br />Now B1 examines the next AS-external LSA that it has received from B3:<br /><br />steps 16.4(1) and 16.4(2) are false, so we start examining the third paragraph of 16.4(3):<br /><br />There is a single routing table entry for the ASBR, so the set of routing table entries is NOT pruned. At this point, you are correct. Then, we move to step 16.4(6) where we examine if the path via A3 which is already in the OSPF routing table will be replaced by the path via B3:<br /><br />(a) Both entries are AS external paths - no replacement<br />(b) Both AS-external LSAs advertise equal E2 costs - no replacement<br />(c) This step says:<br /><br />select the preferred paths based on the intra-AS paths to the<br />ASBR/forwarding addresses, as specified in Section 16.4.1. &lt;&lt;&lt;&lt;&lt;&lt; This step assumes that there are two paths. Because at this point, you must be comparing two different paths, to two separate ASBRs.<br /><br />We have to go to section 16.4.1 to select one of the two intra-area ASBRs:<br />According to 16.4.1:<br />The Intra-area path to an ASBR using the non-backbone area is preferred to the intra-area backbone path to another ASBR. The intra-area path to B3 is preferred to the backbone path to A3, and so the routing table entry to N via A3 gets replaced.<br /><br />To find the implementation &quot;bug&quot; in IOS, set up the RFC2178/G.7 network, and watch IOS create a routing loop. And keep in mind that this is not a bug. When contacting Cisco TAC, the boilerplate answer you will get is either:<br /><br />1. Upgrade to NX-OS or IOS-XE<br />2. Do not create this weird scenario<br />3. Configure Multi-Area Adjacency (RFC 5185) between B1-B2<br /><br />I am not clear as to what your point is, or what exactly you are asking. Do you believe that IOS *does* implement RFC 2328 precisely? Because it does not. Again, just watch the loop that was supposed to not exist (because of section 16.4.1) appear when you set up the RFC2178/G.7 network.<br /><br />Best Regards,<br />Angelos Vassiliou @ipmess</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="4636553294241673699">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Pavel</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c4636553294241673699" href="#4636553294241673699">04 April 2018 16:23</a>
              </span>
            </div>
            <div class="comment-content">Hi, Wizard!<br /><br />Thanks for such a great answer!<br /><br />My initial problem was to understand how OSPF E2 route selection should work according to RFC. Since there were multiple RFCs, RFCs not clearly written (my personal opinion), and there are some bugs in implementation from different vendors it is hard to inderstand why routing loops appear.<br /><br /><br />In particular I was investigating how E2 route selection works in a sample network.<br /><br />Sample network topology as below:<br /><br />R1(ASBR) =(192.168.1.0/24, area 0)= R2 =(192.168.2.0/24, area 1)= R3 (ASBR)<br /><br />Router R4 is in network 192.168.2.0/24 (router on a stick)<br /><br /><br />IP @ as follloing:<br />R1 - 192.168.1.1<br />R2 - 192.168.1.12, 192.168.2.12<br />R3 - 192.168.2.3<br />R4 - 192.168.2.23<br /><br /><br />R1 advertises default route with E2 metric 19<br />R3 advertises default route with E2 metric 20<br /><br />R4 is router-under-test.<br /><br />While testing I got that R4 chooses E2 route with metric 19, i. e. route from ASBR R1 that is in another area (route from intra-area ASBR R3 appeared to be worse).<br /><br /><br />Here is why this Ivan&#39;s post confused me a lot. If to look from R4 perspective and read route selection rules from top to bottom we hit rule #4:<br /><br />&quot;External routes received from an intra-area ASBR should be preferred over external routes received from ASBRs in other areas&quot;<br /><br />According to this rule R4 should select E2-route with metric 20, but that is not true in practice. Seems like the rule assumes that E2 metrics are the same or it is not in its place (has wrong order). <br /><br />In my case it doesn&#39;t seem that we faced some Cisco bug. Perhaps that there are some implementation bugs that make RFC2178/G.7 network to fail but in my case Cisco seems to work according to RFC. I have also tested Juniper vMX and it behaves the same as Cisco.<br /><br /><br />Your last post made me thinking that my understaning was correct.<br /><br />Thanks again!<br /><br />BR  </div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="7714137295570765197">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/17555664891506980151" rel="nofollow">wizard</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c7714137295570765197" href="#7714137295570765197">08 June 2018 14:21</a>
              </span>
            </div>
            <div class="comment-content">Hello Pavel,<br /><br />You are perfectly right!<br /><br />RFC 2328 with RFC1583Compatibility disabled dictates the following behavior at R4 in the example internetwork you presented originally:<br /><br />1. R4 will make a list of all the ASBRs that it advertise the particular prefix. In this case, the prefix is the default route, and the two ASBRs that advertise this prefix are R1 and R3 (192.168.1.1 and 192.168.2.3).<br />2. R4 will then check if there are any intra-area ASBRs in this list of ASBRs. In this case, there is. R3 is intra-area, whereas R1 is an inter-area ASBR. Note that the rule separates the list of ASBRs into two categories:<br />i. Backbone and inter-area ASBRs<br />ii. Intra-area ASBRs<br />3. Prefer the intra-area ASBRs. If there are no intra-area ASBRs, use the inter-area ASBRs. If there is at least a single intra-area ASBR, ignore *all* the backbone and inter-area ASBRs. What happens in effect is that backbone and inter-area ASBRs are _filtered_ out from the list of ASBRs. In this example, the inter area ASBR (R1) is filtered out from the list of ASBRs, and the only ASBR available that advertises the default route is R3. R4 chooses to route to the only available ASBR for the default route, and thus adds a default route via R3.<br />4. After the backbone and inter-area ASBRs have been filtered, go through the whole selection process as described in this blog post.<br /><br />Your main problem of course is the decision process at R2, the ABR.<br /><br />The main point here is to understand the following: E2 is king. Always select the route with the lowest E2 metric, ignoring all other path selection criteria.<br />After that, if there are several paths with equal E2 metric, there are two differing behaviors:<br /><br />1. In RFC 1583, Cisco IOS, and RFC 2328 with RFC1583Compatibility enabled: select the path with the lowest forward metric. If there are several paths with equal-cost forward metric, add all paths into the OSPF routing table.<br />2. In RFC 2328 with RFC1583Compatibility disabled: First, prune all intra-backbone and inter-area ASBRs. Second, of any remaining ASBRs, select the lowest cost forward metric. If there still are several equal-cost forward metric paths to the external destination, add all paths into the OSPF routing table.<br /><br />I will follow the steps of RFC 2328, Section 16.4 to dissect how R2 in your example internetwork will determine it should route to R1 (and not to R3) for the default route:<br /><br />First, the AS-external-LSA from R3 is examined:<br /><br />16.4(3): N: 0.0.0.0/0. There is an entry for R3 as an ASBR in R2&#39;s routing table. Since the LSA&#39;s forwarding address is 0.0.0.0, packets should be sent to the ASBR itself. Since there is only one entry for the ASBR, no pruning will be performed.<br />16.4(4): X: 1 (i will assume it is 1, but this is irrelevant). Y: 20<br />16.4(5): There is no entry for destination N yet. The path gets installed into the routing table. Path-type: 2, X:1, Y:20.<br />16.4(6): N/A since there was no entry for N yet.<br /><br />Next, the  AS-external-LSA from R1 is examined:<br /><br />16.4(3): N: 0.0.0.0/0. There is an entry for R1 as an ASBR in R2&#39;s routing table. Since the LSA&#39;s forwarding address is 0.0.0.0, packets should be sent to the ASBR itself. Since there is only one entry for the ASBR, no pruning will be performed.<br />16.4(4): X: 1 (i will assume it is 1, but this is irrelevant). Y: 19<br />16.4(5): There already is an entry for destination N in the routing table.<br />16.4(6): Compare the AS external path described by the LSA with the existing paths in N&#39;s routing table entry, as follows:<br />16.4(6)(a): The already-installed path is AS external, therefore we go to the next step.<br />16.4(6)(b): Both paths are type 2 external paths. The the paths with the smallest advertised type 2 metric are always preferred. In this case, the older entry from the routing table will be replaced by the path via R1. This clause makes the E2 metric king.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="3084007439747777643">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13216073857254707471" rel="nofollow">Nitesh</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c3084007439747777643" href="#3084007439747777643">10 September 2019 14:03</a>
              </span>
            </div>
            <div class="comment-content">Hi,<br /><br />Could anyone help to clear my doubt please..<br /><br />Now consider router is learning same external prefix from two ASBR with same redistribution cost and same forward metric(same cost to reach ASBR). Now everything is tie. Which ASBR will be preferred?</div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="8004360051520309570">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13457151406311272386" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8004360051520309570" href="#8004360051520309570">10 September 2019 19:58</a>
              </span>
            </div>
            <div class="comment-content">The best way to resolve this dilemma: set up a 3-router lab (using virtual routers in VIRL for example) and test it out.</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="9120406342537820879">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13216073857254707471" rel="nofollow">Nitesh</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c9120406342537820879" href="#9120406342537820879">11 September 2019 06:24</a>
              </span>
            </div>
            <div class="comment-content">Hi Ivan,<br /><br />Could you please help me here<br />https://learningnetwork.cisco.com/thread/136431?sr=inbox&amp;ru=289019<br /><br />Thanks,<br />Nitesh</div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="2021102115848048582">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13457151406311272386" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2021102115848048582" href="#2021102115848048582">11 September 2019 06:28</a>
              </span>
            </div>
            <div class="comment-content">Assuming you got the printouts in that page from routers, you would get your answer with &quot;show ip route&quot; ;)</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="8088945959292909236">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13216073857254707471" rel="nofollow">Nitesh</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8088945959292909236" href="#8088945959292909236">11 September 2019 18:18</a>
              </span>
            </div>
            <div class="comment-content">Hi Ivan,<br /><br />Below is the output<br />R3#sh ip route | s 4.4.4.4<br />O E2     4.4.4.4 [110/20] via 10.0.32.2, 00:04:02, FastEthernet1/1<br />                 [110/20] via 10.0.31.1, 00:04:02, FastEthernet1/0<br />                 [110/20] via 10.0.13.14, 00:04:02, FastEthernet5/1<br /><br /><br />R3#sh ip ospf border-routers<br />            OSPF Router with ID (0.0.0.3) (Process ID 1)<br />                Base Topology (MTID 0)<br /><br />Internal Router Routing Table<br />Codes: i - Intra-area route, I - Inter-area route<br /><br />i 0.0.0.2 [1] via 10.0.32.2, FastEthernet1/1, ABR/ASBR, Area 0, SPF 3<br />i 0.0.0.1 [1] via 10.0.31.1, FastEthernet1/0, ASBR, Area 0, SPF 3<br />i 0.0.0.14 [1] via 10.0.13.14, FastEthernet5/1, ASBR, Area 0, SPF 3<br /><br /><br />R3#sh ip ospf database external 4.4.4.4<br /><br />            OSPF Router with ID (0.0.0.3) (Process ID 1)<br /><br />                Type-5 AS External Link States<br /><br />  Routing Bit Set on this LSA in topology Base with MTID 0<br />  LS age: 368<br />  Options: (No TOS-capability, DC, Upward)<br />  LS Type: AS External Link<br />  Link State ID: 4.4.4.4 (External Network Number )<br />  Advertising Router: 0.0.0.1<br />  LS Seq Number: 80000001<br />  Checksum: 0x3B53<br />  Length: 36<br />  Network Mask: /32<br />        Metric Type: 2 (Larger than any link state path)<br />        MTID: 0<br />        Metric: 20<br />        Forward Address: 0.0.0.0<br />        External Route Tag: 1<br /><br />  Routing Bit Set on this LSA in topology Base with MTID 0<br />  LS age: 367<br />  Options: (No TOS-capability, DC, Upward)<br />  LS Type: AS External Link<br />  Link State ID: 4.4.4.4 (External Network Number )<br />  Advertising Router: 0.0.0.2<br />  LS Seq Number: 80000001<br />  Checksum: 0x4745<br />  Length: 36<br />  Network Mask: /32<br />        Metric Type: 2 (Larger than any link state path)<br />        MTID: 0<br />        Metric: 20<br />        Forward Address: 0.0.0.0<br />        External Route Tag: 2<br /><br />  Routing Bit Set on this LSA in topology Base with MTID 0<br />  LS age: 258<br />  Options: (No TOS-capability, DC, Upward)<br />  LS Type: AS External Link<br />  Link State ID: 4.4.4.4 (External Network Number )<br />  Advertising Router: 0.0.0.14<br />  LS Seq Number: 80000002<br />  Checksum: 0xD59D<br />  Length: 36<br />  Network Mask: /32<br />        Metric Type: 2 (Larger than any link state path)<br />        MTID: 0<br />        Metric: 20<br />        Forward Address: 0.0.0.0<br />        External Route Tag: 14<br /><br />Now will R3 loadbalance across all 3 paths, because wireshark shows something else</div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="4956817075340805212">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13457151406311272386" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c4956817075340805212" href="#4956817075340805212">11 September 2019 19:36</a>
              </span>
            </div>
            <div class="comment-content">There&#39;s your answer - three entries for the same prefix in the routing table ==&gt; load balancing. QED.<br /><br />As for the actual packet flows, you might find some answers in my older load balancing blog posts: https://blog.ipspace.net/search/label/load%20balancing</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="639">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow"> Vladislav</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c639" href="#639">03 June 2021 10:59</a>
              </span>
            </div>
            <div class="comment-content"><p>Hello there. What about comparing routes from two different ospf processes? The docs tell us that there is no preferencing of intra-area route of one ospf process over external route of second process. So, which route will be installed in the routing table is unknown. The behavior unpredictable. </p>

<p>But simple lab can show that intra-area route is prefered one in comparing with external route of different ospf process. Where is thrue?</p>
</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="640">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c640" href="#640">05 June 2021 09:01</a>
              </span>
            </div>
            <div class="comment-content"><p>Thanks for the tip -- even when dealing with intra-area routes coming from two OSPF processes, IOS XE consistently chooses the one with lower OSPF cost, so it looks like they significantly improved the tie-breaker behavior.</p>

<p>Writing a blog post about what I found...</p>
</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="641">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow"> andrea di donato</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c641" href="#641">06 June 2021 03:51</a>
              </span>
            </div>
            <div class="comment-content"><p>Hi There,       </p>

<p>Regarding different processes with the same Preference/Admin_Distance, I had to do some tests with Nokia SROS and cisco IOSXR a couple of years ago and two routes known via the same LSA type have the metric as the tie-breaker while they have the process ID as the tie-breaker (the lower wins) when the metric is the same.     </p>

<p>The tacticat use of Multi-OSPF process is a popular technique for network migrations.     </p>

<p>Cheers/Ciao <br />
Andrea    </p>
</div>
          </div>
        </li>
      </div>
  </ol>

    </div>
  </div>
</div>
