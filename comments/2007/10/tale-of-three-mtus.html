<div class="comments post" id="comments">
  <h4>13 comments:</h4>
  <div class="comments-content">
    <div class="comment-thread">
        <ol>
      <div>
        <li class="comment" id="5585095217364017389">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Anonymous</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5585095217364017389" href="#5585095217364017389">17 October 2007 16:51</a>
              </span>
            </div>
            <div class="comment-content">I think one of the most tricky MTU issues are when you have GRE tunnel with or without IPSec. This document from Cisco documented the potential issues and how you can workaround them.<BR/><BR/>http://www.cisco.com/en/US/tech/tk827/tk369/technologies_white_paper09186a00800d6979.shtml<BR/><BR/>With businesses going global one can expect to see more IPSec+GRE tunnels to be deployed everywhere.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="3243229291124531047">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13457151406311272386" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c3243229291124531047" href="#3243229291124531047">17 October 2007 17:08</a>
              </span>
            </div>
            <div class="comment-content">... and that's where my investigation into various MTU issues originally started, only I had a scenario running MPLS/VPN across GRE/IPSec.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="4241368367614898544">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Anonymous</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c4241368367614898544" href="#4241368367614898544">17 October 2007 17:16</a>
              </span>
            </div>
            <div class="comment-content">I found that the tcp mss adjust is a must-use command to avoid fragmentation and reassembly by the routers if IPSec and/or GRE is involved. The only time where I must set the IP MTU to 1500 inside a GRE tunnel was that my customer was having a home-grown apps that needed to see the entire 1500-byte packet intact.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="2533382416187529247">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Anonymous</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2533382416187529247" href="#2533382416187529247">30 October 2007 02:29</a>
              </span>
            </div>
            <div class="comment-content">There is some additional interesting information that I summarised to the cisco nsp list last year with regards to h/w mtu on cisco 7200 (with PA-FE DEC chipsets), mpls MTU and general MTU requirements for AToM circuits from point of view of CE->PE and PE->P links.<BR/><BR/>Archive here:<BR/><BR/>http://puck.nether.net/pipermail/cisco-nsp/2006-June/031765.html</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="3930456855524372136">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Anonymous</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c3930456855524372136" href="#3930456855524372136">29 September 2008 11:58</a>
              </span>
            </div>
            <div class="comment-content">I have had a major issue when I tried to change the IP mtu size of a router running IPSec tunnels. The router (cisco 2851 with 12.4(15).T4 changed the interface MTU also to 1400 (with my IP MTU 1400 command). With a firewall in between blocking ICMP, PMTUD also broke. Is this is known "feature"? I know that changing the MTU interface value would automatically change the IP MTU but not the other way around. ???</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="8644191555639778073">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13457151406311272386" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8644191555639778073" href="#8644191555639778073">30 September 2008 19:46</a>
              </span>
            </div>
            <div class="comment-content">@Nasir: This is weird. Changing the IP MTU should not change the interface MTU. BTW, you might want to read <A HREF="http://www.nil.com/ipcorner/IP_Fragmentation/" REL="nofollow">The never-ending story of IP fragmentation</A> article.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="6968132615748407630">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Hadi</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c6968132615748407630" href="#6968132615748407630">09 August 2009 15:23</a>
              </span>
            </div>
            <div class="comment-content">Hi,<br /><br />I&#39;m till confused about the types of MTUs<br /><br />Could someone please elaborate a bit more on this <br /><br />1- IP MTU is counted from where in the Packet ?<br />2- Does the interface MTU include the header of the layer 2 ?<br />if not is the IP MTU equal to the interface MTU ? If so why do we need the change any of those values ?<br />3- How do i set the MPLS MTU ? if possible , kindly provide an example<br /><br /><br />thx</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="6085171071338895298">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Niobe</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c6085171071338895298" href="#6085171071338895298">02 August 2010 01:43</a>
              </span>
            </div>
            <div class="comment-content">This was very helpful, but still not entirely sure what MTU I should be using in this situation.. I am configuring a pair of interfaces for EoMPLS. So in this case the payload is an ethernet packet, and the &#39;outer&#39; ethernet frame has two MPLS labels. If my IP MTU is normally 1500, I would be encapsulating a 1514 byte frame in a 14+4+4 byte header, giving (I think) 1536 bytes on the wire. What are the correct MTU commands for this scenario?</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="3871602326201803704">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Diego Zamberlan</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c3871602326201803704" href="#3871602326201803704">10 May 2011 16:53</a>
              </span>
            </div>
            <div class="comment-content">Thank you taking the time to share your knowledge and experience.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="7355886214136998392">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="http://www.pingnetworks.co.uk" rel="nofollow">Simon Chamberlain</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c7355886214136998392" href="#7355886214136998392">28 October 2012 11:18</a>
              </span>
            </div>
            <div class="comment-content">A great post. I agree that the tcp mss adjust command is particularly useful at sorting out MTU issues. Having spent a few years running MPLS I&#39;d also recommend setting an interface to 802.1q on FE interfaces to squeeze and extra four bytes of overhead out of the ethernet frame. Most Cisco FE ports are fixed at 1500 bytes so it&#39;s a usual workaround if you want to run MPLS on an FE port. If in addition you want to run MPLS VPNs on top of this (again on an FE port) you will need an additional four bytes, so you&#39;ll need to set the MPLS MTU to 1504 (or above). The problem with this is your effective interface MTU now becomes 1496 - meaning you will need good old tcp mss adjust for general traffic. Less of a problem these days with GE ports and the ability to set interface MTU over 1500 bytes.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="8356737385747653911">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Anonymous</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8356737385747653911" href="#8356737385747653911">05 October 2013 01:54</a>
              </span>
            </div>
            <div class="comment-content">Hi. We&#39;ve been troubleshooting some file transfer performance issues in our network and have narrowed it down, using various testing, to what we believe is our MPLS L3 links between our data center Core and Distribution switches. Currently, the core has 2 10G links, each a /30 L3 link with MPLS on it and an MTU size of 1508. Looking at the stats, we see 100&#39;s of millions of giants on the switch interfaces, these are 6509&#39;s with SUP-720 3B&#39;s by the way. 8 port 10G blades. All 6509&#39;s, cards and IOS match between cores and dists. Application traffic is not affected, but any type of file transfer does appear to be. We are thinking that due to the 1508 MTU size for MPLS (no specific ip or MPLS MTU settiings, just HW), that it&#39;s creating performance issues for these transfers, for example, winscp (tcp 22), netapp, oracle, cifs, etc. Anyone run into this or have any recommendations?</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="8549997488855625017">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/07834714223334662161" rel="nofollow">lofeezy</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8549997488855625017" href="#8549997488855625017">28 July 2016 16:46</a>
              </span>
            </div>
            <div class="comment-content">Hi, <br />Apart from this post, I would like to know if setting an mtu on interface impacts the incoming trafic. <br />Assuming that no DF bit is set on the frames:<br />How does a router with an interface with a 1500 bytes mtu value acts when receiving an incoming frame larger than 1500 ?<br /><br /><br /> </div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="6089312690563214582">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13457151406311272386" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c6089312690563214582" href="#6089312690563214582">28 July 2016 19:29</a>
              </span>
            </div>
            <div class="comment-content">It depends on the input buffer size (and hardware/software implementation details). If the packet fits into the buffer, I&#39;d expect the router to process it. <br /><br />If you get buffer overflow, then the packet is dropped at the hardware level before ever being looked at.</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
  </ol>

    </div>
  </div>
</div>
