{
   "comments": [
      {
         "date": "19 May 2020 11:06",
         "html": "<p>To even achieve more flexibility like working with 2FA/manual authentication uri module comes into rescue as it allows to reuse session cookie for any subsequent calls i.e. loop statements (ones ending up with subsequent authentication sessions). An example would be:</p>\n\n<p>Role:</p>\n\n<hr />\n\n<ul>\n<li><p>name: Login\nuri:\nurl: https://{{ inventory_hostname }}/api/aaaLogin.json\nmethod: POST\nbody: '\"{ \"aaaUser\" : { \"attributes\" : { \"name\" : \"{{ username }}\" , \"pwd\" : \"{{ password }}\" } } }\"'\nstatus_code: 200\nvalidate_certs: False\nheaders:\n  Content-Type: \"application/json\"\nno_log: True\nregister: login</p></li>\n<li><p>name: Add Bridge Domain\nuri:\nurl: https://{{ inventory_hostname }}/api/node/mo/uni/tn-{{ item.tenant }}/BD-{{ item.name }}.json\nbody: {\"fvBD\":{\"attributes\":{\"dn\":\"uni/tn-{{ item.tenant }}/BD-{{ item.name }}\",\"name\":\"{{ item.name }}\",\"descr\":\"{{ item.description }}\",\"unicastRoute\":\"{{ item.unicast }}\",\"rn\":\"BD-{{ item.name }}\",\"status\":\"created\"},\"children\":[{\"fvRsCtx\":{\"attributes\":{\"tnFvCtxName\":\"{{ item.vrf }}\",\"status\":\"created,modified\"},\"children\":[]}}]}}\nmethod: POST\nbody_format: json\nreturn_content: yes\nvalidate_certs: False\nheaders:\n  Cookie: \"{{ login.set_cookie }}\"\nloop: \"{{ bd }}\"</p></li>\n</ul>\n\n<p>Vars file for loop:</p>\n\n<hr />\n\n<p>bd:\n - {tenant: \"common\", name: \"bd_192.168.1.0/24\", description: \"default\", unicast: \"false\", vrf: \"default\"} \n - {tenant: \"common\", name: \"bd_192.168.2.0/24\", description: \"default\", unicast: \"true\", vrf: \"default\"} \n - {tenant: \"common\", name: \"bd_192.168.3.0/24\", description: \"default\", unicast: \"false\", vrf: \"default\"} </p>\n",
         "id": "42",
         "name": " Kamil",
         "pub": "2020-05-19T23:06:07",
         "type": "comment"
      }
   ],
   "count": 1,
   "type": "post",
   "url": "2018/10/automation-win-configure-cisco-aci-with.html"
}
