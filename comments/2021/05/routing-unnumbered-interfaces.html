<div class="comments post" id="comments">
  <h4>3 comments:</h4>
  <div class="comments-content">
    <div class="comment-thread">
        <ol>
      <div>
        <li class="comment" id="619">
          <!--
          <div class="avatar-image-container">
            <img src="">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Andrea Di Donato</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c619" href="#619">01 June 2021 11:24</a>
              </span>
            </div>
            <div class="comment-content"><p>another gem Ivan - thanks. </p>

<p>I just wanted to add a bit of my personal experience on the OSPFoGRE subject:  </p>

<p>On a certain OS version of a popular router platform (I believe it&#39;s fixed on newer OS versions now but ...still... it&#39;s representative of what can happen on any platform), the following happens:    </p>

<p>If the &#39;encaps&#39; dst IP address of the GRE tunnel is known in BGP then you need to override that with a static route in order for any OSPF packet to enter the tunnel. You don&#39;t need the static route if the OSPF packets are fragmented. </p>

<p>The reason for this exotic working recipe should be (as we never really got a final answer) that:  </p>

<ul>
<li><p>The OSPF packets are generated by the OSPF process on the central CPU and it cannot do a BGP lookup since it&#39;s a recursive one</p></li>
<li><p>if you induce fragmentation then it all works .... as I guess an OSPF packet that is too big can access an area of the processing or of a chipset that is provided with the ability to do recursive lookups as well as fragmentation.  </p></li>
</ul>

<p>Cheers/Ciao <br />
Andrea  </p>
</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="620">
          <!--
          <div class="avatar-image-container">
            <img src="">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c620" href="#620">01 June 2021 02:06</a>
              </span>
            </div>
            <div class="comment-content"><p>@Andrea: I would suspect the decision to ignore BGP routes when originating OSPF packets probably comes from someone&#39;s attempts to detect and alleviate recursive routing loops (tunnel endpoint being available over the tunnel scenarios). Fragments follow the regular packet forwarding structures.</p>

<p>Obviously it would help if the behavior was documented/explained.</p>
</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="630">
          <!--
          <div class="avatar-image-container">
            <img src="">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Andrea Di Donato</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c630" href="#630">02 June 2021 07:37</a>
              </span>
            </div>
            <div class="comment-content"><p>Hello Ivan,   </p>

<p>Sorry, yeah, of course - I&#39;ll share a bit more details:   </p>

<p>The layout was the following:   </p>

<p>CE ------------------- PE ------------------------P <br />
&lt;-----Connected-----&gt;&lt;----OSPF + iBGP-----&gt; <br />
&lt;-----------------OSPFoGRE--------------------&gt;     </p>

<p>There&#39;s a whole network between PE and P.
The router with the issue was router P. 
The CE&#39;s end of the GRE tunnel was redistributed as connected into iBGP and thus received this way by router P.  </p>

<p>The issue was in version X and was fixed from version Y &gt; X    </p>

<p>Cheers/Ciao <br />
Andrea   </p>
</div>
          </div>
        </li>
      </div>
  </ol>

    </div>
  </div>
</div>
