<div class="comments post" id="comments">
  <h4>1 comments:</h4>
  <div class="comments-content">
    <div class="comment-thread">
        <ol>
      <div>
        <li class="comment" id="744">
          <!--
          <div class="avatar-image-container">
            <img src="">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow"> Erik Auerswald</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c744" href="#744">23 September 2021 03:44</a>
              </span>
            </div>
            <div class="comment-content"><p>The traffic would flow over the optimal paths if the two switch pairs were connected via MLAG, and all servers were connected to one switch pair via MLAG. But this would be a boring legacy setup that may allow for interesting, but rare, <a href="https://www.unix-ag.uni-kl.de/~auerswal/mlag_split_brain/">failure scenarios</a>. Additionally, VMware still prefers MAC based redundancy and load sharing instead of using LACP based LAGs. ;-)</p>

<p>In a more fashionable layer 3 setup with VXLAN overlay (or an SPB-M based fabric &agrave; la Extreme), the link between switches of the same pair could be omitted unless an MLAG construct requires it (some vendors support <em>virtual</em> MLAG peer links), or it could be configured with a higher metric value such that it is not used for IP (resp. MAC-in-MAC) forwarding unless the two links to the other switch pair both fail. This again would result in optimal forwarding.</p>

<p>If later there is a need to add more switches, a spine layer could be added &quot;in the middle.&quot;</p>

<p>Thus with care for the details the physical full mesh is either not needed or not detrimental, depending on circumstances (which include the selected switch models and network operating systems, among other things).</p>
</div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="745">
          <!--
          <div class="avatar-image-container">
            <img src="">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Jeff Tantsura</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c745" href="#745">23 September 2021 11:11</a>
              </span>
            </div>
            <div class="comment-content"><p>Simple routed fabric (with EVPN if L2/overlay is needed) would do just fine</p>
</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="747">
          <!--
          <div class="avatar-image-container">
            <img src="">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c747" href="#747">24 September 2021 07:21</a>
              </span>
            </div>
            <div class="comment-content">I would go for an even simpler design: routed fabric with VXLAN on top using static source replication list instead of EVPN.<br />


</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="749">
          <!--
          <div class="avatar-image-container">
            <img src="">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow"> Erik Auerswald</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c749" href="#749">24 September 2021 11:44</a>
              </span>
            </div>
            <div class="comment-content"><p>IMHO the question is what to do with the worrisome extra links between switches of a pair that turns the topology into a full mesh instead of just collapsing the spines into the leafs.</p>

<p>I think good answers are to remove them, or to not use them for IP forwarding and/or underlay transport, <em>unless required</em> (because of failed links), but be able to make use of those links if necessary (i.e., do not omit them from IP and/or underlay forwarding).</p>

<p>This would remove the doubts about traffic requirements noted in the blog post.</p>

<p>(YMMV depending on make and model of your switches and NOS.)</p>
</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="751">
          <!--
          <div class="avatar-image-container">
            <img src="">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c751" href="#751">25 September 2021 08:19</a>
              </span>
            </div>
            <div class="comment-content"><p>I don&#39;t understand why you find those links worrisome. There is no central switching fabric in this design, and the full mesh is probably the best you can do assuming you have no prior information on traffic flows. The proof is left as an exercise for the reader &#x1F61C;</p>

<p>Also, it&#39;s a small fabric, so it&#39;s worth keeping complexity to a minimum, thus no MLAG.</p>
</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
  </ol>

    </div>
  </div>
</div>
