<div class="comments post" id="comments">
  <h4>1 comments:</h4>
  <div class="comments-content">
    <div class="comment-thread">
        <ol>
      <div>
        <li class="comment" id="837">
          <!--
          <div class="avatar-image-container">
            <img src="">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow"> sjdkluytsiyklr</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c837" href="#837">10 November 2021 11:58</a>
              </span>
            </div>
            <div class="comment-content">Here is a recent VLAN hopping exploit for you: Alcatel-Lucent Enterprise AP-Mode on AOS6<br />

<p>This feature is related to authentication (802.1X or MAC) and VLAN assignment on a port where an wireless AP is discovered.
AP is discovered using &quot;lldp.tlv.enable_system_cap.wlan_access_pt == 1&quot;.</p>

<p>The switch assume the AP is in a NON-tunnel mode and that he will proceed authentication and tag traffic into the proper VLAN himself.
The idea is to avoid several authentication at AP and switch and speedup the process.</p>

<p>So the switch is not authenticating devices seen on the AP port. =&gt; authentication bypass
Switch is also trusting all the VLAN tags coming from this port. =&gt; VLAN hopping</p>

<p>This features is enabled by default. You can still disable it.
When upgrading from a previous version that doesn&#39;t support it, the configuration is converted to enable it.</p>

<p>I discovered it at a customer&#39;s place because they connected an AP to a unmanaged switch with an uplink to the ALE AOS6 switch.
PC connected to the unmanaged switch were not getting DHCP or network access.</p>

<p>I connected my PC, did a wireshark and saw 802.1q trafic.
I configured an 802.1q interface and got access to all VLAN on the switch.</p>

<p>I was able to exploit it at several customers by forging LLDP to look like an AP.</p>

<p>I was not able to exploit it on AOS8.
While AP-mode is also enabled by default, it doesn&#39;t work the same way as in AOS6.</p>

<p>ALE doesn&#39;t consider it a security issue and won&#39;t change the default behavior of AOS6 as it&#39;s becoming end of life. Unfortunately, it&#39;s still used on a lot of switches.</p>
</div>
          </div>
        </li>
      </div>
  </ol>

    </div>
  </div>
</div>
