<div class="comments post" id="comments">
  <h4>2 comments:</h4>
  <div class="comments-content">
    <div class="comment-thread">
        <ol>
      <div>
        <li class="comment" id="1948">
          <!--
          <div class="avatar-image-container">
            <img src="">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Jeroen van Bemmel</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c1948" href="#1948">02 October 2023 08:37</a>
              </span>
            </div>
            <div class="comment-content"><p>It may interest readers that the GTSM RFC5082 specifies a sending TTL of 255, where one might have expected a TTL equal to the maximum number of hops acceptable</p>

<p>This implies a TTL of 253 is considered &quot;too low&quot; for a standard directly connected EBGP peering session</p>
</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="1949">
          <!--
          <div class="avatar-image-container">
            <img src="">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Erik Auerswald</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c1949" href="#1949">02 October 2023 11:00</a>
              </span>
            </div>
            <div class="comment-content"><p>One might be able to combine an inbound interface ACL with the GTSM idea. If the system allows to match on TTL in combination with IP, protocol (TCP), and port, this could be used to drop packets with too low TTL value. GTSM still needs to be enabled so that the BGP speakers use high instead of low TTL values.</p>

<p>This is not perfect, e.g., it only works on one of the two BGP speakers of a session (the one that answers a SYN sent to TCP port 179), but it could help against some random attacker from across the Internet intending to send a crafted OPEN message for remote code execution.</p>
</div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="1950">
          <!--
          <div class="avatar-image-container">
            <img src="">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c1950" href="#1950">03 October 2023 08:22</a>
              </span>
            </div>
            <div class="comment-content"><p>I hoped that GTSM would be implemented in CoPP ACL (the only place where it would make sense) or failing that in <strong>iptables</strong> in Linux-based devices. Looks like I was way too optimistic (again).</p>

<p>As for &quot;it works on one of the two BGP speakers&quot;, you can drop packets when the source or destination port is 179 and TTL is too low, and allow all other packets with source or destination port 179 (or just let them through)</p>
</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
  </ol>

    </div>
  </div>
</div>
