<div class="comments post" id="comments">
  <h4>8 comments:</h4>
  <div class="comments-content">
    <div class="comment-thread">
        <ol>
      <div>
        <li class="comment" id="8591025423097326760">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Kirill Kasavchenko</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8591025423097326760" href="#8591025423097326760">02 February 2016 10:57</a>
              </span>
            </div>
            <div class="comment-content">Ivan, that perfectly matches my observations. By the way, Juniper also mentions that Session Hijacking is an &quot;esoteric&quot; attack vector at the moment - http://kb.juniper.net/InfoCenter/index?page=content&amp;id=KB5814&amp;actp=search  <br /><br />Actually, there is a study at University of Michigan (Ann Arbor) - http://web.eecs.umich.edu/~zhiyunq/pub/oakland12_TCP_sequence_number_inference.pdf - that explains how one can actually detect the current sequence range if firewall drops out of sequence packets. <br /><br />On a side note, quite a few antiDDoS vendors use out-of-sequence TCP packet to check if the host is spoofed or not. And that works quite good comparing to traditional SYN cookie challenge.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="6242724512874953797">
          <!--
          <div class="avatar-image-container">
            <img src="https://lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/11597478293075004448" rel="nofollow">sourcejedi</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c6242724512874953797" href="#6242724512874953797">02 February 2016 14:11</a>
              </span>
            </div>
            <div class="comment-content">For those wondering how on earth the michigan study works: it relies on information leakage from IPIDs.  Alledgedly it&#39;s common in middlebox OS&#39;s.  If your middlebox OS has been raising red flags in `nmap -O` and lagging behind multiple open source network OS for a whole decade now, you should do the community a favour and tell us who *not* to buy :).</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="5656504734795577529">
          <!--
          <div class="avatar-image-container">
            <img src="https://lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/04534992851403817890" rel="nofollow">Unknown</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5656504734795577529" href="#5656504734795577529">02 February 2016 18:25</a>
              </span>
            </div>
            <div class="comment-content">Thanks for introduce the Fernando, Eric Vyncke and Enno Rey&#39; work, I didn&#39;t know. Great post.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="4839827990206913523">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.snellman.net/blog/" rel="nofollow">Juho Snellman</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c4839827990206913523" href="#4839827990206913523">04 February 2016 16:51</a>
              </span>
            </div>
            <div class="comment-content">Re: the point that modern TCP stacks &quot;should be&quot; hardened against this, there&#39;s recent measurements on this against production web servers: https://www.caida.org/~mjl/pubs/blind.pdf<br /><br />Key quote:<br /><br />In this population as measured in September 2015, we found: (1) 38.4% of systems tested were vulnerable to at least one blind in-window attack; (2) the in-window data attack is the most significant vulnerability, as 29.6% of systems accepted data with inadequate validation of the acknowledgment number; (3) systems that advertised a maximum segment size (MSS) of 1380 were almost never vulnerable to in-window reset and SYN packets (suggesting that middleboxes with this feature correctly filtered those suspicious packets) but incorrectly passed invalid in-window data packets, (4) in response to an in-window SYN, 1.1% of hosts established a parallel TCP connection using the same 4-tuple, which is unexpected behavior as a 4-tuple can only support a single TCP connection at any one time.<br /></div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="1159372349003074447">
          <!--
          <div class="avatar-image-container">
            <img src="https://lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/11864545777285752230" rel="nofollow">DourCdn</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c1159372349003074447" href="#1159372349003074447">07 February 2016 17:27</a>
              </span>
            </div>
            <div class="comment-content">Are there any stateful firewalls that dont track tcp seq number? Or give you the ability to turn the feature off?</div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="5252143823963429730">
          <!--
          <div class="avatar-image-container">
            <img src="https://lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13457151406311272386" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5252143823963429730" href="#5252143823963429730">08 February 2016 12:54</a>
              </span>
            </div>
            <div class="comment-content">NSX Distributed Firewall (which started the whole thread). Not sure what iptables do.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="5708359607419308088">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Wade Holmes</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5708359607419308088" href="#5708359607419308088">10 April 2016 01:20</a>
              </span>
            </div>
            <div class="comment-content">NSX Distributed Firewall does track tcp sequence numbers. (FYI, im with the NSX Technical Product Management team.)</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="6343769859529737814">
          <!--
          <div class="avatar-image-container">
            <img src="https://lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/11597478293075004448" rel="nofollow">sourcejedi</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c6343769859529737814" href="#6343769859529737814">23 February 2016 17:03</a>
              </span>
            </div>
            <div class="comment-content">iptables checks sequence numbers.  It can be turned off with ip_ct_tcp_be_liberal.  Unfortunately there&#39;s very few reasons to turn it off, because I think it still incurs the tracking overhead, you&#39;re just disabling the enforcement.</div>
          </div>
        </li>
      </div>
  </ol>

    </div>
  </div>
</div>
