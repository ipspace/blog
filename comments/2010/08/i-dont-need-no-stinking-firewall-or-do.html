<div class="comments post" id="comments">
  <h4>38 comments:</h4>
  <div class="comments-content">
    <div class="comment-thread">
        <ol>
      <div>
        <li class="comment" id="2382168722880055100">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Russell Heilling</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2382168722880055100" href="#2382168722880055100">19 August 2010 08:10</a>
              </span>
            </div>
            <div class="comment-content">Hi Ivan,<br /><br />A thought provoking post :)<br /><br />Server hardening may be &quot;mission impossible&quot; but it is still essential.  Very rarely is every server provisioned in a separate broadcast domain, if you rely on a big-iron firewall for your security you are going to be left at risk from the zero-day that hits the machine next to you.  Or even from the compromised administrator&#39;s laptop that connects without going through the firewall.<br /><br />I think there is an argument for defence in depth, putting a dedicated resource between you and your greatest attack vector to reduce your load is always going to be a good idea.  If your risk is great it may even be worth adding an additional firewall level from a second vendor in series.  If a stateless firewall can capture the largest threats without blocking valid content then it may be the right choice, either on its own, or in addition to the stateful firewall.  <br /><br />Of course managing layered firewalls like this comes with its own configuration management issues that could put you at more risk of outage than running without the firewalls..<br /><br />Sure some apps are hard to put behind static ACLs, but equally there are plenty of examples of where stateful firewalls get their application code wrong and can break networks just as badly as a badly written ACL (an example that immediately springs to mind is the SMTP code in early PIXes.  For years the first command I would enter in a default PIX config was &quot;no fixup smtp&quot;.  Memory leaks in SIP ALGs is a more contemporary and widespread issue.)<br /><br />Discounting endpoint security as &quot;mission impossible&quot; says to me that we need to find a new way to handle it because we sure as hell can&#39;t give up on it.  Of course I don&#39;t have an answer for *how* we deal with it or I would be running away to the patent office right now ;)</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="2486818113949213923">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Ronald Bartels</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2486818113949213923" href="#2486818113949213923">19 August 2010 08:57</a>
              </span>
            </div>
            <div class="comment-content">Of course no one needs a stinking firewall, all you need is NAT.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="7721987051751102438">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">mokum von Amsterdam</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c7721987051751102438" href="#7721987051751102438">19 August 2010 13:44</a>
              </span>
            </div>
            <div class="comment-content">Ofcourse we need statefull firewalls AND stateless router ACL&#39;s in front of everything. It&#39;s a great idea to implement an additional source of issues in front of an OS with issues carrying apps with issues. If not in obscurity &amp; complexity, where would the fun in our jobs be?<br />More proxies, more high availability, more active active is my motto, and I have yet to meet a vendor who does not agree 8-)</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="6942259205103401245">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Roland Dobbins</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c6942259205103401245" href="#6942259205103401245">19 August 2010 15:09</a>
              </span>
            </div>
            <div class="comment-content">Stateful inspection makes zero sense when every incoming connection is unsolicited - as is the case with Web servers, DNS servers, et. al.<br /><br />Furthermore, even the largest firewalls available have state-tables which are easily exhausted either by legitimate flash crowds or by layer-7 attack traffic crafted in such a way as to appear perfectly legitimate, passing all firewall rules and &#39;inspectors&#39;.  Stateful firewalls are DDoS chokepoints, they can withstand far fewer sessions than the hosts behind them, and they always fall over during DDoS attacks.<br /><br />And of course, the firewalls themselves are merely special-purpose computers running code - and there are bugs in that code, as the list of security flaws and patches for every commercial firewall vendor demonstrates.  Add this to the fact that the code written for these devices receives much less scrutiny than OS/application/service code, and one can see that in addition to the availability threat they pose, firewalls also greatly broaden the attack surface and potentially provide obscure vectors for attackers to compromise these blackbox devices.<br /><br />None of the large-scale Internet properties with which readers are familiar put stateful firewalls (or so-called &#39;IPS&#39;) in front of their servers - at least, the ones which stay up and running.  <br /><br />Stateful firewalls have no place whatsoever in front of servers, period.  There&#39;s no state to inspect, and they greatly reduce the security posture of organizations which make the mistake of placing them in front of servers.<br /><br />Stateless ACLs in hardware-based routing/switching platforms which can handle millions of packets-per-second in hardware are the BCP for enforcing communications policy for servers. <br /><br />This NANOG presentation succinctly demolishes the myth that firewalls (and other stateful inspection devices) should be placed inline in front of servers:<br /><br />http://www.nanog.org/meetings/nanog48/presentations/Monday/Kaeo_FilterTrend_ISPSec_N48.pdf</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="109833224036693604">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Eric</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c109833224036693604" href="#109833224036693604">19 August 2010 15:21</a>
              </span>
            </div>
            <div class="comment-content">Roland, you bring up many good points!   It is often difficult to find a nice balance between strong protection measures and resource utilization. Strong gates do not a castle make.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="2214388046087132374">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Roland Dobbins</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2214388046087132374" href="#2214388046087132374">19 August 2010 15:48</a>
              </span>
            </div>
            <div class="comment-content">For an example of how firewalls fall over during DDoS attacks, as well as a list of best current practices (BCPs) for protecting servers, see my APNIC presentation here:<br /><br />http://meetings.apnic.net/__data/assets/pdf_file/0010/13987/rokusaddosjul09preso.pdf<br /><br />http://webcast.apnic.net/meetings/28/apops-10-roland-dobbins.mov</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="8314504502306221477">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8314504502306221477" href="#8314504502306221477">19 August 2010 16:41</a>
              </span>
            </div>
            <div class="comment-content">Thanks for the comment, Roland ... it&#39;s been a while since we last &quot;spoke&quot; and it&#39;s nice to hear from you.<br /><br />Obviously I can&#39;t possibly disagree with anything you wrote; your facts are absolutely correct. However, you&#39;re focusing at a particularly exposed and demanding market segment: large content providers. As I wrote in the post, they are one extreme of the whole spectrum, the other one being a mid-sized enterprise (don&#39;t want to go down to SMB) with very mixed server environment and application requiring dynamic ports.<br /><br />While the lessons learned in high-volume environment are definitely worth considering (and as I wrote, they are best served by router-based ACLs), not everyone has the same amount of knowledge, the team size that these content providers enjoy, the same requirements or the same exposure. These lessons are thus not directly applicable to other environments, as they can sometimes do more harm than good (see the other end of the spectrum).<br /><br />What you&#39;re talking about are F1 racing cars of the content business. That&#39;s where the technology is stressed, where we learn how to improve it and how to design it better (one can only hope the same knowledge transfer would work in the IT industry); but the methodologies used there cannot be applied directly to a commodity car (which will also not be exposed to most of the stresses an F1 racing car is).</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="5533903740817516127">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5533903740817516127" href="#5533903740817516127">19 August 2010 16:53</a>
              </span>
            </div>
            <div class="comment-content">Dear Guest,<br /><br />as you might have realized, the readers of my blog vary significantly in their exposure to particular technologies. While Roland questions the validity of my arguments, you&#39;re asking &quot;what&#39;s the point&quot;. Obviously you need someone to explain the basics of stateless versus stateful firewalls. The articles in Wikipedia are not bad and look to be the first hit on Google when you&#39;re searching for &quot;stateful firewall&quot; (they refer to stateless firewalls as &quot;packet filters&quot;) ...<br /><br />http://en.wikipedia.org/wiki/Stateful_firewall<br />http://en.wikipedia.org/wiki/Packet_filter<br /><br />... if you need more, just let me know; I might be able to help you.<br /><br />Now, Bro, how about some common decency ... like using your name like those that argue with the content of my post ... or politely telling me &quot;hey, Ivan, I would appreciate if you could explain the difference between stateful and stateless firewalls, I was not able to find a decent document anywhere&quot;.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="2475438533514239956">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">stretch</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2475438533514239956" href="#2475438533514239956">19 August 2010 17:03</a>
              </span>
            </div>
            <div class="comment-content">Your views intrigue me and I would like to subscribe to your newsletter.<br /><br />Although, what do you do to protect against TCP SYN DoS attacks?</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="6358439068187796048">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">baconator</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c6358439068187796048" href="#6358439068187796048">19 August 2010 18:43</a>
              </span>
            </div>
            <div class="comment-content">Sweet - I&#39;m going to tell my Cisco SE that we no longer want to purchase those ASA5580s, under the advisement of a CSCO solutions architect. :-P</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="5241895919059277811">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5241895919059277811" href="#5241895919059277811">19 August 2010 19:20</a>
              </span>
            </div>
            <div class="comment-content">Your network, your risk, your decision  :-P</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="3875579693600269357">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Pavel Skovajsa</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c3875579693600269357" href="#3875579693600269357">19 August 2010 19:40</a>
              </span>
            </div>
            <div class="comment-content">Notice that Roland does not say that Cisco should stop selling/recommending firewalls. <br />Roland says Cisco should stop selling/recommending stateful firewalls which are put infront of servers which receive unsolicited connections.<br /><br />In other situations, stateful firewalls are a perfect fit, f.e. permit inside -&gt; outside traffic, while blocking the outside -&gt; inside traffic. <br /><br />Put another way - what is the advantage of putting of stateful firewall in front of public facing DNS server?</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="7780387579080780679">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c7780387579080780679" href="#7780387579080780679">19 August 2010 19:41</a>
              </span>
            </div>
            <div class="comment-content">If you have numerous servers in a multi-tenant environment, there&#39;s always PVLAN or layer-3 isolation with P2P interfaces (assuming your aggregation gear knows what&#39;s above L2).<br /><br />In an enterprise environment where the number of connections between various services grows exponentially, PVLANs could become a nightmare.<br /><br />As for server hardening: I&#39;m far away from saying it can&#39;t be done; I&#39;m just saying that not everyone knows how to do it ... unfortunately.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="2845667776452007808">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Pavel Skovajsa</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2845667776452007808" href="#2845667776452007808">19 August 2010 19:46</a>
              </span>
            </div>
            <div class="comment-content">....nothing, Roland operates under assumtion that servers should protect themselves via implementing TCP cookies by default....moving the problem into the server space (which is actually where it belongs, but we spoiled them)</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="5684205777394131868">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">stretch</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5684205777394131868" href="#5684205777394131868">19 August 2010 20:44</a>
              </span>
            </div>
            <div class="comment-content">Ah, if only that was an acceptable answer for management.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="3281804841232905098">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">baconator</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c3281804841232905098" href="#3281804841232905098">19 August 2010 21:06</a>
              </span>
            </div>
            <div class="comment-content">My network, my risk, state auditor&#39;s decision  :&#39;(<br /><br /><br />Being in higher ed, I really can&#39;t imagine NOT having a firewall. Now, NAC...whole different story.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="5394543992605427143">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">chrismarget</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5394543992605427143" href="#5394543992605427143">19 August 2010 22:53</a>
              </span>
            </div>
            <div class="comment-content">Ivan,<br /><br />You mentioned TCP SYN cookie support in stateful firewalls.  Frankly, I think this is an awful feature.  It requires the firewall to intercept/terminate the TCP session, and can lead to lots of crazy failure scenarios.  Imagine, for example, if the server (or an intermediate router) doesn&#39;t know the path back to the client.  TCP 3 way handshake appears to succeed, but then the application never responds.  What has really happened is that the client has never established 2-way communication with the server.  ...and for what benefit?  TCP SYN cookie support is easy to implement.  A server that doesn&#39;t have it probably shouldn&#39;t be facing the wrath of the Internet.<br /><br />Also, about TCP fingerprinting...  You said that a stateful firewall *can* prevent fingerprinting.  I&#39;m not sure that&#39;s true -- you&#39;d need much more than just state awareness to prevent fingerprinting.  You&#39;d need to strip funny TCP options, rewrite sequence numbers...  You&#39;re getting much closer to a full-blown TCP proxy than you are a stateful firewall.  Not that it&#39;s a big deal (netcat can do it), it&#39;s just not something that I think of as a firewall function.  Do firewall vendors market this as a feature?</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="227079163418649450">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Alberto Caldas</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c227079163418649450" href="#227079163418649450">20 August 2010 05:52</a>
              </span>
            </div>
            <div class="comment-content">Talking about stateful firewalls, would SBCs like the Cisco UBE be considered specialized SIP firewalls? I assume they must be stateful even though SIP uses a well known udp port 5060 it is only used to set up audio or video sessions that can use any dynamically assigned udp ports.<br /><br />I haven&#39;t used the CUBE personally, but I was on a project where we were using a dedicated SBC appliance from a top SBC vendor but we replaced it with a ASA because we also wanted to control some other protocols like FTP, TFTP, etc ...</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="8581749204176679107">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Roland Dobbins</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8581749204176679107" href="#8581749204176679107">20 August 2010 08:17</a>
              </span>
            </div>
            <div class="comment-content">Concur 100%.  SYN-cookies should be handled on the hosts themselves.<br /><br />Fingerprinting is irrelevant, anyways.  If one really wishes to obfuscate at that level, there are kernel patches which perform this functionality.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="2518867963694910485">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Roland Dobbins</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2518867963694910485" href="#2518867963694910485">20 August 2010 08:19</a>
              </span>
            </div>
            <div class="comment-content">Respectfully (and good to &#39;speak&#39; with you, too, heh), these issues are even *more* important for the smaller fry.  They get absolutely crushed with even legitimate flash crowd traffic, much less direct or collateral DDoS.<br /><br />Putting a stateful inspection device at a point in the topology *where there is no state to inspect in the first place* doesn&#39;t make sense at any scale.  It is insane, IMHO.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="2060130172704167522">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Roland Dobbins</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2060130172704167522" href="#2060130172704167522">20 August 2010 08:21</a>
              </span>
            </div>
            <div class="comment-content">Actually, it&#39;s a bit more nuanced than that.<br /><br />Firstly, yes, TCP/IP stacks should be hardened.<br /><br />Secondly, S/RTBH is a great, low-cost mitigation mechanism for all kinds of packet-flooding attacks.<br /><br />Thirdly, intelligent DDoS mitigation systems (IDMS) can handle layer-3 through layer-7.<br /><br />[Full disclosure; I was heavily involved with the former Cisco (nee Riverhead) Guard IDMS when I was at Cisco, and now work for a vendor of IDMS systems.]</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="8623388874107672478">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Roland Dobbins</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8623388874107672478" href="#8623388874107672478">20 August 2010 08:28</a>
              </span>
            </div>
            <div class="comment-content">To clarify, I&#39;m no longer with Cisco - but I was &#39;infamous&#39; in certain quarters within Cisco for espousing these very same views when I was there, so my strong recommendation against stateful firewalls in front of any server, anytime, anywhere has been consistent over the years.<br /><br />;&gt;<br /><br />And, Pavel, you&#39;re entirely correct - stateful firewalls have an important role to play in separating enterprise client access networks, home networks, and other endpoint networks from &#39;The Internet&#39;, in order to keep unsolicited connections off machines which are primarily workstations. <br /><br />But they shouldn&#39;t be wedged into broadband access networks due to scaling and near-infinite user application diversity, and they need to be removed from mobile wireless data networks, as they cause more problems than they solve (their presence on these networks is primarily a legacy of unfamiliarity with Internet-scale connectivity requirements at the time many of these networks were initially constructed).</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="5348509801831694603">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Roland Dobbins</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5348509801831694603" href="#5348509801831694603">20 August 2010 08:33</a>
              </span>
            </div>
            <div class="comment-content">Due to the pessimal communications models of grotesqueries such as SIP, H.323, et. al., things like SBCs and IP PBXes and so forth should be shielded from a policy perspective as best they can via stateless ACLs in hardware, their inherent stateful inspection mechanisms must be enabled, and operators must be prepared to maintain their availability in the face of attack via mechanisms such as S/RTBH, flowspec, and/or IDMS.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="7689451203544998733">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Roland Dobbins</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c7689451203544998733" href="#7689451203544998733">20 August 2010 08:36</a>
              </span>
            </div>
            <div class="comment-content">NAT in front of servers is even worse than stateful firewalls - guaranteed collapse in the event of even a minimal flash crowd, much less directed or collateral DDoS.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="702005107356848010">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Roland Dobbins</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c702005107356848010" href="#702005107356848010">20 August 2010 08:36</a>
              </span>
            </div>
            <div class="comment-content">Preach it, brother!<br /><br />;&gt;</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="1223532270097016471">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Roland Dobbins</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c1223532270097016471" href="#1223532270097016471">20 August 2010 08:38</a>
              </span>
            </div>
            <div class="comment-content">Thanks for the kind words, and I concur with your cited metaphor 100%!<br /><br />;&gt;</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="5455224743785260507">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Roland Dobbins</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5455224743785260507" href="#5455224743785260507">20 August 2010 08:42</a>
              </span>
            </div>
            <div class="comment-content">Concur, the whole concept of trusting endpoint self-assessment reporting is inherently flawed - I argued heavily against it on this basis when it was first posited, and it&#39;s with no pleasure that I note that events have borne out this view.<br /><br />In terms of being forced to deploy stateful firewalls by various subspecies of auditors - the nonsensical PCI DSS &#39;Web application firewall&#39; requirement can be met via mod_security.  In other scenarios, education in order to help the auditors get past the &#39;firewalls = security&#39; disinformation is the long-term solution.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="8612992026321915271">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8612992026321915271" href="#8612992026321915271">20 August 2010 13:45</a>
              </span>
            </div>
            <div class="comment-content">So, is it correct to assume that your main point is: &quot;stateful firewalls are not good DDoS mitigation devices&quot;? I can easily agree with that.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="8567295589359121459">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">chrismarget</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8567295589359121459" href="#8567295589359121459">20 August 2010 15:06</a>
              </span>
            </div>
            <div class="comment-content">I guess that if you&#39;re going to ignore Roland, and install a stateful firewall in front of servers, then putting the (godawful) TCP SYN cookie mechanism in the firewall is helpful.  It helps the firewall survive in a place where it doesn&#39;t belong.<br /><br />...And I didn&#39;t mean to suggest that fingerprinting prevention was a feature worth asking for!<br /><br />I just meant to explain that stateful inspection doesn&#39;t suggest anti-fingerprinting in my mind.  There are so many fingerprinting vectors that it&#39;d be tough for a man-in-the-middle to stop them all, and mere &quot;stateful inspection&quot; stops none of them.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="7308096511178206681">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Roland Dobbins</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c7308096511178206681" href="#7308096511178206681">20 August 2010 20:32</a>
              </span>
            </div>
            <div class="comment-content">No - my main point is that it makes zero sense to insert a stateful inspection device in front of servers, where there&#39;s no state to inspect in the first place, as every incoming connection is unsolicited.   Stateless ACLs in hardware-based routers/layer-3 switches are the correct way to enforce network access policies.<br /><br />As a matter of considerable amusement, one large commercial firewall vendor has implemented a &#39;stateful inspection bypass&#39; feature - meaning that they expect you to spend $100K USD on their 10gb/sec stateful firewall, then *disable the stateful inspection which was the justification for buying it in the first place*, heh.  This is a tacit admission that stateful inspection has no role in front of servers, as there&#39;s no state to inspect.<br /><br />The DDoS vector and increase in the overall compromise attack surface these devices bring with them are very real threats, and are additional reasons for not deploying firewalls in front of servers; but even if these weren&#39;t concerns (and they&#39;re HUGE concerns), the fundamental illogicality of inserting a stateful inspection device in the topology where there is in fact no state to inspect is the larger point.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="5932219350545311181">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Roland Dobbins</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5932219350545311181" href="#5932219350545311181">20 August 2010 20:34</a>
              </span>
            </div>
            <div class="comment-content">Actually, the SYN-cookie feature will end up causing the firewall to die more quickly under duress due to processing/interrupt overhead and memory exhaustion.<br /><br />If one is forced to install firewalls in front of one&#39;s servers despite the obvious disadvantages and security risks of doing so, the firewalls and everything behind them should be protected via reaction mechanisms such as S/RTBH, flowspec, and/or IDMS.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="825953487670691543">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">chrismarget</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c825953487670691543" href="#825953487670691543">21 August 2010 17:58</a>
              </span>
            </div>
            <div class="comment-content">With SYN cookie support on the servers, the firewall WILL die of state table exhastion in a SYN flood attack.<br /><br />With (godawful) SYN cookie support on the firewall, the firewall MIGHT die trying to proxy the incoming TCP handshakes.  But it won&#39;t fall over because of state table exhaustion.  The only risk is in generating the cookie-ized ISN in the outgoing SYN/ACK.<br /><br />Do you say &quot;more quickly&quot; because state table exhaustion takes some time, while interrupt/CPU issues can be switched on and off instantly?</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="5936224682674546828">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Ronald Bartels</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5936224682674546828" href="#5936224682674546828">21 August 2010 19:07</a>
              </span>
            </div>
            <div class="comment-content">The original article has as it&#39;s premise that firewalls were poor security devices whether stateful or stateless.<br />This is correct as the security problem is not solved in the network.  It is like debating which is better a sour egg or a rotten egg.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="4963671201739495787">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Roland Dobbins</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c4963671201739495787" href="#4963671201739495787">23 August 2010 11:35</a>
              </span>
            </div>
            <div class="comment-content">The reason the firewall will fall over with SYN-cookies is still due to state-table exhaustion from the incoming traffic; and as the firewall is doing more (iatrogenic) things with syn-cookies, it&#39;ll fall over even faster.  Apologies for being unclear.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="2536321715172553016">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Roland Dobbins</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2536321715172553016" href="#2536321715172553016">23 August 2010 11:38</a>
              </span>
            </div>
            <div class="comment-content">Implementing access policy in terms of ports/protocols in stateless ACLs on hardware-based routers/layer-3 switches does in fact provide useful security value, as long as it&#39;s followed up by implementing server OS/app/service hardening BCPs.  And of course, a poor layer-7 architecture can render anything just about indefensible.<br /><br />The network also has a role to play in terms of mitigating DDoS attacks via reaction mechanisms such as S/RTBH and/or IDMS.<br /><br />Availability is an area in which the network can contribute, but layer-7 must be designed, implemented, and operated properly, or what&#39;s done in the network doesn&#39;t matter.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="6252072748328904039">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Brian Knight</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c6252072748328904039" href="#6252072748328904039">02 September 2010 17:45</a>
              </span>
            </div>
            <div class="comment-content">Coming in late on this; blame my vacation.<br /><br />The environment I protect is an enterprise environment, with a mix of off-the-shelf and custom-written software: Ivan&#39;s dynamic hodgepodge.<br /><br />Stateful firewalls were the answer to a failure of application *and* operating system authors to properly secure their code.  These machines, hence, could not be trusted to manage their own connections properly, and so a separate purpose-built appliance was needed.<br /><br />It really comes down to economics.  The marketplace (or the bazaar) has largely proven that we are unwilling to spend more time &amp; money on software to ensure it is well-audited, free of security holes.  We collectively prefer new features in our software.<br /><br />Anyway, the stateful firewalls that I prefer give me everything I need: centralized management of a well-organized security policy.  (Not to mention fulfillment of the auditors&#39; requirement that we have such a firewall in place.)<br /><br />Moreover, I&#39;m not convinced that the app &amp; OS authors have gotten any better at writing their networking code, code that is perhaps not shielded by a stateless ACL.<br /><br />DDOS is also less of a concern for me.  I don&#39;t have a high profile, and to date I&#39;ve never been attacked in that manner.  It may well happen someday, and if it does, I&#39;ve got BGP and stateless ACL tools to deal with it.<br /><br />As Ivan wrote: different data centers, different solutions.<br /><br />-Brian</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="1243302000308794685">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">George</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c1243302000308794685" href="#1243302000308794685">16 August 2014 14:15</a>
              </span>
            </div>
            <div class="comment-content">Hello,<br /><br />Thank you for great post.<br /><br />I am interesting what are you thinking about statefull firewall inside enterprise data center, where all resources are owned by enterprise, statefull firewall between different tears of web application, and stetefull firewall between different application groups, lets say there is MS environment where every MS server has joined AD, and to segment these different application servers with stetefull firewall ?<br /><br />Thank you,<br />Giorgi<br /></div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="2021992994156402220">
          <!--
          <div class="avatar-image-container">
            <img src="https://lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13457151406311272386" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2021992994156402220" href="#2021992994156402220">26 September 2014 13:16</a>
              </span>
            </div>
            <div class="comment-content">In many cases you don&#39;t need stateful firewalls, and some enterprises have already realized that. I described some of the options in this case study:<br /><br />http://www.ipspace.net/Replacing_the_Central_Firewall</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
  </ol>

    </div>
  </div>
</div>
