{
   "comments": [
      {
         "comments": [
            {
               "date": "29 August 2024 09:36",
               "html": "<p>I think we deployed it at one customer who wanted to push all inter-site traffic through a centralized firewall. The hub site advertised the default route and collected the routes from the spoke sites.</p>\n",
               "id": "2397",
               "name": "Ivan Pepelnjak",
               "pub": "2024-08-29T09:36:22",
               "ref": "2396",
               "type": "comment"
            },
            {
               "date": "29 August 2024 11:41",
               "html": "<p>Hi Ivan,</p>\n\n<p>Out of curiosity, for the design you implemented for the centralized firewall, was your VPN label allocation for the HUB VRF done per prefix or per CE allocation?</p>\n\n<p>With per VRF VPN label allocation, the PE hosting the hub VRF would perform an IP lookup after popping the VPN label. Since it has all the routes to the other spokes, traffic between spoke sites would be possible without going through the firewall. Spokes could reach each other via the hub, as they are drawn by the default route.</p>\n\n<p>I had a similar use case for a customer in Arista, where currently only the per VRF label allocation mode is supported. We had to be a bit more creative and ended up using two HUB VRFs: one for traffic coming from the spokes (HUB-IN) and one for traffic going to the spokes (HUB-OUT). The first HUB VRF would only export the default route learned from the firewall in MP-BGP, while the second VRF would only import the spokes&#39; routes.</p>\n",
               "id": "2398",
               "name": "Keanu L ",
               "pub": "2024-08-29T11:41:30",
               "ref": "2397",
               "type": "comment"
            },
            {
               "date": "29 August 2024 12:02",
               "html": "<p>Fun article and great to see support for this added in Netlab.</p>\n\n<p>Full disclosure, I currently work as SE at Arista. Responding here because I was surprised for this not to be as well known as I had thought it would be.</p>\n\n<p>We see importing/exporting of different services happening quite often in the field, and it is also fully supported (and tested) both from EOS perspective - and it&#39;s modelled in the AVD data models (and now in netlab - thanks :-D) to allow easy network-wide deployment methods.</p>\n",
               "id": "2399",
               "name": " Joris C",
               "pub": "2024-08-29T12:02:14",
               "ref": "2396",
               "type": "comment"
            }
         ],
         "date": "29 August 2024 09:07",
         "html": "<p>Thank you for pointing out that this is still a thing. I learned about those hub/common/services networks during my early days as a network engineer running a MPLS network. Unfortunatly I&#39;ve never seen it anywhere else, despite it being a really cool &quot;trick&quot;. Thaught it a lot of other engineers who where learing about MPLS and BGP and it makes me happy seeing it&#39;s still alive with EVPN. Thank you.</p>\n",
         "id": "2396",
         "name": " Daniel S",
         "pub": "2024-08-29T09:07:30",
         "type": "comment"
      },
      {
         "date": "29 August 2024 12:03",
         "html": "<p>Fun article and great to see support for this added in Netlab.</p>\n\n<p>Full disclosure, I currently work as SE at Arista. Responding here because I was surprised for this not to be as well known as I had thought it would be.</p>\n\n<p>We see importing/exporting of different services happening quite often in the field, and it is also supported (and tested) from an EOS perspective - as well is it modelled in the AVD data models (and now in netlab - thanks :-D) to allow easy network-wide deployment methods.</p>\n",
         "id": "2400",
         "name": " Joris C",
         "pub": "2024-08-29T12:03:02",
         "type": "comment"
      }
   ],
   "count": 2,
   "type": "post",
   "url": "2024/08/evpn-common-services-vrf.html"
}
