<div class="comments post" id="comments">
  <h4>2 comments:</h4>
  <div class="comments-content">
    <div class="comment-thread">
        <ol>
      <div>
        <li class="comment" id="1108">
          <!--
          <div class="avatar-image-container">
            <img src="">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow"> Robert</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c1108" href="#1108">24 March 2022 11:20</a>
              </span>
            </div>
            <div class="comment-content"><p>You could use Ansible roles to specify dependencies. So MPLS is dependent on BGP, BGP is dependent on OSPF, OSPF is dependent on some kind of common module.</p>

<p>https://docs.ansible.com/ansible/latest/user_guide/playbooks_reuse_roles.html#using-role-dependencies</p>
</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="1109">
          <!--
          <div class="avatar-image-container">
            <img src="">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Sebastian Schrader</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c1109" href="#1109">24 March 2022 12:13</a>
              </span>
            </div>
            <div class="comment-content"><p>Dynamic inclusion during runtime in Ansible (<code>include</code>, <code>include_tasks</code>, <code>include_role</code>) is like large layer-2 domains/long-distance VM motion to me ;-): it should be avoided as much as possible and quite often is not actually necessary. Replacing dynamic inclusion with static imports (<code>import_playbook</code>, <code>import_role</code>, <code>import_tasks</code>) usually requires rearchitecting though.</p>

<p>PS: The use of <code>include_vars</code> is probably acceptable, although <code>inventory</code>/<code>host_vars</code>/<code>group_vars</code> should be preferred.</p>
</div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="1110">
          <!--
          <div class="avatar-image-container">
            <img src="">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow"> Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c1110" href="#1110">24 March 2022 05:29</a>
              </span>
            </div>
            <div class="comment-content"><p>Of course you&#39;re right (and I love the large L2 domains analogy &#x1F923;)</p>

<p>Going back to the first principles, I could have created an Ansible playbook on the fly (after all, it&#39;s just a YAML data structure) and execute it, but I was naive enough to think I could push through the idea of using host_vars data structures to drive flow of execution.</p>
</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
  </ol>

    </div>
  </div>
</div>
