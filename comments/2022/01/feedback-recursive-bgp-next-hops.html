<div class="comments post" id="comments">
  <h4>1 comments:</h4>
  <div class="comments-content">
    <div class="comment-thread">
        <ol>
      <div>
        <li class="comment" id="967">
          <!--
          <div class="avatar-image-container">
            <img src="">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Minh</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c967" href="#967">14 January 2022 06:06</a>
              </span>
            </div>
            <div class="comment-content"><p>This topic is of crucial engineering importance, and advanced as it is, it&#39;s so fundamental to router architecture I don&#39;t think we should label it the network equivalent of Angel on a pin, or nerdy-fun variety Ivan ;) . IMO, anyone who calls themselves network engineer, needs a at least a passing familiar with these kinds of topic in general, and THIS ONE in particular. And since you belong in the top-tier of Networking experts, it&#39;s only natural you&#39;d get interested in this area. </p>

<p>The feature described in the Juniper doc pointed to by Blake isn&#39;t a nerd knob. It&#39;s a fundamental part of Hierarchical FIB. What they describe in the doc is a simple case. It can get more complex when we involve MPLS VPN or EVPN, which in that case is called Chained Composite Next Hop in Junos, and it can have between 5 and 6 levels of nested lookups before you get to the outgoing direct interface, depending on whether you have port channel enabled or not. </p>

<p>IOS-XR also has similar FIB structure, starting from VRF prefix -&gt; label -&gt; BGP protocol next hop -&gt; IGP next hop -&gt; Port channel -&gt; OIF, give or take one for two levels depending on the feature(s) one&#39;s using.</p>

<p>That&#39;s why the more features you turn on, the more hardware is needed, the more heat is produced, the bigger the power bill gets etc etc. In a word, complexity explosion. And that&#39;s why engineering a high-end router is very, very difficult, as mentioned by Tony P last year. The notion that throwing money at a problem is enough to solve it, and so deep-pocket Big Tech like MS, Google, Amazon, will hold great advantage if they decide to create a carrier-class router, is one big misconception. Take MS: they can&#39;t even make a perfect OS or any software product for that matter, with their endless resources, and their research on topological material has been a total failure. </p>
</div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="969">
          <!--
          <div class="avatar-image-container">
            <img src="">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c969" href="#969">14 January 2022 09:39</a>
              </span>
            </div>
            <div class="comment-content"><p>As always, thanks for an insightful comment!</p>

<p>&gt; It can get more complex when we involve MPLS VPN or EVPN, which in that case is called Chained Composite Next Hop in Junos, and it can have between 5 and 6 levels of nested lookups before you get to the outgoing direct interface</p>

<p>Well, we had something like that &quot;forever&quot;. The only question is how many levels of indirection can be copied into the hierarchical FIB, which obviously depends on the underlying hardware (MX would be different than QFX10K or QFX5K). Links to relevant documents would be highly appreciated.</p>

<p>FWIW, this draft includes an interesting discussion of flattening the FIB hierarchy: https://datatracker.ietf.org/doc/html/draft-ietf-rtgwg-bgp-pic-17</p>
</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
  </ol>

    </div>
  </div>
</div>
