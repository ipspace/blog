<div class="comments post" id="comments">
  <h4>15 comments:</h4>
  <div class="comments-content">
    <div class="comment-thread">
        <ol>
      <div>
        <li class="comment" id="5123359976800585243">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="http://easyipv6.wordpress.com" rel="nofollow">Pirmin</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5123359976800585243" href="#5123359976800585243">20 January 2014 14:08</a>
              </span>
            </div>
            <div class="comment-content">Hi Ivan,<br /><br />What&#39;s the max reasonable oversubscription you recommend? Would Chassis Trunking from Brocade be interesting as Aggregation L3 Switch Solution ?<br /><br />Thanks</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="348926353743044565">
          <!--
          <div class="avatar-image-container">
            <img src="https://lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13457151406311272386" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c348926353743044565" href="#348926353743044565">20 January 2014 14:57</a>
              </span>
            </div>
            <div class="comment-content">There&#39;s no &quot;reasonable&quot; number - you should know your traffic (and use 1:3 when you&#39;re clueless).</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="7878373539733058427">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Anonymous</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c7878373539733058427" href="#7878373539733058427">20 January 2014 16:16</a>
              </span>
            </div>
            <div class="comment-content">Okay, so just set all hosts to prefer port 1, problem solved..</div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="7631628414466800032">
          <!--
          <div class="avatar-image-container">
            <img src="https://lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13457151406311272386" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c7631628414466800032" href="#7631628414466800032">20 January 2014 16:40</a>
              </span>
            </div>
            <div class="comment-content">... and waste half the ports and half the switching bandwidth. Congratulations.</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="4537489837977934845">
          <!--
          <div class="avatar-image-container">
            <img src="https://lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/07527433803679583114" rel="nofollow">Unknown</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c4537489837977934845" href="#4537489837977934845">22 January 2014 06:32</a>
              </span>
            </div>
            <div class="comment-content">Thanks for taking the time to go deeper into this topic, Ivan. Your 5K/2K architecture seems most common in the field, although many 10 Gb installs opt to use a 5K as the ToR switch. Perhaps this gives a further nod to the 1000v&#39;s vPC pinning using the &quot;free&quot; edition?</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="2505230899539614160">
          <!--
          <div class="avatar-image-container">
            <img src="https://lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/08806122907850134756" rel="nofollow">Unknown</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2505230899539614160" href="#2505230899539614160">26 January 2014 11:30</a>
              </span>
            </div>
            <div class="comment-content">LACP is included in the free edition ov Nexus 1000v. There is no reason NOT to use LACP for your vhost uplinks except if you &quot;hate&quot; Cisco, which isn&#39;t an argument.<br /><br />Personally I would much happier if the Nexus 1000v implemented Fabricpath alleviating the need for any kind of LAG on the vhost uplinks. But this is a logical and efficient way to connect vhosts to a network so I&#39;m not expecting Cisco to go that way!</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="382747200525489610">
          <!--
          <div class="avatar-image-container">
            <img src="https://lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/17478248609388388279" rel="nofollow">Edmund Roche-Kelly</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c382747200525489610" href="#382747200525489610">28 January 2014 07:17</a>
              </span>
            </div>
            <div class="comment-content">The ToRs can get connected with a cheap 40 Gbps twinax cable. The extra switch hop is less than a microsecond of latency.  Who cares about obtimizing that?</div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="8698079283562739308">
          <!--
          <div class="avatar-image-container">
            <img src="https://lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13457151406311272386" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8698079283562739308" href="#8698079283562739308">28 January 2014 07:22</a>
              </span>
            </div>
            <div class="comment-content">That&#39;s perfectly fine - as long as the 40 Gbps E-W bandwidth is enough, and you have the extra ports. Once you get closer to the physical limits, optimization becomes more important.</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="8550192354905795378">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Pieter E Smit</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8550192354905795378" href="#8550192354905795378">28 January 2014 21:48</a>
              </span>
            </div>
            <div class="comment-content">We bumped into a problem that cause 30 second outage, probably spanning tree. <br />Vswitch dual connected to N4k&#39;s that have multiple up links to vpc N5k pair. <br /><br />When we reload a N4k, the VM fail over is perfect, but when the N4k comes back we lose half the VM&#39;s for  30th. <br /><br />My understanding is that Vswitch starts using  new up link immediately as physical port comes up but spanning tree on unlink ports is still learning topology. <br /></div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="6397986783108811953">
          <!--
          <div class="avatar-image-container">
            <img src="https://lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13457151406311272386" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c6397986783108811953" href="#6397986783108811953">29 January 2014 07:21</a>
              </span>
            </div>
            <div class="comment-content">Thanks for sharing this one. You need &quot;portfast&quot; or an equivalent on the switch to prevent the ports from going through the &quot;listening&quot; phase.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="8303561524363499497">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Anonymous</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8303561524363499497" href="#8303561524363499497">09 February 2014 20:05</a>
              </span>
            </div>
            <div class="comment-content">Pieter check your vSwitch Failback setting. To avoid such failure scenario you may want to set it to No.<br /><br />To understand the issue, you may want to read this blog post: http://frankdenneman.nl/2010/10/22/vswitch-failover-and-high-availability/</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="1124482280152160521">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Anonymous</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c1124482280152160521" href="#1124482280152160521">28 January 2014 23:01</a>
              </span>
            </div>
            <div class="comment-content">What about iSCSI traffic?<br />Isn&#39;t MPIO to be preferred over LACP since MPIO can use all the links simultaneously?</div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="8281641123265870614">
          <!--
          <div class="avatar-image-container">
            <img src="https://lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13457151406311272386" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8281641123265870614" href="#8281641123265870614">29 January 2014 07:22</a>
              </span>
            </div>
            <div class="comment-content">MPIO is definitely better than LACP. Separate (logical) interfaces with Adapter FEX might be the answer.</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="4270154820213061423">
          <!--
          <div class="avatar-image-container">
            <img src="https://resources.blogblog.com/img/blank.gif">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="None" rel="nofollow">Alberto</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c4270154820213061423" href="#4270154820213061423">11 September 2014 19:17</a>
              </span>
            </div>
            <div class="comment-content">Hi Ivan,<br /><br />I&#39;m currently working on an environment where VMware ESXi servers are dual-homed (and statically LAGged) to a pair of FEX 2232. These extenders are currently single-homed to a pair of Nexus 5548 on vPC. I want to move away from the LAGs at the server level but by doing this I&#39;ll start running into the problems you describe above (potential over-subscription of the vPC peer-link, etc.). So, dual-homing the FEXes seems like the logical thing to do.<br /><br />I&#39;ve been doing some research into the reasons why I would like to avoid dual-homing the FEXes and so far I&#39;ve come up with three: <br /><br />a) Config of the FEX&#39;s interfaces need to be defined in both Nexus... for instance port 100/1/25 exists in both parent Nexus, so the config needs to be consistent across both --&gt; not a big deal in my book... plus using config-sync and switch profiles should help simplify or avoid this problem<br /><br />b) The total limit of FEXes supported by the vPC is cut in half, since every Nexus parent switch will be connected to all the FEXes --&gt; not a big deal either for the environment I&#39;m working on<br /><br />c) On a single-homed deployment every FEX is dependant upon a single parent Nexus. If the parent Nexus &quot;A&quot; fails or crashes, only the &quot;A&quot; FEXes will be affected. On a dual-homed deployment all the FEXes are dependant upon both parent Nexus... under certain circumstances this could be defined as a SPOF. Of course an argument could be had regarding the vPC concept as being a SPOF itself... at some point you have to trust the vendor and its code, right?<br /><br />What&#39;s your take on these problems, particularly on the third one. Do you think there are any other limitations worth considering before migrating from a single-homed to a dual-homed config?<br /><br />Thanks!</div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="8554885826838975374">
          <!--
          <div class="avatar-image-container">
            <img src="https://lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35">
          </div>
          -->
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/13457151406311272386" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8554885826838975374" href="#8554885826838975374">12 September 2014 15:31</a>
              </span>
            </div>
            <div class="comment-content">Dual-homed FEX-es might be the best option, as they ensure the load from server uplinks is (somewhat) evenly distributed across both switches.<br /><br />Never went into the details of how dual-homed FEXes handle upstream switch failure, but AFAIK it&#39;s not a SPOF.</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
  </ol>

    </div>
  </div>
</div>
