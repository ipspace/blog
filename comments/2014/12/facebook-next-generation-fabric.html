<div class="comments post" id="comments">
  <h4>7 comments:</h4>
  <div class="comments-content">
    <div class="comment-thread">
        <ol>
      <div>
        <li class="comment" id="5469892237717424230">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="http://solutions-haven.com" rel="nofollow">John</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c5469892237717424230" href="#5469892237717424230">11 December 2014 17:02</a>
              </span>
            </div>
            <div class="comment-content">Whoever made the 3D diagram didn&#39;t account for color blind folks. It&#39;s hard to follow those lines.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="1032164076997652000">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="http://personales.unican.es/vallejoe/" rel="nofollow">Enrique Vallejo</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c1032164076997652000" href="#1032164076997652000">11 December 2014 18:16</a>
              </span>
            </div>
            <div class="comment-content">It is very interesting to see this physical topology being used in an actual datacenter deployment. While a traditional leaf and spline network employs a 2-level folded-Clos topology, this is a 3-level folded-Clos topology. It resembles an undirected butterfly network, which mathematically is denoted as a k-ary n-fly network, with k the switch semi-radix (half the port count, or number of uplinks or downlinks) and n the number of stages. In the case of the Facebook proposal, they design for n=3 and k=48, although they admit variations to increase capacity (starting from a smaller design). Interestingly, the path diversity of this topology equals the number of core switches -up to 48 in Facebook&#39;s design- so it tolerates multiple switch losses with graceful performance degradation (although ECMP load balancing mechanisms typically work best with power-of-2 number of paths, so they could result in larger degradation due to load unbalance).<br /><br />This type of topology has been used before in HPC systems. For example, the BBN Butterfly system already employed a multistage interconnection network in the early 80&#39;s (using 4x4 switches and Motorola 68000 processors!!). In these multi-stage interconnection networks (MINs) the maximum number of endpoints with full-bisection bandwidth (i.e. statistically non-blocking) grows exponentially with the number of stages, something like k^n, which is larger than 100.000 for k=48 and n=3. Considering today&#39;s large switches, such arrangements will be only required for very large systems from very large companies, such as this example from Facebook. <br /><br />There is plenty of academic information about Clos networks in the literature; <a href="http://store.elsevier.com/Principles-and-Practices-of-Interconnection-Networks/William-Dally/isbn-9780080497808/" rel="nofollow">This book</a> by Bill Dally (Chief Scientist in Nvidia) considers MINs and has a section about multi-level Clos and Butterflies. </div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="7212515505041534042">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/09301953435036098014" rel="nofollow">mikefaith</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c7212515505041534042" href="#7212515505041534042">12 December 2014 17:31</a>
              </span>
            </div>
            <div class="comment-content">Great stuff here!!</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="8474949355138064599">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Anonymous</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8474949355138064599" href="#8474949355138064599">15 December 2014 22:57</a>
              </span>
            </div>
            <div class="comment-content">You can see the same 3-level clos design in this 2009 presentation by Google&#39;s Bikash Koley.  http://conference.vde.com/ecoc-2009/programs/documents/ecoc09-100g-ws-google-koley.pdf</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="4609314184823803131">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/06036116499201821433" rel="nofollow">Unknown</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c4609314184823803131" href="#4609314184823803131">16 December 2014 02:11</a>
              </span>
            </div>
            <div class="comment-content">This comment has been removed by the author.</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="2577054952611253866">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="https://www.blogger.com/profile/06036116499201821433" rel="nofollow">Unknown</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2577054952611253866" href="#2577054952611253866">16 December 2014 02:29</a>
              </span>
            </div>
            <div class="comment-content">Oops accidentally deleted my post.  Thanks for the Google presentation, I&#39;ve seen something like this multiple times really.   It&#39;s not new in the HPC world at all.   <br /><br />Doug Hanks from Juniper did a NANOG presentation, and there is a good section in the new QFX5100 book about doing something similar except using Juniper&#39;s VCF to make one of the tiers look like a single switch.  Of course you are limited by what the VCF protocols/management can do whereas this is just based on number of available ports. </div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="8409374171082700106">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Doug Hanks</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c8409374171082700106" href="#8409374171082700106">02 January 2015 00:23</a>
              </span>
            </div>
            <div class="comment-content">Thanks. The new QFX5100 Series book also has a chapter on just IP Fabrics showing different options such as 3-stage and 5-stage topologies. <br /><br />I also posted a white paper on how to build these networks using BGP.<br /><br />http://www.juniper.net/us/en/local/pdf/whitepapers/2000565-en.pdf<br /><br />Juniper also has an open source project called OpenClos which automates the creation of these networks.<br /><br />https://github.com/Juniper/OpenClos</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
  </ol>

    </div>
  </div>
</div>
