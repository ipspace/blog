{
   "comments": [
      {
         "comments": [
            {
               "date": "10 February 2025 09:05",
               "html": "<p>Interestingly, I started the lab with netlab/containerlab and BGP works just fine for me using the same engineering build (or at least &quot;show version&quot; claims it&#39;s the same build).</p>\n",
               "id": "2518",
               "name": "Ivan Pepelnjak",
               "pub": "2025-02-10T09:05:20",
               "ref": "2517",
               "type": "comment"
            },
            {
               "date": "10 February 2025 04:52",
               "html": "<p>I didn&#39;t use the netlab to bring up the container, I use the &quot;docker create&quot; command, wondering if any parameters I&#39;m missing? </p>\n\n<p>here is the docker create command I used</p>\n\n<p>docker create --name=ceos01 --hostname=ceos01 -v /root/ceos01/startup-config:/mnt/flash/startup-config --privileged -e INTFTYPE=eth -e ETBA=4 -e SKIP_ZEROTOUCH_BARRIER_IN_SYSDBINIT=1 -e CEOS=1 -e EOS_PLATFORM=ceoslab -e container=docker -i -t ceosimage:4.33.1 /sbin/init systemd.setenv=INTFTYPE=eth systemd.setenv=ETBA=4 systemd.setenv=SKIP_ZEROTOUCH_BARRIER_IN_SYSDBINIT=1 systemd.setenv=CEOS=1 systemd.setenv=EOS_PLATFORM=ceoslab systemd.setenv=container=docker systemd.setenv=MAPETH0=1 systemd.setenv=MGMT_INTF=eth0</p>\n",
               "id": "2519",
               "name": " Mtai",
               "pub": "2025-02-10T16:52:01",
               "ref": "2518",
               "type": "comment"
            }
         ],
         "date": "10 February 2025 06:27",
         "html": "<p>Great to see that ARM-based cEOS has finally been released! I&#39;m running it on my Mac with Apple Silicon, but it seems to have limited support for routing protocols at the moment.</p>\n\n<p>ceos01(config)#router bgp\n  bgp  not supported on this hardware platform</p>\n\n<p>ceos01(config)#router ?\n  adaptive-virtual-topology  Configure adaptive virtual topology\n  bfd                        Bidirectional Forwarding Detection\n  general                    Protocol independent routing configuration\n  internet-exit              Configure Internet exit\n  kernel                     Routes installed by kernel\n  l2-vpn                     l2-vpn configuration\n  ospfv3                     OSPF Version 3\n  service-insertion          Configure network services inserted to data forwarding\n  traffic-engineering        Traffic-engineering global config</p>\n\n<p>ceos01(config)#show version\nArista cEOSLab\nHardware version:\nSerial number:\nHardware MAC address: 0242.ac20.996c\nSystem MAC address: 0242.ac20.996c</p>\n\n<p>Software image version: 4.33.1F-39308076.liffeyceoslabarm (engineering build)\nArchitecture: aarch64\nInternal build version: 4.33.1F-39308076.liffeyceoslabarm\nInternal build ID: 98fc6c22-9c8e-4226-9f9f-083a36d0bcb3\nImage format version: 1.0\nImage optimization: None</p>\n\n<p>Kernel version: 6.10.14-linuxkit</p>\n\n<p>Uptime: 2 minutes\nTotal memory: 8025636 kB\nFree memory: 6454428 kB</p>\n",
         "id": "2517",
         "name": "Mtai",
         "pub": "2025-02-10T06:27:19",
         "type": "comment"
      },
      {
         "comments": [
            {
               "date": "12 February 2025 09:02",
               "html": "<p>&gt; Have you tried running FRR Docker on Apple Silicon?</p>\n\n<p>Yes. It works.</p>\n\n<p>&gt; If so, have you had any success with MPLS?</p>\n\n<p>Yes, the simple <a href=\"https://github.com/ipspace/netlab/blob/dev/tests/integration/mpls/10-vpn-connected.yml\">MPLS/VPN integration test</a> works with FRR 10.0.1 and 10.2.1, meaning that LDP, L3VPN and MPLS data plane all work correctly.</p>\n\n<p>&gt; I&#39;d appreciate any insights or experiences you could share.</p>\n\n<p>Use netlab? Or reverse-engineer how we configure the container ;) It&#39;s all open-source.</p>\n",
               "id": "2527",
               "name": "Ivan Pepelnjak",
               "pub": "2025-02-12T09:02:00",
               "ref": "2520",
               "type": "comment"
            }
         ],
         "date": "10 February 2025 04:59",
         "html": "<p>Hi @Ivan Pepelnjak,</p>\n\n<p>On a different note, have you tried running FRR Docker on Apple Silicon? If so, have you had any success with MPLS? It seems that the label forwarding path isn&#39;t working as expected, and I&#39;d appreciate any insights or experiences you could share.</p>\n\n<p>Thanks!</p>\n",
         "id": "2520",
         "name": "Mtai",
         "pub": "2025-02-10T16:59:48",
         "type": "comment"
      },
      {
         "comments": [
            {
               "date": "26 February 2025 12:17",
               "html": "<p>Unfortunately, I have no useful idea apart from &quot;there&#39;s something badly wrong with your system&quot; -- it looks like it refuses to start bash.</p>\n\n<p>I would recommend you start from scratch (create a new Ubuntu VM), follow the netlab installation instructions, and then do &quot;netlab test clab&quot; to check everything works (apart from the Arista containers).</p>\n\n<p>After you get that working, download the Arista container (make sure you&#39;re downloading the ARM image) and retry.</p>\n",
               "id": "2541",
               "name": "Ivan Pepelnjak",
               "pub": "2025-02-26T12:17:10",
               "ref": "2540",
               "type": "comment"
            }
         ],
         "date": "26 February 2025 03:44",
         "html": "<p>I followed these instructions on my Apple M2 Pro, but I couldn&#39;t get netlab up to work. Error Log pasted below -  </p>\n\n<hr />\n\n<p>ERRO[0000] failed deploy links for node &quot;r2&quot;: failed to Statfs &quot;/proc/0/ns/net&quot;: no such file or directory\nERRO[0000] failed deploy links for node &quot;r1&quot;: file exists</p>\n\n<p>......(omitted lines) ...</p>\n\n<p>TASK [Wait for device to become ready] <strong><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em>*</strong>\nincluded: /home/ubuntu/.local/lib/python3.12/site-packages/netsim/ansible/tasks/readiness-check/eos-clab.yml for r1, r2</p>\n\n<p>TASK [Wait for cEOS SSH daemon to start] <strong><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em></em>*</strong>\nfatal: [r2]: FAILED! =&gt; changed=false\n  elapsed: 60\n  msg: &#39;timed out waiting for connection port up: ssh connection failed: ssh connect failed: Failed to resolve hostname clab-lab45-r2 (Temporary failure in name resolution)&#39;\nfatal: [r1]: FAILED! =&gt; changed=false\n  elapsed: 60\n  msg: &#39;timed out waiting for connection port up: ssh connection failed: ssh connect failed: Failed to resolve hostname clab-lab45-r1 (Temporary failure in name resolution)&#39;</p>\n\n<p>PLAY RECAP <strong><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em><em></em></em><em><em></em></em>*</strong>\nr1                         : ok=3    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\nr2                         : ok=3    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0</p>\n\n<p>Error executing ansible-playbook /home/ubuntu/.local/lib/python3.12/site-packages/netsim/ansible/initial-config.ansible:\n  Command &#39;[&#39;ansible-playbook&#39;, &#39;/home/ubuntu/.local/lib/python3.12/site-packages/netsim/ansible/initial-config.ansible&#39;]&#39; returned non-zero exit status 2.\n[FATAL]   Executing Ansible playbook /home/ubuntu/.local/lib/python3.12/site-packages/netsim/ansible/initial-config.ansible failed\nError executing netlab initial --no-message:\n  Command &#39;[&#39;netlab&#39;, &#39;initial&#39;, &#39;--no-message&#39;]&#39; returned non-zero exit status 1.\n[FATAL]   netlab up: netlab initial failed, aborting...</p>\n\n<hr />\n\n<p>When I ran docker logs, I got the following - </p>\n\n<pre>\nubuntu@primary:~/lab45$ docker logs clab-lab45-r1\nexec /usr/bin/bash: exec format error\n</pre>\n\n<p>Any pointers what I could be missing?</p>\n",
         "id": "2540",
         "name": " Ebin",
         "pub": "2025-02-26T03:44:01",
         "type": "comment"
      }
   ],
   "count": 3,
   "type": "post",
   "url": "2025/02/arista-ceos-arm-apple-silicon.html"
}
