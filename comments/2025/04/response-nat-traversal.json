{
   "comments": [
      {
         "comments": [
            {
               "date": "10 April 2025 12:11",
               "html": "<p>No matter what way you look at it IPv6 brings less complexity for any of these peer-to-peer connections.  Even if firewall hole punching is needed - there is usually just one.  Unlike with the CG-NAT boxes most users are behind in addition to their on-site NAT.</p>\n\n<p>You also don&#39;t have complications with brand-new protocols such as SIP or FTP, where they embed IPs in the protocol and people have these god-awful &quot;application layer gateways&quot; on their NAT boxes to mangle them.</p>\n\n<p>It might not amount to a commercial justification to run IPv6.  But I think from an engineering perspective it&#39;s hard to make the case that IPv4+NPAT doesn&#39;t add complexity.</p>\n",
               "id": "2599",
               "name": "Cathal Mooney",
               "pub": "2025-04-10T12:11:22",
               "ref": "2598",
               "type": "comment"
            },
            {
               "date": "11 April 2025 09:06",
               "html": "<p>Thank you both!</p>\n\n<p>I totally agree with everything you&#39;re saying, but unfortunately, I also have this weird drive to point out the state of the Emperor&#39;s clothes every now and then.</p>\n",
               "id": "2600",
               "name": "Ivan Pepelnjak ",
               "pub": "2025-04-11T09:06:26",
               "ref": "2599",
               "type": "comment"
            }
         ],
         "date": "10 April 2025 09:58",
         "html": "<p>&gt; Punching holes through that firewall is equivalent to establishing NAT translations.</p>\n\n<p>I would not say outright &#39;equivalent&#39;. There are more than one form of NAT, clearly, and not all forms of NAT (PAT) are as simple as firewall punching, the worse offender often called &ldquo;symmetric NAT&rdquo;. You yourself, stated:\n&ldquo;Decent stateful firewalls match on the full 5-tuple, which is functionally equivalent to symmetric NAT, but don&rsquo;t change the UDP port numbers when packets traverse them (making them equivalent to &zwnj;port-restricted cone NAT), so it&rsquo;s easier to discover what hole your peer punched in their firewall.&rdquo;</p>\n\n<p>Every host in native IPv6 LANs, would have a unique /128 as a minimum (could also have /64 ia_pd routed to the host, but that&#39;s not common (yet? RFC9663) in LAN/Wi-Fi networks), the punching is per-unique /128 address (or host), no NAT/PAT aka shared single IP address occurs here across N number of nodes, preventing any kind of port exhaustion related issues and/or &ldquo;Symmetric NAT-like&rdquo; issues (which is the majority of default NAT configuration out there, even on CGNAT products excluding the exceptions like IOS-XE, A10 CGNAT etc), it is behaviourally, equivalent with port-restricted cone NAT which I do not disagree, but I disagree that it&#39;s a problem for 99% of IPv6-users, STUN has no problems dealing with port-restricted cone NAT behaviour on legacy IPv4 and certainly no problems with native IPv6 (where port exhaustion/re-write will never happen anyway) behind a firewall. I&#39;d know, because I spent a lot of hours over the years, testing popular end-user applications that supports IPv6 P2P (usually VoIP/Video calling software because how much more P2P can we get if not telephony software of sorts!) and PCAPs showed successful src/dst IPs matching each peer&#39;s local-endpoint, i.e. ruled out TURN, behind stateful firewalls, of course STUN worked fine. However, I cannot replicate this on most CGNAT deployments that I don&#39;t control because the majority of ISPs never enabled EIM+EIF NAT on the CGNAT device, and it breaks further for intra-CGNAT traffic because they refuse to enable hairpining.</p>\n\n<p>STUN/TURN/ICE/WebRTC aren&#39;t a joke &mdash; the people who wrote the code behind these tools, spent decades tweaking it, fixing it, just to make it work with CGNAT deployments and similar, simply because people fear native routed IPv6 - yes, there&#39;s people doing /128 IPv6 and NATting /64 ULAs because NAT is a firewall technology for security compliance according to some (yes, sarcasm):\nhttps://www.f5.com/resources/white-papers/the-myth-of-network-address-translation-as-security</p>\n\n<p>Let&#39;s not start talking about NAT Slipstreaming attacks and the likes now, people need their /128s and NAT66es!</p>\n\n<p>I should note, EIM-NAT alone isn&#39;t sufficient, you need it with EIF-NAT hand-in-hand + hairpinning as discussed, for the &#39;ideal&#39; P2P friendly NAT/CGNAT deployments. Fortigate has a nice explanation for most people, if the RFCs are a bit confusing.\nhttps://docs.fortinet.com/document/fortigate/7.4.6/fortinet-carrier-grade-nat-field-reference-architecture-guide/920625/endpoint-independent-mapping\nhttps://docs.fortinet.com/document/fortigate/7.4.6/fortinet-carrier-grade-nat-field-reference-architecture-guide/921514/endpoint-independent-filtering</p>\n\n<p>I don&#39;t know whether EIF works on IOS-XE, probably does, but if you have a Windows PC, you can test for RFC conformance using this tool (someone probably can port it to Linux/macOS):\nhttps://github.com/HMBSbige/NatTypeTester</p>\n\n<p>Long story short &mdash; life&#39;s easier with native routed IPv6, no matter how you (as in, anyone who&#39;s pro-NAT) try to spin NAT being the saviour of IP networking. It may have been a different reality, had EIM+EIF+Hairpinning = default on all popularly used NATting software/OSes.</p>\n\n<p>Yes, IPv6 multihoming is pain, BGP is great (routed IPv6 over BGP!), but can&#39;t BGP everywhere, and there&#39;s no good solution here, NAT66/NPTv6 or not, maybe some source routing on the LAN could handle this bit, but not sure how load balancing from local-endpoint would work on source address selection basis (i.e., you have two ISPs, each gave you a unique /48 and your VLAN has two /64s configured for SLAAC/RAs, now the endpoint has two /128s from two separate /64s-ISPs, how would the endpoint know when to do which prefix here for load balancing and that introduces a complexity of its own).</p>\n\n<p>An ISP owner friend of mine, recently discussed on DHCPv6 server HA complexity across N BNGs, and we joked that, life&#39;s easier if every residential CPE supported BGP, we could just BGP everything and call it a day and not worry about next-hop failures or DHCPv6 state sync issues. But such is life, I&#39;d still take IPv6 any day over NAT. Particularly in ISP networks, when you have P2P gamers on an Xbox or PS, intelligent CGNAT (EIF+EIM+Hairpinning) with dual-stack IPv6 ensures you don&#39;t get support tickets about P2P or port exhaustion issues because there&#39;s 1000 CPEs behind a /32.</p>\n",
         "id": "2598",
         "name": "Daryll Swer ",
         "pub": "2025-04-10T09:58:32",
         "type": "comment"
      },
      {
         "date": "17 April 2025 04:25",
         "html": "<p>IPv6?? Have we tried Carrier supporting Carrier NAT?? ;-)</p>\n",
         "id": "2602",
         "name": " Christian H",
         "pub": "2025-04-17T04:25:39",
         "type": "comment"
      },
      {
         "comments": [
            {
               "date": "05 January 2026 10:28",
               "html": "<p>I actually struggled to find any posts about this behaviour. I found the various RFCs, vendor docs, but not general posts on reddit, blogs, etc. which I was surprised by.</p>\n\n<p>Even using the search function here on Ivan&#39;s blog for &#39;cone&#39; or &#39;EIM&#39;, only results in this specific single post.</p>\n",
               "id": "2842",
               "name": " Eoghan",
               "pub": "2026-01-05T22:28:39",
               "ref": "2841",
               "type": "comment"
            }
         ],
         "date": "05 January 2026 10:20",
         "html": "<p>Ah no way, just found this post now, my googling efforts must have been lacking before.</p>\n\n<p>I posted about Full Cone NAT / EIM+EIF here recently:\nhttps://www.linkedin.com/posts/eoghancullen_til-that-isp-provided-home-routers-may-use-activity-7413587313487667200-1bWw?utm_source=share&amp;utm_medium=member_desktop&amp;rcm=ACoAAAbrBxoBlIHgi7Gx7iPmsjQn9TBlI1kk_3w</p>\n\n<p>Don&#39;t think it&#39;s mentioned here or in the comments, but my specific concerns were around the fact that EIM+EIF can result in random malicious port-scan traffic traversing home routers and getting all the way through to internal devices. While not as bad as it seems, it is quite terrifying to see traffic hitting your private end device that was source from a known bad actor public IP address.</p>\n",
         "id": "2841",
         "name": " Eoghan",
         "pub": "2026-01-05T22:20:16",
         "type": "comment"
      }
   ],
   "count": 3,
   "type": "post",
   "url": "2025/04/response-nat-traversal.html"
}
