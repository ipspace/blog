<div class="comments post" id="comments">
  <h4>2 comments:</h4>
  <div class="comments-content">
    <div class="comment-thread">
        <ol>
      <div>
        <li class="comment" id="2551">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Jaap de Vos</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2551" href="#2551">04 March 2025 10:00</a>
              </span>
            </div>
            <div class="comment-content"><p>Containerlab has the ability to integrate with Edgeshark. Edgeshark is an open source project by Siemens, it provides a web interface for most networking constructs found on your lab machine, allowing you to select them, start a capture, then pipe that to a local Wireshark installation. It&rsquo;s easy to use, just grab a compose file and run it. There&rsquo;s some required plumbing to perform beforehand, the whole process is documented pretty good in the Containerlab manual: https://containerlab.dev/manual/wireshark/</p>
</div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="2552">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2552" href="#2552">04 March 2025 10:03</a>
              </span>
            </div>
            <div class="comment-content">Even simpler: add a single line to netlab topology file to enable Edgeshark<br />

<p>https://netlab.tools/extool/edgeshark/</p>
</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="2556">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow"> Jeroen van Bemmel</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2556" href="#2556">06 March 2025 04:17</a>
              </span>
            </div>
            <div class="comment-content">As suggested here: https://unix.stackexchange.com/questions/63023/tell-tcpdump-to-skip-custom-header<br />

<p>tcpdump -w - [...filter...] | editcap -F libpcap -C 16 - - | tcpdump -nlvvv -r -</p>

<p>would allow one to display the UDP-stripped packets in real-time</p>
</div>
              <div class="comment-replies">
                <div class="comment-thread inline-thread">
                  <span class="thread-count"><a>Replies</a></span>
                    <ol>
      <div>
        <li class="comment" id="2557">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow"> Ivan Pepelnjak</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2557" href="#2557">06 March 2025 07:41</a>
              </span>
            </div>
            <div class="comment-content"><p>Yeah, about that... I found it a while ago and tested it, and it works beautifully if you use regular files. It might have worked in real time in 2013 (when the answer was written), but it definitely does not produce anything (in real-time) on recent Ubuntus.</p>

<p>Looks like they optimized tcpdump or editcap a bit too much in the meantime.</p>
</div>
          </div>
        </li>
      </div>
      <div>
        <li class="comment" id="2559">
          <div class="comment-block">
            <div class="comment-header">
              <cite class="user"><a href="" rel="nofollow">Erik Auerswald</a></cite>
              <span class="datetime secondary-text">
                <a rel="nofollow" id="c2559" href="#2559">07 March 2025 10:28</a>
              </span>
            </div>
            <div class="comment-content"><p>I have just tested it on a still supported Ubuntu LTS, it seemed to &quot;work&quot; in general. ;-)</p>

<p>I&#39;d expect buffering in the pipeline to be a problem for <em>real-time</em> output.</p>

<p>There are two <code>tcpdump</code> options that should help when added to the start of the pipeline: <code>--immediate-mode</code> and <code>-U, --packet-buffered</code>.</p>

<p>The next possible problem is <code>editcap</code>. I did not see any buffer control options in its man page, but one can try to use <code>stdbuf -i0 -o0 editcap &amp;hellip;</code> to remove any buffering from its input and output streams.</p>

<p>The last (<code>tcpdump</code>) command in the pipeline already uses a buffer control option, <code>-l</code>.</p>

<p>I did not test this, just wanted to provide pointers. ;-)</p>
</div>
          </div>
        </li>
      </div>
  </ol>

                </div>
              </div>
          </div>
        </li>
      </div>
  </ol>

    </div>
  </div>
</div>
